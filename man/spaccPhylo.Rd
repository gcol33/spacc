% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phylofunc.R
\name{spaccPhylo}
\alias{spaccPhylo}
\title{Spatial Phylogenetic Diversity Accumulation}
\usage{
spaccPhylo(
  x,
  coords,
  tree,
  metric = c("mpd", "mntd"),
  n_seeds = 50L,
  method = "knn",
  distance = c("euclidean", "haversine"),
  parallel = TRUE,
  n_cores = NULL,
  progress = TRUE,
  seed = NULL
)
}
\arguments{
\item{x}{A site-by-species matrix.}

\item{coords}{A data.frame with columns \code{x} and \code{y}, or a \code{spacc_dist} object.}

\item{tree}{A phylogenetic tree of class \code{phylo} (from ape package), or
a pairwise phylogenetic distance matrix.}

\item{metric}{Character vector. Metrics to compute:
\itemize{
\item \code{"mpd"}: Mean Pairwise Distance
\item \code{"mntd"}: Mean Nearest Taxon Distance
\item \code{"pd"}: Faith's Phylogenetic Diversity (requires tree, not distance matrix)
}}

\item{n_seeds}{Integer. Number of random starting points. Default 50.}

\item{method}{Character. Accumulation method. Default \code{"knn"}.}

\item{distance}{Character. Site distance method: \code{"euclidean"} or \code{"haversine"}.}

\item{parallel}{Logical. Use parallel processing? Default \code{TRUE}.}

\item{n_cores}{Integer. Number of cores.}

\item{progress}{Logical. Show progress? Default \code{TRUE}.}

\item{seed}{Integer. Random seed.}
}
\value{
An object of class \code{spacc_phylo} containing:
\item{curves}{Named list of matrices, one per metric (n_seeds x n_sites)}
\item{metric}{Metrics computed}
\item{coords, n_seeds, n_sites, method}{Parameters used}
}
\description{
Compute spatial accumulation of phylogenetic diversity metrics (MPD, MNTD, PD).
}
\details{
Phylogenetic diversity metrics incorporate evolutionary relationships:
\itemize{
\item \strong{MPD (Mean Pairwise Distance)}: Average phylogenetic distance between
all pairs of species. Sensitive to tree-wide patterns.
\item \strong{MNTD (Mean Nearest Taxon Distance)}: Average distance to closest
relative. Sensitive to terminal clustering.
\item \strong{PD (Faith's Phylogenetic Diversity)}: Total branch length connecting
species. Requires full tree object.
}
}
\examples{
\dontrun{
library(ape)

# Create random tree
tree <- rtree(30)

coords <- data.frame(x = runif(50), y = runif(50))
species <- matrix(rbinom(50 * 30, 1, 0.3), nrow = 50)
colnames(species) <- tree$tip.label

phylo <- spaccPhylo(species, coords, tree, metric = c("mpd", "mntd"))
plot(phylo)
}

}
\references{
Faith, D.P. (1992). Conservation evaluation and phylogenetic diversity.
Biological Conservation, 61, 1-10.

Webb, C.O. (2000). Exploring the phylogenetic structure of ecological
communities: an example for rain forest trees. American Naturalist, 156, 145-155.
}
\seealso{
\code{\link[picante:mpd]{picante::mpd()}}, \code{\link[picante:mntd]{picante::mntd()}}, \code{\link[picante:pd]{picante::pd()}}
}
