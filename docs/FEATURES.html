<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>spacc Feature Plan • spacc</title><script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet"><meta property="og:title" content="spacc Feature Plan"></head><body><p>








  pkgdown/mathjax-config.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">spacc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="articles/quickstart.html">Getting Started with spacc</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="articles/diversity.html">Diversity Accumulation</a></li>
    <li><a class="dropdown-item" href="articles/extrapolation.html">Extrapolation and Species-Area Models</a></li>
    <li><a class="dropdown-item" href="articles/spatial-analysis.html">Spatial Analysis: Endemism, Fragmentation, and SAR</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gcol33/spacc"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>spacc Feature Plan</h1>
      <small class="dont-index">Source: <a href="https://github.com/gcol33/spacc/blob/HEAD/FEATURES.md" class="external-link"><code>FEATURES.md</code></a></small>
    </div>

<div id="spacc-feature-plan" class="section level1">

<p>Planned features for spacc v0.2.0, based on a review of the spatial accumulation / SAR / diversity literature. Each feature extends the existing C++ backend and S3 class system.</p>
<hr><div class="section level2">
<h2 id="id_1-faiths-phylogenetic-diversity-accumulation">1. Faith’s Phylogenetic Diversity Accumulation<a class="anchor" aria-label="anchor" href="#id_1-faiths-phylogenetic-diversity-accumulation"></a></h2>
<p><strong>Status</strong>: Stub exists in <code><a href="reference/spaccPhylo.html">spaccPhylo()</a></code> (“not yet implemented”)</p>
<p><strong>What</strong>: Accumulate Faith’s PD (sum of branch lengths connecting species in the sample) as sites are added spatially. Currently <code><a href="reference/spaccPhylo.html">spaccPhylo()</a></code> supports MPD and MNTD but not PD.</p>
<p><strong>Implementation</strong>: - Accept a <code>phylo</code> object (ape), not just a distance matrix - At each accumulation step, compute the total branch length of the minimum spanning subtree connecting all observed species - C++ function <code>cpp_phylo_pd_knn_parallel</code> operating on an edge matrix representation - Returns PD curve alongside existing MPD/MNTD in the <code>spacc_phylo</code> object</p>
<p><strong>References</strong>: - Faith, D.P. (1992). Conservation evaluation and phylogenetic diversity. <em>Biological Conservation</em>, 61, 1–10. - Webb, C.O. (2000). Exploring the phylogenetic structure of ecological communities. <em>The American Naturalist</em>, 156, 145–155.</p>
<p><strong>Depends on</strong>: ape (already in Suggests)</p>
<hr></div>
<div class="section level2">
<h2 id="id_2-coverage-based-extrapolation">2. Coverage-Based Extrapolation<a class="anchor" aria-label="anchor" href="#id_2-coverage-based-extrapolation"></a></h2>
<p><strong>Status</strong>: <code><a href="reference/spaccCoverage.html">spaccCoverage()</a></code> and <code><a href="reference/interpolateCoverage.html">interpolateCoverage()</a></code> exist for interpolation only</p>
<p><strong>What</strong>: Extend coverage-based rarefaction to extrapolation beyond the observed sample, following the Chao &amp; Jost (2012) and Chao et al. (2014) framework. Allow users to predict diversity at target coverage levels that exceed the empirical maximum.</p>
<p><strong>Implementation</strong>: - New function <code>extrapolateCoverage(object, target_coverage, q = 0)</code> operating on <code>spacc_coverage</code> objects - For q = 0: Chao1/Chao2 asymptotic estimator + coverage-based extrapolation formula - For q = 1, 2: Closed-form Hill number extrapolation (Chao et al. 2014, eq. 5–6) - Seamless interpolation/extrapolation curve with a visual marker at the reference sample - New class <code>spacc_coverage_ext</code> extending <code>spacc_coverage</code></p>
<p><strong>References</strong>: - Chao, A. &amp; Jost, L. (2012). Coverage-based rarefaction and extrapolation: standardizing samples by completeness rather than size. <em>Ecology</em>, 93, 2533–2547. - Chao, A., Gotelli, N.J., Hsieh, T.C., et al. (2014). Rarefaction and extrapolation with Hill numbers: a framework for sampling and estimation in species diversity studies. <em>Ecological Monographs</em>, 84, 45–67. - Hsieh, T.C., Ma, K.H. &amp; Chao, A. (2016). iNEXT: an R package for rarefaction and extrapolation of species diversity (Hill numbers). <em>Methods in Ecology and Evolution</em>, 7, 1451–1456.</p>
<p><strong>CRAN packages</strong>: <a href="https://cran.r-project.org/package=iNEXT" class="external-link">iNEXT</a>, <a href="https://cran.r-project.org/package=SpadeR" class="external-link">SpadeR</a></p>
<hr></div>
<div class="section level2">
<h2 id="id_3-diversity-area-relationship-dar">3. Diversity-Area Relationship (DAR)<a class="anchor" aria-label="anchor" href="#id_3-diversity-area-relationship-dar"></a></h2>
<p><strong>Status</strong>: Not implemented</p>
<p><strong>What</strong>: Extend the classic SAR (species vs. area) to the DAR framework, plotting Hill numbers of any order q against cumulative area rather than cumulative site count. This captures how <em>effective</em> diversity — not just richness — scales with area.</p>
<p><strong>Implementation</strong>: - New function <code>dar(object, coords, q = c(0, 1, 2))</code> that converts the site-based accumulation from <code><a href="reference/spaccHill.html">spaccHill()</a></code> into an area-based relationship - Area estimation via Voronoi tessellation (sf) or convex hull of accumulated sites at each step - Optionally accept a cell_size argument for grid-based area estimation - New class <code>spacc_dar</code> with plot method showing diversity-area curves for each q - Log-log transformation option for power-law fitting</p>
<p><strong>References</strong>: - Ma, Z.S. (2018). DAR (diversity-area relationship): extending classic SAR (species-area relationship) for biodiversity and biogeography analyses. <em>Ecology and Evolution</em>, 8, 10023–10038. - Arrhenius, O. (1921). Species and area. <em>Journal of Ecology</em>, 9, 95–99.</p>
<p><strong>CRAN packages</strong>: <a href="https://cran.r-project.org/package=vegan" class="external-link">vegan</a> (SAR fitting), <a href="https://cran.r-project.org/package=mobsim" class="external-link">mobsim</a> (divar function)</p>
<hr></div>
<div class="section level2">
<h2 id="id_4-extreme-value-theory-sar-model">4. Extreme Value Theory SAR Model<a class="anchor" aria-label="anchor" href="#id_4-extreme-value-theory-sar-model"></a></h2>
<p><strong>Status</strong>: Not implemented</p>
<p><strong>What</strong>: Add an EVT-based model to <code><a href="reference/extrapolate.html">extrapolate()</a></code> that captures the characteristic three-phase SAR pattern (rapid rise, plateau, second rise) observed in log-log space. Standard asymptotic models (Michaelis-Menten, etc.) cannot capture this triphasic shape.</p>
<p><strong>Implementation</strong>: - Add <code>"evt"</code> as a new model option in <code><a href="reference/extrapolate.html">extrapolate()</a></code> - The EVT model treats the SAR as a mixture of species-specific minimum-distance distributions - Fit via maximum likelihood using a Generalized Extreme Value (GEV) mixture - Parameters: location (mu), scale (sigma), shape (xi) per species group, or a simplified two-component mixture - Return <code>spacc_fit</code> object as usual, with additional diagnostics for phase transitions - Log-log residual plot to visualize the three phases</p>
<p><strong>References</strong>: - Borda-de-Agua, L., Whittaker, R.J., Cardoso, P., et al. (2025). Modelling the species-area relationship using extreme value theory. <em>Nature Communications</em>, 16, 4045. - Scheather, S.J. &amp; Hettmansperger, T.P. (2009). Extreme value theory. In <em>The Species-Area Relationship</em> (eds Storch, D., Marquet, P.A. &amp; Brown, J.H.), Cambridge University Press.</p>
<p><strong>CRAN packages</strong>: <a href="https://cran.r-project.org/package=evd" class="external-link">evd</a>, <a href="https://cran.r-project.org/package=extRemes" class="external-link">extRemes</a></p>
<hr></div>
<div class="section level2">
<h2 id="id_5-functional-beta-diversity-accumulation">5. Functional Beta Diversity Accumulation<a class="anchor" aria-label="anchor" href="#id_5-functional-beta-diversity-accumulation"></a></h2>
<p><strong>Status</strong>: Not implemented (taxonomic beta exists via <code><a href="reference/spaccBeta.html">spaccBeta()</a></code>)</p>
<p><strong>What</strong>: Extend beta diversity partitioning from taxonomic to functional and phylogenetic dimensions. Decompose functional/phylogenetic beta diversity into turnover and nestedness components as sites accumulate spatially.</p>
<p><strong>Implementation</strong>: - Extend <code><a href="reference/spaccBeta.html">spaccBeta()</a></code> with a <code>type</code> parameter: <code>"taxonomic"</code> (default, current behavior), <code>"functional"</code>, <code>"phylogenetic"</code> - Functional beta: Requires traits matrix, computes functional Sorensen/Jaccard based on trait space overlap (convex hull or kernel density) - Phylogenetic beta: Requires phylo object, uses PhyloSor or UniFrac-based decomposition - Turnover/nestedness partitioning following Baselga (2010, 2012) extended to multiple facets - C++ backend <code>cpp_beta_func_knn_parallel</code> and <code>cpp_beta_phylo_knn_parallel</code> - Returns <code>spacc_beta</code> object with type attribute; plot method adjusts labels accordingly</p>
<p><strong>References</strong>: - Baselga, A. (2010). Partitioning the turnover and nestedness components of beta diversity. <em>Global Ecology and Biogeography</em>, 19, 134–143. - Baselga, A. (2012). The relationship between species replacement, dissimilarity derived from nestedness, and nestedness. <em>Global Ecology and Biogeography</em>, 21, 1223–1232. - Chao, A., Chiu, C.H., Vill'eger, S., et al. (2023). Rarefaction and extrapolation with beta diversity under a framework of Hill numbers: the iNEXT.beta3D standardization. <em>Ecological Monographs</em>, 93, e1588. - Cardoso, P., Rigal, F. &amp; Carvalho, J.C. (2015). BAT – Biodiversity Assessment Tools, an R package for the measurement and estimation of alpha and beta taxon, phylogenetic and functional diversity. <em>Methods in Ecology and Evolution</em>, 6, 232–236.</p>
<p><strong>CRAN packages</strong>: <a href="https://cran.r-project.org/package=betapart" class="external-link">betapart</a> (already in Suggests), <a href="https://cran.r-project.org/package=iNEXT.beta3D" class="external-link">iNEXT.beta3D</a>, <a href="https://cran.r-project.org/package=BAT" class="external-link">BAT</a></p>
<hr></div>
<div class="section level2">
<h2 id="id_6-sampling-effort-sar-sesars">6. Sampling Effort SAR (SESARS)<a class="anchor" aria-label="anchor" href="#id_6-sampling-effort-sar-sesars"></a></h2>
<p><strong>Status</strong>: Not implemented</p>
<p><strong>What</strong>: Model the joint effect of sampling effort and area on species richness. Standard SARs assume complete sampling within each area unit; SESARS corrects for unequal survey intensity across sites — common in atlas data, citizen science datasets, and multi-year monitoring.</p>
<p><strong>Implementation</strong>: - New function <code>sesars(object, effort)</code> where <code>effort</code> is a numeric vector (e.g., sampling hours, number of visits, trap-nights per site) - Fits a joint model: S ~ f(A, E) where A = cumulative area and E = cumulative effort - Model options: multiplicative power-law <code>S = c * A^z * E^w</code>, or additive with separate area and effort terms - Predict richness at standardized effort levels - New class <code>spacc_sesars</code> with print/summary/plot methods - Plot: 3D surface or 2D slices at fixed effort levels</p>
<p><strong>References</strong>: - Ribas, C.R., Sobrinho, T.G., Schoereder, J.H., et al. (2012). How large is large enough for insects? Forest fragment size and sampling effort for insects. <em>Environmental Entomology</em>, 41, 965–972. - Sousa-Baena, M.S., Garcia, L.C. &amp; Peterson, A.T. (2014). Completeness of digital accessible knowledge of the plants of Brazil. <em>PLoS ONE</em>, 9, e84068. - Dennstadt, F., Horak, J. &amp; Martin, M.D. (2019). Predictive sampling effort and species-area relationship models for estimating richness in fragmented landscapes. <em>Diversity and Distributions</em>, 26, 1112–1123.</p>
<p><strong>CRAN packages</strong>: <a href="https://cran.r-project.org/package=sars" class="external-link">sars</a> (SAR model fitting)</p>
<hr></div>
<div class="section level2">
<h2 id="id_7-species-fragmented-area-relationship-sfar">7. Species-Fragmented Area Relationship (SFAR)<a class="anchor" aria-label="anchor" href="#id_7-species-fragmented-area-relationship-sfar"></a></h2>
<p><strong>Status</strong>: Not implemented</p>
<p><strong>What</strong>: Extend the power-law SAR to separately quantify the effects of habitat loss (total area reduction) and fragmentation (splitting into patches). The SFAR adds a fragmentation term to the classic SAR, allowing users to disentangle these two drivers of species loss.</p>
<p><strong>Implementation</strong>: - New function <code>sfar(object, patches)</code> where <code>patches</code> is an sf polygon layer or a grouping vector assigning sites to habitat fragments - Model: <code>S = c * A^z * n^(-f)</code> where A = total area, n = number of fragments, f = fragmentation exponent - Alternatively: Hanski et al. metapopulation-informed extension with patch isolation - Fit via nls or maximum likelihood - New class <code>spacc_sfar</code> with print/summary/plot methods - Plot: Observed vs predicted richness, with separate area and fragmentation effect curves</p>
<p><strong>References</strong>: - Hanski, I., Zurita, G.A., Bellocq, M.I. &amp; Rybicki, J. (2013). Species-fragmented area relationship. <em>Proceedings of the National Academy of Sciences</em>, 110, 12715–12720. - Rybicki, J. &amp; Hanski, I. (2013). Species-area relationships and extinctions caused by habitat loss and fragmentation. <em>Ecology Letters</em>, 16, 27–38.</p>
<p><strong>CRAN packages</strong>: <a href="https://cran.r-project.org/package=sars" class="external-link">sars</a></p>
<hr></div>
<div class="section level2">
<h2 id="id_8-endemism-area-relationship">8. Endemism-Area Relationship<a class="anchor" aria-label="anchor" href="#id_8-endemism-area-relationship"></a></h2>
<p><strong>Status</strong>: Not implemented</p>
<p><strong>What</strong>: Compute the number of endemic species (species found <em>only</em> within the accumulated area) as a function of cumulative area or site count. Complements the standard SAR by tracking how many species are unique to each spatial extent — critical for conservation prioritization.</p>
<p><strong>Implementation</strong>: - New function <code>spaccEndemism(x, coords, ...)</code> or add <code>metric = "endemism"</code> option to <code><a href="reference/spaccHill.html">spaccHill()</a></code> - At each accumulation step, count species present in the accumulated set but absent from all remaining (unvisited) sites - This is the complement: endemic_k = species in sites 1..k that are absent from sites k+1..n - C++ function <code>cpp_knn_endemism_parallel</code> tracking both cumulative and exclusive species counts - New class <code>spacc_endemism</code> or extend <code>spacc</code> with an endemism column - Plot: Endemism curve overlaid on or alongside the standard SAC</p>
<p><strong>References</strong>: - Hobohm, C. (ed.) (2014). <em>Endemism in Vascular Plants</em>. Springer. - Kier, G., Kreft, H., Lee, T.M., et al. (2009). A global assessment of endemism and species richness across island and mainland regions. <em>Proceedings of the National Academy of Sciences</em>, 106, 9322–9327. - May, F., Gerstner, K., McGlinn, D.J., et al. (2018). mobsim: An R package for the simulation and measurement of biodiversity across spatial scales. <em>Methods in Ecology and Evolution</em>, 9, 1401–1408.</p>
<p><strong>CRAN packages</strong>: <a href="https://cran.r-project.org/package=mobsim" class="external-link">mobsim</a> (endemic species in divar)</p>
<hr></div>
<div class="section level2">
<h2 id="implementation-priority">Implementation Priority<a class="anchor" aria-label="anchor" href="#implementation-priority"></a></h2>
<table class="table"><colgroup><col width="8%"><col width="26%"><col width="32%"><col width="32%"></colgroup><thead><tr><th>#</th>
<th>Feature</th>
<th>Complexity</th>
<th>Builds on</th>
</tr></thead><tbody><tr><td>1</td>
<td>Faith’s PD accumulation</td>
<td>Low</td>
<td>
<code><a href="reference/spaccPhylo.html">spaccPhylo()</a></code>, ape</td>
</tr><tr><td>2</td>
<td>Coverage-based extrapolation</td>
<td>Medium</td>
<td>
<code><a href="reference/spaccCoverage.html">spaccCoverage()</a></code>, <code><a href="reference/interpolateCoverage.html">interpolateCoverage()</a></code>
</td>
</tr><tr><td>3</td>
<td>Diversity-Area Relationship</td>
<td>Medium</td>
<td>
<code><a href="reference/spaccHill.html">spaccHill()</a></code>, sf</td>
</tr><tr><td>4</td>
<td>EVT SAR model</td>
<td>Medium</td>
<td><code><a href="reference/extrapolate.html">extrapolate()</a></code></td>
</tr><tr><td>5</td>
<td>Functional/phylogenetic beta</td>
<td>High</td>
<td>
<code><a href="reference/spaccBeta.html">spaccBeta()</a></code>, <code><a href="reference/spaccFunc.html">spaccFunc()</a></code>, <code><a href="reference/spaccPhylo.html">spaccPhylo()</a></code>
</td>
</tr><tr><td>6</td>
<td>SESARS</td>
<td>Medium</td>
<td>
<code><a href="reference/extrapolate.html">extrapolate()</a></code>, new effort data</td>
</tr><tr><td>7</td>
<td>SFAR</td>
<td>Medium</td>
<td>New, sf patches</td>
</tr><tr><td>8</td>
<td>Endemism-area</td>
<td>Low</td>
<td>
<code><a href="reference/spacc.html">spacc()</a></code> C++ backend</td>
</tr></tbody></table></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gilles Colling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  
</body></html>

