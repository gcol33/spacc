[{"path":"https://gillescolling.com/spacc/API.html","id":null,"dir":"","previous_headings":"","what":"spacc API Design","title":"spacc API Design","text":"Spatial species accumulation curves. Fast.","code":""},{"path":"https://gillescolling.com/spacc/API.html","id":"core-philosophy","dir":"","previous_headings":"","what":"Core Philosophy","title":"spacc API Design","text":"spacc() main entry point objects print(), summary(), plot() methods Power users can access individual components C++ backend, R interface","code":""},{"path":"https://gillescolling.com/spacc/API.html","id":"class-hierarchy","dir":"","previous_headings":"","what":"Class Hierarchy","title":"spacc API Design","text":"","code":"spacc        <- main accumulation result spacc_dist   <- distance matrix with metadata spacc_fit    <- extrapolation model fit spacc_comp   <- comparison between two curves spacc_rare   <- rarefaction result"},{"path":[]},{"path":[]},{"path":"https://gillescolling.com/spacc/API.html","id":"spacc","dir":"","previous_headings":"Exported Functions > Main Entry Point","what":"spacc()","title":"spacc API Design","text":"Compute spatial species accumulation curves. Returns: Object class spacc","code":"spacc(   x,                          # species matrix OR formula   coords,                     # coordinates (data.frame or matrix)   data = NULL,                # optional data.frame for formula   n_seeds = 50L,              # number of starting points   method = \"knn\",             # \"knn\", \"kncn\", \"random\"   distance = \"euclidean\",     # \"euclidean\", \"haversine\", or spacc_dist object   parallel = TRUE,            # use parallel processing   n_cores = NULL,             # NULL = detectCores() - 1   progress = TRUE,            # show progress bar   seed = NULL                 # RNG seed for reproducibility )"},{"path":[]},{"path":"https://gillescolling.com/spacc/API.html","id":"distances","dir":"","previous_headings":"Exported Functions > Distance Matrix","what":"distances()","title":"spacc API Design","text":"Pre-compute distance matrix reuse. Returns: Object class spacc_dist ? Computing distances O(n²). large datasets, compute reuse:","code":"distances(   coords,                     # coordinates   method = \"euclidean\",       # \"euclidean\", \"haversine\", \"custom\"   fun = NULL                  # custom distance function ) d <- distances(coords, method = \"haversine\") sac_native <- spacc(native_species, d) sac_alien <- spacc(alien_species, d)"},{"path":[]},{"path":"https://gillescolling.com/spacc/API.html","id":"extrapolate","dir":"","previous_headings":"Exported Functions > Extrapolation","what":"extrapolate()","title":"spacc API Design","text":"Fit asymptotic model estimate total species richness. Returns: Object class spacc_fit","code":"extrapolate(   object,                     # spacc object   model = \"michaelis-menten\", # \"michaelis-menten\", \"lomolino\", \"asymptotic\", \"weibull\"   ... ) fit <- extrapolate(sac, model = \"lomolino\") print(fit) # Estimated asymptote: 342 species (95% CI: 318-371) # Model: Lomolino (AIC: 234.5)  plot(fit)  # curve with extrapolation + CI"},{"path":[]},{"path":"https://gillescolling.com/spacc/API.html","id":"compare","dir":"","previous_headings":"Exported Functions > Comparison","what":"compare()","title":"spacc API Design","text":"Test two accumulation curves differ significantly. Returns: Object class spacc_comp","code":"compare(   x,                          # spacc object 1   y,                          # spacc object 2   method = \"permutation\",     # \"permutation\", \"bootstrap\", \"auc\"   n_perm = 999L,              # permutations for p-value   ... ) comp <- compare(sac_native, sac_alien) print(comp) # Comparison: native vs alien # Method: permutation (n=999) # AUC difference: 1234.5 (p < 0.001) # Native saturates faster (89 vs 134 plots to 90%)  plot(comp)  # both curves with difference highlighted"},{"path":[]},{"path":"https://gillescolling.com/spacc/API.html","id":"rarefy","dir":"","previous_headings":"Exported Functions > Rarefaction","what":"rarefy()","title":"spacc API Design","text":"Individual-based rarefaction (classic method). Returns: Object class spacc_rare","code":"rarefy(   x,                          # species matrix (with abundances)   n_individuals = NULL,       # target sample size (NULL = all levels)   n_boot = 100L,              # bootstrap replicates for CI   ... ) rare <- rarefy(species_abundance) plot(rare)"},{"path":[]},{"path":"https://gillescolling.com/spacc/API.html","id":"subsample","dir":"","previous_headings":"Exported Functions > Subsampling","what":"subsample()","title":"spacc API Design","text":"Spatially stratified subsampling. Returns: Integer vector indices keep","code":"subsample(   coords,                     # coordinates   n = NULL,                   # target number of points   method = \"grid\",            # \"grid\", \"random\", \"cluster\"   cell_size = NULL,           # for grid method   min_dist = NULL,            # minimum distance between points   ... ) # Thin to reduce spatial autocorrelation keep <- subsample(coords, method = \"grid\", cell_size = 10) sac <- spacc(species[keep, ], coords[keep, ])"},{"path":[]},{"path":"https://gillescolling.com/spacc/API.html","id":"as_spacc","dir":"","previous_headings":"Exported Functions > Utility Functions","what":"as_spacc()","title":"spacc API Design","text":"Convert formats.","code":"as_spacc(x, ...)  # Methods: as_spacc.specaccum()         # from vegan as_spacc.mob_out()           # from mobr as_spacc.data.frame()        # from tidy format"},{"path":"https://gillescolling.com/spacc/API.html","id":"cspacc","dir":"","previous_headings":"Exported Functions > Utility Functions","what":"c.spacc()","title":"spacc API Design","text":"Combine multiple spacc objects (multi-group comparisons).","code":"all_curves <- c(native = sac_native, alien = sac_alien, ...) plot(all_curves)"},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://gillescolling.com/spacc/API.html","id":"plot-customization","dir":"","previous_headings":"","what":"Plot Customization","title":"spacc API Design","text":"plot() methods return ggplot2 objects, users can customize:","code":"plot(sac) +   labs(title = \"My Custom Title\") +   theme_dark()"},{"path":"https://gillescolling.com/spacc/API.html","id":"plot-options","dir":"","previous_headings":"Plot Customization","what":"Plot options","title":"spacc API Design","text":"","code":"plot.spacc(   x,   ci = TRUE,                  # show confidence interval   ci_level = 0.95,            # CI level   ci_alpha = 0.3,             # ribbon transparency   show_seeds = FALSE,         # show individual curves   saturation = TRUE,          # mark saturation point   saturation_level = 0.9,     # 90% of max   ... )"},{"path":"https://gillescolling.com/spacc/API.html","id":"progress--messaging","dir":"","previous_headings":"","what":"Progress & Messaging","title":"spacc API Design","text":"Use cli package pretty output:","code":"sac <- spacc(species, coords, n_seeds = 100) # ℹ Computing distances (5000 × 5000) # ℹ Running kNN accumulation # ■■■■■■■■■■■■■■■■■■■■ 100% | ETA: 0s # ✔ Done in 2.3s"},{"path":"https://gillescolling.com/spacc/API.html","id":"internal-not-exported","dir":"","previous_headings":"","what":"Internal (Not Exported)","title":"spacc API Design","text":"","code":"# C++ functions (prefixed with cpp_) cpp_dist_euclidean() cpp_dist_haversine() cpp_knn_single() cpp_knn_parallel() cpp_kncn_single() cpp_kncn_parallel() cpp_random_single() cpp_random_parallel()  # R helpers validate_species() validate_coords() detect_cores() make_progress_bar()"},{"path":[]},{"path":"https://gillescolling.com/spacc/API.html","id":"basic-usage","dir":"","previous_headings":"Example Workflows","what":"Basic usage","title":"spacc API Design","text":"","code":"library(spacc)  sac <- spacc(species, coords) print(sac) summary(sac) plot(sac)"},{"path":"https://gillescolling.com/spacc/API.html","id":"compare-groups","dir":"","previous_headings":"Example Workflows","what":"Compare groups","title":"spacc API Design","text":"","code":"sac_native <- spacc(native_sp, coords) sac_alien <- spacc(alien_sp, coords)  comp <- compare(sac_native, sac_alien) print(comp) plot(comp)"},{"path":"https://gillescolling.com/spacc/API.html","id":"full-analysis","dir":"","previous_headings":"Example Workflows","what":"Full analysis","title":"spacc API Design","text":"","code":"# Pre-compute distances (lat/lon data) d <- distances(coords, method = \"haversine\")  # Accumulation curves sac <- spacc(species, d, n_seeds = 100)  # Extrapolate total richness fit <- extrapolate(sac, model = \"lomolino\") predict(fit, n = c(100, 500, 1000))  # Export for paper ggsave(\"figure1.pdf\", plot(sac)) write.csv(as.data.frame(sac), \"results.csv\")"},{"path":"https://gillescolling.com/spacc/API.html","id":"large-dataset","dir":"","previous_headings":"Example Workflows","what":"Large dataset","title":"spacc API Design","text":"","code":"# Subsample to reduce computation keep <- subsample(coords, method = \"grid\", cell_size = 1)  # Run with progress sac <- spacc(species[keep, ], coords[keep, ],              n_seeds = 200, progress = TRUE)"},{"path":"https://gillescolling.com/spacc/API.html","id":"dependencies","dir":"","previous_headings":"","what":"Dependencies","title":"spacc API Design","text":"Imports: - Rcpp, RcppParallel (C++ backend) - ggplot2 (plotting) - cli (progress bars, messages) Suggests: - vegan (as_spacc.specaccum) - mobr (as_spacc.mob_out) - sf (spatial operations subsample)","code":""},{"path":"https://gillescolling.com/spacc/articles/diversity.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Diversity Accumulation","text":"Beyond simple species richness (q=0), spacc supports accumulation curves full family Hill numbers, beta diversity partitioning, phylogenetic diversity, functional diversity. vignette demonstrates approach.","code":""},{"path":"https://gillescolling.com/spacc/articles/diversity.html","id":"simulating-data","dir":"Articles","previous_headings":"","what":"Simulating Data","title":"Diversity Accumulation","text":"","code":"library(spacc)  set.seed(123) n_sites <- 60 n_species <- 30  coords <- data.frame(   x = runif(n_sites, 0, 100),   y = runif(n_sites, 0, 100) )  # Abundance matrix with spatial clustering species <- matrix(0L, n_sites, n_species) for (sp in seq_len(n_species)) {   cx <- runif(1, 10, 90)   cy <- runif(1, 10, 90)   lambda <- 5 * exp(-0.001 * ((coords$x - cx)^2 + (coords$y - cy)^2))   species[, sp] <- rpois(n_sites, lambda) } colnames(species) <- paste0(\"sp\", seq_len(n_species))"},{"path":"https://gillescolling.com/spacc/articles/diversity.html","id":"alpha-beta-and-gamma-diversity","dir":"Articles","previous_headings":"","what":"Alpha, Beta, and Gamma Diversity","title":"Diversity Accumulation","text":"spacc provides functions multiplicative decomposition diversity alpha (local), beta (turnover), gamma (regional) components (Jost 2007):","code":"# Alpha diversity: per-site Hill numbers alpha <- alphaDiversity(species, q = c(0, 1, 2)) colMeans(alpha) #>       q0       q1       q2  #> 15.06667 12.39927 10.61170  # Gamma diversity: pooled regional diversity gamma <- gammaDiversity(species, q = c(0, 1, 2)) gamma #>       q0       q1       q2  #> 30.00000 29.23513 28.56626  # Full partition: gamma = alpha * beta partition <- diversityPartition(species, q = c(0, 1, 2)) partition #> Alpha-Beta-Gamma Diversity Partitioning #> 60 sites, 30 species #>  #>  q alpha beta gamma #>  0 15.07 1.99 30.00 #>  1 11.42 2.56 29.24 #>  2  8.81 3.24 28.57 #>  #> Interpretation: #>   Alpha = mean effective species per site #>   Beta  = effective number of communities (1 to n_sites) #>   Gamma = regional effective species (gamma = alpha x beta)"},{"path":"https://gillescolling.com/spacc/articles/diversity.html","id":"hill-number-accumulation","dir":"Articles","previous_headings":"","what":"Hill Number Accumulation","title":"Diversity Accumulation","text":"Hill numbers unify richness (q=0), Shannon diversity (exponential, q=1), Simpson diversity (inverse, q=2) single framework (Jost 2007, Chao et al. 2014): Hill number accumulation q = 0, 1, 2. Higher-order q values emphasise dominant species, diversity accumulates slowly q=2 compared q=0.","code":"hill <- spaccHill(species, coords, q = c(0, 1, 2), n_seeds = 20, progress = FALSE) plot(hill)"},{"path":"https://gillescolling.com/spacc/articles/diversity.html","id":"beta-diversity","dir":"Articles","previous_headings":"","what":"Beta Diversity","title":"Diversity Accumulation","text":"spaccBeta() partitions spatial beta diversity turnover nestedness components (Baselga 2010): Spatial beta diversity accumulation turnover/nestedness. Turnover reflects species replacement along spatial gradients, nestedness captures diversity loss species-poor sites.","code":"pa <- (species > 0) * 1L beta <- spaccBeta(pa, coords, n_seeds = 20, progress = FALSE) plot(beta)"},{"path":"https://gillescolling.com/spacc/articles/diversity.html","id":"functional-beta-diversity","dir":"Articles","previous_headings":"Beta Diversity","what":"Functional Beta Diversity","title":"Diversity Accumulation","text":"spaccBetaFunc() weights beta diversity trait dissimilarity (Baselga 2012): Functional beta diversity accumulation.","code":"# Simulate two continuous traits traits <- data.frame(   body_size = rnorm(n_species),   wing_length = rnorm(n_species) ) rownames(traits) <- colnames(species)  beta_func <- spaccBetaFunc(pa, coords, traits, n_seeds = 20, progress = FALSE) plot(beta_func)"},{"path":"https://gillescolling.com/spacc/articles/diversity.html","id":"phylogenetic-beta-diversity","dir":"Articles","previous_headings":"Beta Diversity","what":"Phylogenetic Beta Diversity","title":"Diversity Accumulation","text":"spaccBetaPhylo() uses phylogenetic distances weight beta diversity (Chao et al. 2023): Phylogenetic beta diversity accumulation.","code":"library(ape) tree <- rcoal(n_species, tip.label = colnames(species))  beta_phylo <- spaccBetaPhylo(pa, coords, tree, n_seeds = 20, progress = FALSE) plot(beta_phylo)"},{"path":"https://gillescolling.com/spacc/articles/diversity.html","id":"phylogenetic-diversity-accumulation","dir":"Articles","previous_headings":"","what":"Phylogenetic Diversity Accumulation","title":"Diversity Accumulation","text":"spaccPhylo() tracks phylogenetic diversity metrics (MPD, MNTD, Faith’s PD) sites accumulate spatially: Phylogenetic diversity accumulation.","code":"phylo_acc <- spaccPhylo(pa, coords, tree,                         metric = c(\"mpd\", \"mntd\", \"pd\"),                         n_seeds = 20, progress = FALSE) plot(phylo_acc)"},{"path":"https://gillescolling.com/spacc/articles/diversity.html","id":"functional-diversity-accumulation","dir":"Articles","previous_headings":"","what":"Functional Diversity Accumulation","title":"Diversity Accumulation","text":"spaccFunc() tracks functional diversity metrics (FDis, FRic) sites accumulate: Functional diversity accumulation.","code":"func_acc <- spaccFunc(species, coords, traits,                       metric = c(\"fdis\"),                       n_seeds = 20, progress = FALSE) plot(func_acc)"},{"path":"https://gillescolling.com/spacc/articles/diversity.html","id":"coverage-based-rarefaction","dir":"Articles","previous_headings":"","what":"Coverage-Based Rarefaction","title":"Diversity Accumulation","text":"spaccCoverage() computes accumulation curves sample coverage tracking (Chao & Jost 2012), enabling standardization completeness: Coverage-based spatial rarefaction. Interpolate richness specific coverage targets:","code":"cov <- spaccCoverage(species, coords, n_seeds = 20, progress = FALSE) plot(cov) interp <- interpolateCoverage(cov, target = c(0.90, 0.95)) summary(interp) #>       C90             C95        #>  Min.   :12.57   Min.   :13.52   #>  1st Qu.:17.65   1st Qu.:19.74   #>  Median :19.40   Median :21.85   #>  Mean   :19.57   Mean   :21.51   #>  3rd Qu.:22.12   3rd Qu.:24.20   #>  Max.   :25.00   Max.   :27.00"},{"path":"https://gillescolling.com/spacc/articles/diversity.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Diversity Accumulation","text":"Baselga, . (2010). Partitioning turnover nestedness components beta diversity. Global Ecology Biogeography, 19, 134-143. Baselga, . (2012). relationship species replacement, dissimilarity derived nestedness, nestedness. Global Ecology Biogeography, 21, 1223-1232. Chao, . & Jost, L. (2012). Coverage-based rarefaction extrapolation. Ecology, 93, 2533-2547. Chao, ., Gotelli, N.J., Hsieh, T.C., et al. (2014). Rarefaction extrapolation Hill numbers. Ecological Monographs, 84, 45-67. Faith, D.P. (1992). Conservation evaluation phylogenetic diversity. Biological Conservation, 61, 1-10. Jost, L. (2007). Partitioning diversity independent alpha beta components. Ecology, 88, 2427-2439.","code":""},{"path":"https://gillescolling.com/spacc/articles/extrapolation.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Extrapolation and Species-Area Models","text":"spacc provides tools estimating total species richness beyond observed sampling effort: asymptotic model fitting, coverage-based extrapolation, diversity-area relationships (DAR).","code":""},{"path":"https://gillescolling.com/spacc/articles/extrapolation.html","id":"data-setup","dir":"Articles","previous_headings":"","what":"Data Setup","title":"Extrapolation and Species-Area Models","text":"","code":"library(spacc)  set.seed(42) n_sites <- 100 n_species <- 50  coords <- data.frame(   x = runif(n_sites, 0, 100),   y = runif(n_sites, 0, 100) )  species <- matrix(0L, n_sites, n_species) for (sp in seq_len(n_species)) {   cx <- runif(1, 10, 90)   cy <- runif(1, 10, 90)   lambda <- 4 * exp(-0.0008 * ((coords$x - cx)^2 + (coords$y - cy)^2))   species[, sp] <- rpois(n_sites, lambda) } colnames(species) <- paste0(\"sp\", seq_len(n_species)) pa <- (species > 0) * 1L"},{"path":"https://gillescolling.com/spacc/articles/extrapolation.html","id":"asymptotic-extrapolation","dir":"Articles","previous_headings":"","what":"Asymptotic Extrapolation","title":"Extrapolation and Species-Area Models","text":"extrapolate() fits asymptotic model mean accumulation curve estimate total species richness:","code":"sac <- spacc(pa, coords, n_seeds = 30, progress = FALSE)"},{"path":"https://gillescolling.com/spacc/articles/extrapolation.html","id":"model-comparison","dir":"Articles","previous_headings":"Asymptotic Extrapolation","what":"Model Comparison","title":"Extrapolation and Species-Area Models","text":"spacc supports six asymptotic models. Compare select best fit: Best-fitting asymptotic model.","code":"models <- c(\"michaelis-menten\", \"lomolino\", \"asymptotic\", \"weibull\", \"logistic\") fits <- lapply(models, function(m) extrapolate(sac, model = m)) #> Waiting for profiling to be done... #> Waiting for profiling to be done... #> Waiting for profiling to be done... #> Warning in value[[3L]](cond): Model fitting failed: Missing value or an #> infinity produced when evaluating the model #> Waiting for profiling to be done... names(fits) <- models  # Compare AIC data.frame(   model = models,   asymptote = sapply(fits, function(f) round(f$asymptote, 1)),   AIC = sapply(fits, function(f) round(f$aic, 1)) ) #>                               model asymptote   AIC #> michaelis-menten.a michaelis-menten      51.8 271.8 #> lomolino.a                 lomolino      51.8 273.8 #> asymptotic.a             asymptotic      49.6 390.8 #> weibull                     weibull        NA    NA #> logistic.a                 logistic      49.9 157.3 best <- fits[[which.min(sapply(fits, function(f) f$aic))]] plot(best)"},{"path":"https://gillescolling.com/spacc/articles/extrapolation.html","id":"evt-model","dir":"Articles","previous_headings":"Asymptotic Extrapolation","what":"EVT Model","title":"Extrapolation and Species-Area Models","text":"Extreme Value Theory model (Borda-de-Agua et al. 2025) uses two-component Weibull mixture capture triphasic pattern observed empirical species-area relationships: EVT model requires sufficient data points (>10) works best real ecological data exhibiting clear triphasic SAR pattern.","code":"fit_evt <- extrapolate(sac, model = \"evt\") #> Warning in stats::nls(y ~ a * (w * (1 - exp(-(x/b1)^c1)) + (1 - w) * (1 - : #> Convergence failure: singular convergence (7) #> Waiting for profiling to be done... #> Warning in regularize.values(x, y, ties, missing(ties), na.rm = na.rm): #> collapsing to unique 'x' values fit_evt #> Extrapolation: evt  #> ------------------------------  #> Estimated asymptote: 50.0 species #> 95% CI: NA - NA #> AIC: 50.9 #> Observed: 50.0 species (100% of estimated)"},{"path":"https://gillescolling.com/spacc/articles/extrapolation.html","id":"coverage-based-extrapolation","dir":"Articles","previous_headings":"","what":"Coverage-Based Extrapolation","title":"Extrapolation and Species-Area Models","text":"extrapolateCoverage() estimates richness coverage levels beyond observed maximum, using asymptotic estimators (Chao et al. 2014): Coverage-based extrapolation species richness. particularly useful comparing communities different abundances — standardizing coverage ensures equal completeness rather equal sample size.","code":"cov <- spaccCoverage(species, coords, n_seeds = 20, progress = FALSE)  ext <- extrapolateCoverage(cov, target_coverage = c(0.95, 0.99, 1.0), q = 0) ext #> Coverage-based extrapolation #> --------------------------------  #> Diversity order: q = 0 #> Observed coverage: 100.0% #> Observed richness: 50.0 #>  #> Extrapolated richness: #>   C=95%: 36.6 (+/- 5.9) #>   C=99%: 42.4 (+/- 4.0) #>   C=100%: 48.3 (+/- 2.5) plot(ext)"},{"path":"https://gillescolling.com/spacc/articles/extrapolation.html","id":"diversity-area-relationship-dar","dir":"Articles","previous_headings":"","what":"Diversity-Area Relationship (DAR)","title":"Extrapolation and Species-Area Models","text":"dar() fits relationship diversity (Hill numbers) area (Ma 2018). generalises classical species-area relationship Hill number orders: Diversity-area relationship q = 0, 1, 2. DAR captures diversity scales area. q=0 reduces classical SAR; higher q quantifies evenness scales spatially.","code":"dar_result <- dar(species, coords, q = c(0, 1, 2), n_seeds = 20, progress = FALSE) dar_result #> spacc DAR: 100 sites, 20 seeds #> Orders (q): 0, 1, 2 #> Area method: convex_hull plot(dar_result)"},{"path":"https://gillescolling.com/spacc/articles/extrapolation.html","id":"predicting-richness-at-new-effort-levels","dir":"Articles","previous_headings":"","what":"Predicting Richness at New Effort Levels","title":"Extrapolation and Species-Area Models","text":"Use predict() fitted extrapolation model:","code":"predict(best, n = c(50, 100, 200, 500)) #> [1] 49.87375 49.87643 49.87643 49.87643"},{"path":"https://gillescolling.com/spacc/articles/extrapolation.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Extrapolation and Species-Area Models","text":"Borda-de-Agua, L., Whittaker, R.J., Cardoso, P., et al. (2025). Extreme value theory explains topography scaling species-area relationship. Nature Communications, 16, 5346. Chao, ., Gotelli, N.J., Hsieh, T.C., et al. (2014). Rarefaction extrapolation Hill numbers. Ecological Monographs, 84, 45-67. Lomolino, M.V. (2000). Ecology’s general, yet protean pattern: species-area relationship. Journal Biogeography, 27, 17-26. Ma, Z. (2018). Generalizing species-area relationship diversity-area relationships. Ecology Evolution, 8, 8645-8655.","code":""},{"path":"https://gillescolling.com/spacc/articles/quickstart.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Getting Started with spacc","text":"spacc computes spatial species accumulation curves (SACs) using nearest-neighbour algorithms C++ backend speed. Unlike classical random SACs, spatial SACs respect geographic arrangement sampling sites, revealing species richness accumulates expand outward focal point.","code":""},{"path":"https://gillescolling.com/spacc/articles/quickstart.html","id":"simulating-example-data","dir":"Articles","previous_headings":"","what":"Simulating Example Data","title":"Getting Started with spacc","text":"","code":"library(spacc)  set.seed(42) n_sites <- 80 n_species <- 40  coords <- data.frame(   x = runif(n_sites, 0, 100),   y = runif(n_sites, 0, 100) )  # Simulate presence/absence with spatial structure species <- matrix(0L, n_sites, n_species) for (sp in seq_len(n_species)) {   cx <- runif(1, 20, 80)   cy <- runif(1, 20, 80)   prob <- exp(-0.001 * ((coords$x - cx)^2 + (coords$y - cy)^2))   species[, sp] <- rbinom(n_sites, 1, prob) } colnames(species) <- paste0(\"sp\", seq_len(n_species))"},{"path":"https://gillescolling.com/spacc/articles/quickstart.html","id":"basic-spatial-accumulation-curve","dir":"Articles","previous_headings":"","what":"Basic Spatial Accumulation Curve","title":"Getting Started with spacc","text":"core function spacc() computes kNN-based accumulation curves multiple random starting sites (seeds): Spatial species accumulation curve 95% confidence ribbon. grey ribbon shows variability across starting points — wider ribbons indicate species richness depends start sampling.","code":"sac <- spacc(species, coords, n_seeds = 30, method = \"knn\", progress = FALSE) sac #> spacc: 80 sites, 40 species, 30 seeds (knn) plot(sac)"},{"path":"https://gillescolling.com/spacc/articles/quickstart.html","id":"comparing-methods","dir":"Articles","previous_headings":"","what":"Comparing Methods","title":"Getting Started with spacc","text":"spacc supports several accumulation methods: knn: k-Nearest Neighbour (default, fast) kncn: k-Nearest Centroid Neighbour (geometrically centred expansion) random: Classical random accumulation (spatial structure) Combine curves comparison: Comparison accumulation methods.","code":"sac_kncn <- spacc(species, coords, n_seeds = 30, method = \"kncn\", progress = FALSE) sac_rand <- spacc(species, coords, n_seeds = 30, method = \"random\", progress = FALSE) combined <- c(knn = sac, kncn = sac_kncn, random = sac_rand) plot(combined)"},{"path":"https://gillescolling.com/spacc/articles/quickstart.html","id":"extrapolation","dir":"Articles","previous_headings":"","what":"Extrapolation","title":"Getting Started with spacc","text":"Fit asymptotic model estimate total species richness: Fitted Lomolino curve asymptote estimate.","code":"fit <- extrapolate(sac, model = \"lomolino\") #> Waiting for profiling to be done... fit #> Extrapolation: lomolino  #> ------------------------------  #> Estimated asymptote: 42.7 species #> 95% CI: 42.2 - 43.3 #> AIC: 165.3 #> Observed: 40.0 species (94% of estimated) plot(fit)"},{"path":"https://gillescolling.com/spacc/articles/quickstart.html","id":"pre-computing-distances","dir":"Articles","previous_headings":"","what":"Pre-computing Distances","title":"Getting Started with spacc","text":"repeated analyses sites, pre-compute distance matrix :","code":"d <- distances(coords, method = \"euclidean\")  sac1 <- spacc(species[, 1:20], d, n_seeds = 30, progress = FALSE) sac2 <- spacc(species[, 21:40], d, n_seeds = 30, progress = FALSE)"},{"path":"https://gillescolling.com/spacc/articles/quickstart.html","id":"comparing-curves","dir":"Articles","previous_headings":"","what":"Comparing Curves","title":"Getting Started with spacc","text":"Test whether two accumulation curves differ significantly:","code":"comp <- compare(sac1, sac2, method = \"permutation\", n_perm = 199) comp #> Comparison: sac1 vs sac2  #> ----------------------------------------  #> Method: permutation (n=199) #> AUC difference: -8.6 (p = 0.573) #> Saturation: sac1 at 23 sites, sac2 at 19 sites"},{"path":"https://gillescolling.com/spacc/articles/quickstart.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Getting Started with spacc","text":"Diversity: Hill numbers, beta diversity, phylogenetic functional diversity accumulation Extrapolation: Coverage-based extrapolation, EVT models, diversity-area relationships Spatial Analysis: Endemism curves, fragmentation analysis, sampling-effort correction","code":""},{"path":"https://gillescolling.com/spacc/articles/spatial-analysis.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Spatial Analysis: Endemism, Fragmentation, and SAR","text":"spacc includes tools conservation-oriented spatial analyses: endemism-area curves, fragmentation effects species richness (SFAR), sampling-effort correction species-area relationships (SESARS).","code":""},{"path":"https://gillescolling.com/spacc/articles/spatial-analysis.html","id":"data-setup","dir":"Articles","previous_headings":"","what":"Data Setup","title":"Spatial Analysis: Endemism, Fragmentation, and SAR","text":"","code":"library(spacc)  set.seed(42) n_sites <- 80 n_species <- 40  coords <- data.frame(   x = runif(n_sites, 0, 100),   y = runif(n_sites, 0, 100) )  # Species with varying range sizes (some endemic, some widespread) species <- matrix(0L, n_sites, n_species) for (sp in seq_len(n_species)) {   cx <- runif(1, 10, 90)   cy <- runif(1, 10, 90)   # First 10 species are narrow-ranged (endemics)   spread <- if (sp <= 10) 0.005 else 0.001   prob <- exp(-spread * ((coords$x - cx)^2 + (coords$y - cy)^2))   species[, sp] <- rbinom(n_sites, 1, prob) } colnames(species) <- paste0(\"sp\", seq_len(n_species))"},{"path":"https://gillescolling.com/spacc/articles/spatial-analysis.html","id":"endemism-area-curves","dir":"Articles","previous_headings":"","what":"Endemism-Area Curves","title":"Spatial Analysis: Endemism, Fragmentation, and SAR","text":"spaccEndemism() tracks many species endemic (restricted) set sites visited far. sampled area expands, number endemic species initially rises falls widespread species encountered: Endemism-area curve showing endemic species area expands. endemism curve informative identifying irreplaceable sites — areas unique species lost protected.","code":"end <- spaccEndemism(species, coords, n_seeds = 20, progress = FALSE) end #> spacc endemism: 80 sites, 40 species, 20 seeds #> Final mean endemism: 40.0 species (100% of total) plot(end)"},{"path":"https://gillescolling.com/spacc/articles/spatial-analysis.html","id":"species-fragmented-area-relationship-sfar","dir":"Articles","previous_headings":"","what":"Species-Fragmented Area Relationship (SFAR)","title":"Spatial Analysis: Endemism, Fragmentation, and SAR","text":"sfar() fits SFAR model (Hanski et al. 2013), quantifies habitat fragmentation (number fragments) reduces species richness beyond area loss alone predicts: log⁡(S)=c+z⋅log⁡()+f⋅log⁡(n)\\log(S) = c + z \\cdot \\log() + f \\cdot \\log(n) SS species richness, AA total area, nn number fragments, ff fragmentation exponent. Species-Fragmented Area Relationship. negative fragmentation exponent ff indicates splitting habitat fragments reduces species richness beyond area effect.","code":"# First create a spacc object sac <- spacc(species, coords, n_seeds = 20, progress = FALSE)  # Define patch assignments (e.g., from k-means clustering) set.seed(123) patches <- kmeans(coords, centers = 5)$cluster  # Fit SFAR model sfar_fit <- sfar(sac, patches) sfar_fit #> SFAR: Species-Fragmented Area Relationship #> --------------------------------------------  #> Fragments: 5 #> R-squared: 0.985 #>  #> Model: S = 7.74 * A^0.300 * n^(--0.248) #> Fragmentation effect (f): -0.248 #>   No additional fragmentation penalty detected plot(sfar_fit)"},{"path":"https://gillescolling.com/spacc/articles/spatial-analysis.html","id":"sampling-effort-corrected-sar-sesars","dir":"Articles","previous_headings":"","what":"Sampling-Effort Corrected SAR (SESARS)","title":"Spatial Analysis: Endemism, Fragmentation, and SAR","text":"sesars() fits species-area relationship corrected variation sampling effort across sites, avoiding bias arises species-poor areas also -sampled: log⁡(S)=c+z⋅log⁡()+e⋅log⁡(E)\\log(S) = c + z \\cdot \\log() + e \\cdot \\log(E) Sampling-effort corrected SAR.","code":"# Simulate varying sampling effort per site effort <- rpois(n_sites, 10) + 1  # Fit SESARS model using the spacc object from above sesars_fit <- sesars(sac, effort) sesars_fit #> SESARS: Sampling Effort Species-Area Relationship #> ------------------------------------------------  #> Model: power #> R-squared: 0.996 #>  #> Coefficients: #>   log_c       z       w  #>  4.2099  2.2586 -1.5486  #>  #> Interpretation: S = 67.35 * A^2.259 * E^-1.549 plot(sesars_fit)"},{"path":"https://gillescolling.com/spacc/articles/spatial-analysis.html","id":"per-site-metrics-for-spatial-prioritisation","dir":"Articles","previous_headings":"","what":"Per-Site Metrics for Spatial Prioritisation","title":"Spatial Analysis: Endemism, Fragmentation, and SAR","text":"spaccMetrics() computes accumulation metrics every site starting point. reveals spatial variation diversity accumulation rates, useful conservation planning: Spatial heatmap initial accumulation slope. Sites steep initial slopes represent areas many species concentrated — potential biodiversity hotspots.","code":"met <- spaccMetrics(species, coords,                     metrics = c(\"slope_10\", \"half_richness\", \"auc\"),                     progress = FALSE) plot(met, metric = \"slope_10\", type = \"heatmap\") #> Warning in viridisLite::viridis(n, alpha, begin, end, direction, option): #> Option 'v' does not exist. Defaulting to 'viridis'."},{"path":"https://gillescolling.com/spacc/articles/spatial-analysis.html","id":"spatial-subsampling","dir":"Articles","previous_headings":"","what":"Spatial Subsampling","title":"Spatial Analysis: Endemism, Fragmentation, and SAR","text":"subsample() reduces spatial autocorrelation preparing data macroecological analyses: Effect spatial thinning SAC.","code":"# Grid-based thinning keep <- subsample(coords, method = \"grid\", cell_size = 20) length(keep) #> [1] 24  # Compare thinned vs full SAC sac_full <- spacc(species, coords, n_seeds = 20, progress = FALSE) sac_thin <- spacc(species[keep, ], coords[keep, ], n_seeds = 20, progress = FALSE) combined <- c(full = sac_full, thinned = sac_thin) plot(combined)"},{"path":"https://gillescolling.com/spacc/articles/spatial-analysis.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Spatial Analysis: Endemism, Fragmentation, and SAR","text":"Hanski, ., Zurita, G.., Bellocq, M.. & Rybicki, J. (2013). Species-fragmented area relationship. Proceedings National Academy Sciences, 110, 12715-12720. Aiello-Lammens, M.E., Boria, R.., Radosavljevic, ., et al. (2015). spThin: R package spatial thinning. Ecography, 38, 541-545.","code":""},{"path":"https://gillescolling.com/spacc/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gilles Colling. Author, maintainer, copyright holder.","code":""},{"path":"https://gillescolling.com/spacc/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Colling G (2026). spacc: Fast Spatial Species Accumulation Curves. R package version 0.1.0, https://gillescolling.com/spacc/.","code":"@Manual{,   title = {spacc: Fast Spatial Species Accumulation Curves},   author = {Gilles Colling},   year = {2026},   note = {R package version 0.1.0},   url = {https://gillescolling.com/spacc/}, }"},{"path":"https://gillescolling.com/spacc/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"file provides guidance Claude Code (claude.ai/code) working code repository.","code":""},{"path":"https://gillescolling.com/spacc/CLAUDE.html","id":"package-overview","dir":"","previous_headings":"","what":"Package Overview","title":"CLAUDE.md","text":"Fast spatial species accumulation curves C++ backend (Rcpp/RcppParallel). Supports Hill numbers, beta diversity, coverage-based rarefaction, phylogenetic/functional diversity, diversity-area relationships, endemism curves.","code":""},{"path":"https://gillescolling.com/spacc/CLAUDE.html","id":"build-commands","dir":"","previous_headings":"","what":"Build Commands","title":"CLAUDE.md","text":"","code":"devtools::load_all()                                    # Load for development devtools::document()                                    # Regenerate man/ and NAMESPACE devtools::test()                                        # Run tests devtools::test(filter = \"spacc\")                        # Run single test file devtools::check()                                       # Full R CMD check source(\"~/.R/build_pkgdown.R\"); build_pkgdown_site()    # Build pkgdown site"},{"path":"https://gillescolling.com/spacc/CLAUDE.html","id":"c-development","dir":"","previous_headings":"","what":"C++ Development","title":"CLAUDE.md","text":"modifying file src/: add // roxygen comments C++ functions @exported NAMESPACE. internal C++ wrapper functions must listed utils::globalVariables() R/zzz.R — partial list causes unlisted ones fail R CMD check. tests, call internal C++ wrappers spacc:::func(), bare func().","code":"Rcpp::compileAttributes()   # Regenerates R/RcppExports.R and src/RcppExports.cpp devtools::document()        # Regenerates man pages devtools::load_all()        # Recompile and load"},{"path":[]},{"path":"https://gillescolling.com/spacc/CLAUDE.html","id":"pipeline-design","dir":"","previous_headings":"Architecture","what":"Pipeline Design","title":"CLAUDE.md","text":"downstream functions accept spacc object return typed S3 objects print(), summary(), plot(), .data.frame() methods.","code":"spacc(x, coords)  ─┬─> extrapolate()      -> spacc_fit      (asymptotic models)                     ├─> compare()           -> spacc_comp     (curve comparison)                     ├─> rarefy()            -> spacc_rare     (individual-based)                     ├─> spaccHill()         -> spacc_hill     (Hill numbers q=0,1,2)                     ├─> spaccBeta()         -> spacc_beta     (turnover/nestedness)                     ├─> spaccCoverage()     -> spacc_coverage (Chao sample coverage)                     ├─> spaccMetrics()      -> spacc_metrics  (per-site metrics)                     ├─> spaccPhylo()        -> spacc_phylo    (Faith PD, MPD, MNTD)                     ├─> spaccFunc()         -> spacc_func     (FDis, FRic)                     ├─> wavefront()         -> spacc_wavefront                     └─> distanceDecay()     -> spacc_decay"},{"path":"https://gillescolling.com/spacc/CLAUDE.html","id":"two-tier-c-backend","dir":"","previous_headings":"Architecture","what":"Two-Tier C++ Backend","title":"CLAUDE.md","text":"Exact (brute-force): Uses precomputed distance matrix. Auto-selected ≤500 sites. KD-tree/Ball-tree: Spatial indexing, distance matrix needed. Auto-selected >500 sites. Overridable via backend argument. Spatiotemporal distance always uses exact backend.","code":""},{"path":"https://gillescolling.com/spacc/CLAUDE.html","id":"grouped-objects","dir":"","previous_headings":"Architecture","what":"Grouped Objects","title":"CLAUDE.md","text":"groups (species split) support = \"auto\" (country split) return grouped spacc objects curves list--matrices instead single matrix. function recursively calls per group, combines results.","code":""},{"path":"https://gillescolling.com/spacc/CLAUDE.html","id":"parallelism","dir":"","previous_headings":"Architecture","what":"Parallelism","title":"CLAUDE.md","text":"seed runs independently via RcppParallel (shared state). Multiple seeds produce matrix curves used percentile-based confidence intervals.","code":""},{"path":"https://gillescolling.com/spacc/CLAUDE.html","id":"naming-conventions","dir":"","previous_headings":"","what":"Naming Conventions","title":"CLAUDE.md","text":"Functions: camelCase (distanceDecay, spatialRarefaction) Arguments: snake_case (n_seeds, n_cores) Classes: lowercase underscore (spacc, spacc_fit, spacc_decay) C++ functions: snake_case cpp_ prefix (cpp_knn_parallel)","code":""},{"path":"https://gillescolling.com/spacc/FEATURES.html","id":null,"dir":"","previous_headings":"","what":"spacc Feature Plan","title":"spacc Feature Plan","text":"Planned features spacc v0.2.0, based review spatial accumulation / SAR / diversity literature. feature extends existing C++ backend S3 class system.","code":""},{"path":"https://gillescolling.com/spacc/FEATURES.html","id":"id_1-faiths-phylogenetic-diversity-accumulation","dir":"","previous_headings":"","what":"1. Faith’s Phylogenetic Diversity Accumulation","title":"spacc Feature Plan","text":"Status: Stub exists spaccPhylo() (“yet implemented”) : Accumulate Faith’s PD (sum branch lengths connecting species sample) sites added spatially. Currently spaccPhylo() supports MPD MNTD PD. Implementation: - Accept phylo object (ape), just distance matrix - accumulation step, compute total branch length minimum spanning subtree connecting observed species - C++ function cpp_phylo_pd_knn_parallel operating edge matrix representation - Returns PD curve alongside existing MPD/MNTD spacc_phylo object References: - Faith, D.P. (1992). Conservation evaluation phylogenetic diversity. Biological Conservation, 61, 1–10. - Webb, C.O. (2000). Exploring phylogenetic structure ecological communities. American Naturalist, 156, 145–155. Depends : ape (already Suggests)","code":""},{"path":"https://gillescolling.com/spacc/FEATURES.html","id":"id_2-coverage-based-extrapolation","dir":"","previous_headings":"","what":"2. Coverage-Based Extrapolation","title":"spacc Feature Plan","text":"Status: spaccCoverage() interpolateCoverage() exist interpolation : Extend coverage-based rarefaction extrapolation beyond observed sample, following Chao & Jost (2012) Chao et al. (2014) framework. Allow users predict diversity target coverage levels exceed empirical maximum. Implementation: - New function extrapolateCoverage(object, target_coverage, q = 0) operating spacc_coverage objects - q = 0: Chao1/Chao2 asymptotic estimator + coverage-based extrapolation formula - q = 1, 2: Closed-form Hill number extrapolation (Chao et al. 2014, eq. 5–6) - Seamless interpolation/extrapolation curve visual marker reference sample - New class spacc_coverage_ext extending spacc_coverage References: - Chao, . & Jost, L. (2012). Coverage-based rarefaction extrapolation: standardizing samples completeness rather size. Ecology, 93, 2533–2547. - Chao, ., Gotelli, N.J., Hsieh, T.C., et al. (2014). Rarefaction extrapolation Hill numbers: framework sampling estimation species diversity studies. Ecological Monographs, 84, 45–67. - Hsieh, T.C., Ma, K.H. & Chao, . (2016). iNEXT: R package rarefaction extrapolation species diversity (Hill numbers). Methods Ecology Evolution, 7, 1451–1456. CRAN packages: iNEXT, SpadeR","code":""},{"path":"https://gillescolling.com/spacc/FEATURES.html","id":"id_3-diversity-area-relationship-dar","dir":"","previous_headings":"","what":"3. Diversity-Area Relationship (DAR)","title":"spacc Feature Plan","text":"Status: implemented : Extend classic SAR (species vs. area) DAR framework, plotting Hill numbers order q cumulative area rather cumulative site count. captures effective diversity — just richness — scales area. Implementation: - New function dar(object, coords, q = c(0, 1, 2)) converts site-based accumulation spaccHill() area-based relationship - Area estimation via Voronoi tessellation (sf) convex hull accumulated sites step - Optionally accept cell_size argument grid-based area estimation - New class spacc_dar plot method showing diversity-area curves q - Log-log transformation option power-law fitting References: - Ma, Z.S. (2018). DAR (diversity-area relationship): extending classic SAR (species-area relationship) biodiversity biogeography analyses. Ecology Evolution, 8, 10023–10038. - Arrhenius, O. (1921). Species area. Journal Ecology, 9, 95–99. CRAN packages: vegan (SAR fitting), mobsim (divar function)","code":""},{"path":"https://gillescolling.com/spacc/FEATURES.html","id":"id_4-extreme-value-theory-sar-model","dir":"","previous_headings":"","what":"4. Extreme Value Theory SAR Model","title":"spacc Feature Plan","text":"Status: implemented : Add EVT-based model extrapolate() captures characteristic three-phase SAR pattern (rapid rise, plateau, second rise) observed log-log space. Standard asymptotic models (Michaelis-Menten, etc.) capture triphasic shape. Implementation: - Add \"evt\" new model option extrapolate() - EVT model treats SAR mixture species-specific minimum-distance distributions - Fit via maximum likelihood using Generalized Extreme Value (GEV) mixture - Parameters: location (mu), scale (sigma), shape (xi) per species group, simplified two-component mixture - Return spacc_fit object usual, additional diagnostics phase transitions - Log-log residual plot visualize three phases References: - Borda-de-Agua, L., Whittaker, R.J., Cardoso, P., et al. (2025). Modelling species-area relationship using extreme value theory. Nature Communications, 16, 4045. - Scheather, S.J. & Hettmansperger, T.P. (2009). Extreme value theory. Species-Area Relationship (eds Storch, D., Marquet, P.. & Brown, J.H.), Cambridge University Press. CRAN packages: evd, extRemes","code":""},{"path":"https://gillescolling.com/spacc/FEATURES.html","id":"id_5-functional-beta-diversity-accumulation","dir":"","previous_headings":"","what":"5. Functional Beta Diversity Accumulation","title":"spacc Feature Plan","text":"Status: implemented (taxonomic beta exists via spaccBeta()) : Extend beta diversity partitioning taxonomic functional phylogenetic dimensions. Decompose functional/phylogenetic beta diversity turnover nestedness components sites accumulate spatially. Implementation: - Extend spaccBeta() type parameter: \"taxonomic\" (default, current behavior), \"functional\", \"phylogenetic\" - Functional beta: Requires traits matrix, computes functional Sorensen/Jaccard based trait space overlap (convex hull kernel density) - Phylogenetic beta: Requires phylo object, uses PhyloSor UniFrac-based decomposition - Turnover/nestedness partitioning following Baselga (2010, 2012) extended multiple facets - C++ backend cpp_beta_func_knn_parallel cpp_beta_phylo_knn_parallel - Returns spacc_beta object type attribute; plot method adjusts labels accordingly References: - Baselga, . (2010). Partitioning turnover nestedness components beta diversity. Global Ecology Biogeography, 19, 134–143. - Baselga, . (2012). relationship species replacement, dissimilarity derived nestedness, nestedness. Global Ecology Biogeography, 21, 1223–1232. - Chao, ., Chiu, C.H., Vill'eger, S., et al. (2023). Rarefaction extrapolation beta diversity framework Hill numbers: iNEXT.beta3D standardization. Ecological Monographs, 93, e1588. - Cardoso, P., Rigal, F. & Carvalho, J.C. (2015). BAT – Biodiversity Assessment Tools, R package measurement estimation alpha beta taxon, phylogenetic functional diversity. Methods Ecology Evolution, 6, 232–236. CRAN packages: betapart (already Suggests), iNEXT.beta3D, BAT","code":""},{"path":"https://gillescolling.com/spacc/FEATURES.html","id":"id_6-sampling-effort-sar-sesars","dir":"","previous_headings":"","what":"6. Sampling Effort SAR (SESARS)","title":"spacc Feature Plan","text":"Status: implemented : Model joint effect sampling effort area species richness. Standard SARs assume complete sampling within area unit; SESARS corrects unequal survey intensity across sites — common atlas data, citizen science datasets, multi-year monitoring. Implementation: - New function sesars(object, effort) effort numeric vector (e.g., sampling hours, number visits, trap-nights per site) - Fits joint model: S ~ f(, E) = cumulative area E = cumulative effort - Model options: multiplicative power-law S = c * ^z * E^w, additive separate area effort terms - Predict richness standardized effort levels - New class spacc_sesars print/summary/plot methods - Plot: 3D surface 2D slices fixed effort levels References: - Ribas, C.R., Sobrinho, T.G., Schoereder, J.H., et al. (2012). large large enough insects? Forest fragment size sampling effort insects. Environmental Entomology, 41, 965–972. - Sousa-Baena, M.S., Garcia, L.C. & Peterson, .T. (2014). Completeness digital accessible knowledge plants Brazil. PLoS ONE, 9, e84068. - Dennstadt, F., Horak, J. & Martin, M.D. (2019). Predictive sampling effort species-area relationship models estimating richness fragmented landscapes. Diversity Distributions, 26, 1112–1123. CRAN packages: sars (SAR model fitting)","code":""},{"path":"https://gillescolling.com/spacc/FEATURES.html","id":"id_7-species-fragmented-area-relationship-sfar","dir":"","previous_headings":"","what":"7. Species-Fragmented Area Relationship (SFAR)","title":"spacc Feature Plan","text":"Status: implemented : Extend power-law SAR separately quantify effects habitat loss (total area reduction) fragmentation (splitting patches). SFAR adds fragmentation term classic SAR, allowing users disentangle two drivers species loss. Implementation: - New function sfar(object, patches) patches sf polygon layer grouping vector assigning sites habitat fragments - Model: S = c * ^z * n^(-f) = total area, n = number fragments, f = fragmentation exponent - Alternatively: Hanski et al. metapopulation-informed extension patch isolation - Fit via nls maximum likelihood - New class spacc_sfar print/summary/plot methods - Plot: Observed vs predicted richness, separate area fragmentation effect curves References: - Hanski, ., Zurita, G.., Bellocq, M.. & Rybicki, J. (2013). Species-fragmented area relationship. Proceedings National Academy Sciences, 110, 12715–12720. - Rybicki, J. & Hanski, . (2013). Species-area relationships extinctions caused habitat loss fragmentation. Ecology Letters, 16, 27–38. CRAN packages: sars","code":""},{"path":"https://gillescolling.com/spacc/FEATURES.html","id":"id_8-endemism-area-relationship","dir":"","previous_headings":"","what":"8. Endemism-Area Relationship","title":"spacc Feature Plan","text":"Status: implemented : Compute number endemic species (species found within accumulated area) function cumulative area site count. Complements standard SAR tracking many species unique spatial extent — critical conservation prioritization. Implementation: - New function spaccEndemism(x, coords, ...) add metric = \"endemism\" option spaccHill() - accumulation step, count species present accumulated set absent remaining (unvisited) sites - complement: endemic_k = species sites 1..k absent sites k+1..n - C++ function cpp_knn_endemism_parallel tracking cumulative exclusive species counts - New class spacc_endemism extend spacc endemism column - Plot: Endemism curve overlaid alongside standard SAC References: - Hobohm, C. (ed.) (2014). Endemism Vascular Plants. Springer. - Kier, G., Kreft, H., Lee, T.M., et al. (2009). global assessment endemism species richness across island mainland regions. Proceedings National Academy Sciences, 106, 9322–9327. - May, F., Gerstner, K., McGlinn, D.J., et al. (2018). mobsim: R package simulation measurement biodiversity across spatial scales. Methods Ecology Evolution, 9, 1401–1408. CRAN packages: mobsim (endemic species divar)","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":null,"dir":"","previous_headings":"","what":"spacc v0.2.0 Implementation Plan","title":"spacc v0.2.0 Implementation Plan","text":"Four major features make spacc paper-worthy Methods Ecology Evolution.","code":""},{"path":[]},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"background","dir":"","previous_headings":"Feature 1: Hill Numbers for Spatial SACs","what":"Background","title":"spacc v0.2.0 Implementation Plan","text":"Hill numbers unify diversity measures: - q = 0: Species richness (current spacc) - q = 1: Exponential Shannon entropy (effective number common species) - q = 2: Inverse Simpson (effective number dominant species) Formula: qD = (Σ p_i^q)^(1/(1-q)) p_i = relative abundance","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"api-design","dir":"","previous_headings":"Feature 1: Hill Numbers for Spatial SACs","what":"API Design","title":"spacc v0.2.0 Implementation Plan","text":"Recommendation: Add q parameter spacc() simplicity. Default q = 0 maintains backward compatibility.","code":"# Extend existing spacc() with q parameter spacc(x, coords, method = \"knn\", q = 0, ...)  # Or create dedicated function hillspacc(x, coords, method = \"knn\", q = c(0, 1, 2), ...)  # Return object includes curves for each q value"},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"r-changes-rspaccr","dir":"","previous_headings":"Feature 1: Hill Numbers for Spatial SACs > Implementation","what":"R Changes (R/spacc.R)","title":"spacc v0.2.0 Implementation Plan","text":"","code":"spacc <- function(x,                   coords,                   n_seeds = 50L,                   method = c(\"knn\", \"kncn\", \"random\", \"radius\", \"gaussian\", \"cone\", \"collector\"),                   distance = c(\"euclidean\", \"haversine\"),                   q = 0,                   ...) {    # Validate q   stopifnot(\"q must be >= 0\" = all(q >= 0))    # If abundance data and q > 0, need to track abundances not just presence   use_abundance <- any(q > 0)    # Call appropriate C++ function   if (use_abundance) {     curves <- cpp_knn_hill_parallel(x, dist_mat, n_seeds, q, n_cores, progress)   } else {     curves <- cpp_knn_parallel(species_pa, dist_mat, n_seeds, n_cores, progress)   } }"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"c-changes-srchillcpp","dir":"","previous_headings":"Feature 1: Hill Numbers for Spatial SACs > Implementation","what":"C++ Changes (src/hill.cpp)","title":"spacc v0.2.0 Implementation Plan","text":"","code":"// Hill number calculation for a set of abundances double calc_hill(const std::vector<int>& abundances, double q) {   int N = 0;   for (int a : abundances) N += a;   if (N == 0) return 0.0;    if (q == 0) {     // Species richness     int S = 0;     for (int a : abundances) if (a > 0) S++;     return (double)S;   } else if (std::abs(q - 1.0) < 1e-10) {     // Shannon (limit as q -> 1)     double H = 0.0;     for (int a : abundances) {       if (a > 0) {         double p = (double)a / N;         H -= p * std::log(p);       }     }     return std::exp(H);   } else {     // General Hill number     double sum = 0.0;     for (int a : abundances) {       if (a > 0) {         double p = (double)a / N;         sum += std::pow(p, q);       }     }     return std::pow(sum, 1.0 / (1.0 - q));   } }  // Single kNN accumulation with Hill numbers NumericMatrix cpp_knn_hill_single(IntegerMatrix species_mat,                                    NumericMatrix dist_mat,                                    int seed,                                    NumericVector q_values) {   int n_sites = species_mat.nrow();   int n_species = species_mat.ncol();   int n_q = q_values.size();    NumericMatrix curves(n_q, n_sites);   std::vector<bool> visited(n_sites, false);   std::vector<int> cumulative_abundance(n_species, 0);    int current = seed;   visited[current] = true;    // Add first site abundances   for (int sp = 0; sp < n_species; sp++) {     cumulative_abundance[sp] += species_mat(current, sp);   }    // Calculate Hill numbers for each q   for (int qi = 0; qi < n_q; qi++) {     curves(qi, 0) = calc_hill(cumulative_abundance, q_values[qi]);   }    for (int step = 1; step < n_sites; step++) {     // Find nearest unvisited     double min_dist = R_PosInf;     int next = -1;     for (int j = 0; j < n_sites; j++) {       if (!visited[j] && dist_mat(current, j) < min_dist) {         min_dist = dist_mat(current, j);         next = j;       }     }      current = next;     visited[current] = true;      // Accumulate abundances     for (int sp = 0; sp < n_species; sp++) {       cumulative_abundance[sp] += species_mat(current, sp);     }      // Calculate Hill numbers     for (int qi = 0; qi < n_q; qi++) {       curves(qi, step) = calc_hill(cumulative_abundance, q_values[qi]);     }   }    return curves; }"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"new-s3-class-spacc_hill","dir":"","previous_headings":"Feature 1: Hill Numbers for Spatial SACs > Implementation","what":"New S3 Class: spacc_hill","title":"spacc v0.2.0 Implementation Plan","text":"","code":"# Return structure structure(   list(     curves = list(q0 = matrix, q1 = matrix, q2 = matrix),     q = c(0, 1, 2),     coords = coord_data,     n_seeds = n_seeds,     n_sites = n_sites,     n_species = n_species_total,     method = method,     call = match.call()   ),   class = c(\"spacc_hill\", \"spacc\") )"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"plot-method","dir":"","previous_headings":"Feature 1: Hill Numbers for Spatial SACs","what":"Plot Method","title":"spacc v0.2.0 Implementation Plan","text":"","code":"plot.spacc_hill <- function(x, q = NULL, ci = TRUE, ...) {   # If q not specified, plot all   q_vals <- if (is.null(q)) x$q else q    # Create faceted plot with one panel per q value   # Or overlay with different colors }"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"tests","dir":"","previous_headings":"Feature 1: Hill Numbers for Spatial SACs","what":"Tests","title":"spacc v0.2.0 Implementation Plan","text":"","code":"test_that(\"Hill numbers are correct\", {   # Known community: 10 species, abundances 1:10   # q=0 should give 10   # q=1 should give exp(Shannon)   # q=2 should give 1/Simpson    x <- matrix(1:10, nrow = 1)   coords <- data.frame(x = 0, y = 0)    result <- spacc(x, coords, method = \"collector\", q = c(0, 1, 2))    expect_equal(result$curves$q0[1, 1], 10)   # ... verify against vegan::diversity() })"},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"background-1","dir":"","previous_headings":"Feature 2: Spatial Beta Diversity Accumulation","what":"Background","title":"spacc v0.2.0 Implementation Plan","text":"Beta diversity measures compositional change. accumulate sites spatially: - Turnover: Species replacement (species X, B species Y) - Nestedness: Species loss (B subset ) Baselga (2010) framework: β_total = β_turnover + β_nestedness","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"api-design-1","dir":"","previous_headings":"Feature 2: Spatial Beta Diversity Accumulation","what":"API Design","title":"spacc v0.2.0 Implementation Plan","text":"","code":"# New function spaccBeta(x, coords, method = \"knn\", n_seeds = 50,           partition = TRUE, index = \"sorensen\", ...)  # Returns beta diversity vs cumulative sites/distance"},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"core-algorithm","dir":"","previous_headings":"Feature 2: Spatial Beta Diversity Accumulation > Implementation","what":"Core Algorithm","title":"spacc v0.2.0 Implementation Plan","text":"step spatial accumulation: 1. Track species composition accumulated set 2. Compare previous step (pairwise) accumulated (cumulative) 3. Partition turnover nestedness components","code":"# Sorensen-based dissimilarity beta_sor <- function(a, b, c) {   # a = shared species, b = unique to site 1, c = unique to site 2   (b + c) / (2*a + b + c) }  # Turnover component (Simpson) beta_sim <- function(a, b, c) {   min(b, c) / (a + min(b, c)) }  # Nestedness component beta_nes <- function(a, b, c) {   beta_sor(a, b, c) - beta_sim(a, b, c) }"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"c-implementation-srcbetacpp","dir":"","previous_headings":"Feature 2: Spatial Beta Diversity Accumulation > Implementation","what":"C++ Implementation (src/beta.cpp)","title":"spacc v0.2.0 Implementation Plan","text":"","code":"struct BetaResult {   double total;   double turnover;   double nestedness; };  BetaResult calc_beta_sorensen(const std::set<int>& set1,                                const std::set<int>& set2) {   int a = 0;  // shared   int b = 0;  // unique to set1   int c = 0;  // unique to set2    for (int sp : set1) {     if (set2.count(sp)) a++;     else b++;   }   for (int sp : set2) {     if (!set1.count(sp)) c++;   }    BetaResult result;   if (a + b + c == 0) {     result.total = 0;     result.turnover = 0;     result.nestedness = 0;   } else {     result.total = (double)(b + c) / (2.0*a + b + c);     result.turnover = (double)std::min(b, c) / (a + std::min(b, c));     result.nestedness = result.total - result.turnover;   }   return result; }  // Track cumulative beta as sites are added List cpp_beta_accumulation(IntegerMatrix species_pa,                            NumericMatrix dist_mat,                            int seed,                            std::string method) {   int n_sites = species_pa.nrow();   int n_species = species_pa.ncol();    NumericVector beta_total(n_sites - 1);   NumericVector beta_turn(n_sites - 1);   NumericVector beta_nest(n_sites - 1);   NumericVector distances(n_sites - 1);    std::vector<bool> visited(n_sites, false);   std::set<int> prev_species;   std::set<int> curr_species;    int current = seed;   visited[current] = true;    // Initialize with first site   for (int sp = 0; sp < n_species; sp++) {     if (species_pa(current, sp) > 0) {       prev_species.insert(sp);     }   }    double cum_dist = 0.0;    for (int step = 0; step < n_sites - 1; step++) {     // Find next site (kNN logic)     double min_dist = R_PosInf;     int next = -1;     for (int j = 0; j < n_sites; j++) {       if (!visited[j] && dist_mat(current, j) < min_dist) {         min_dist = dist_mat(current, j);         next = j;       }     }      cum_dist += min_dist;     distances[step] = cum_dist;      // Get species at new site     curr_species.clear();     for (int sp = 0; sp < n_species; sp++) {       if (species_pa(next, sp) > 0) {         curr_species.insert(sp);       }     }      // Calculate pairwise beta between accumulated and new site     BetaResult beta = calc_beta_sorensen(prev_species, curr_species);     beta_total[step] = beta.total;     beta_turn[step] = beta.turnover;     beta_nest[step] = beta.nestedness;      // Update accumulated species set     for (int sp : curr_species) {       prev_species.insert(sp);     }      current = next;     visited[current] = true;   }    return List::create(     Named(\"beta_total\") = beta_total,     Named(\"beta_turnover\") = beta_turn,     Named(\"beta_nestedness\") = beta_nest,     Named(\"distance\") = distances   ); }"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"r-wrapper","dir":"","previous_headings":"Feature 2: Spatial Beta Diversity Accumulation > Implementation","what":"R Wrapper","title":"spacc v0.2.0 Implementation Plan","text":"","code":"spaccBeta <- function(x, coords, method = \"knn\", n_seeds = 50,                       partition = TRUE, index = c(\"sorensen\", \"jaccard\"),                       distance = \"euclidean\", progress = TRUE, seed = NULL) {    index <- match.arg(index)    # ... validation ...    results <- cpp_beta_parallel(species_pa, dist_mat, n_seeds, index, n_cores)    structure(     list(       beta_total = results$total,      # matrix: n_seeds x (n_sites-1)       beta_turnover = results$turnover,       beta_nestedness = results$nestedness,       distance = results$distance,       n_seeds = n_seeds,       method = method,       index = index,       call = match.call()     ),     class = \"spacc_beta\"   ) }"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"plot-method-1","dir":"","previous_headings":"Feature 2: Spatial Beta Diversity Accumulation > Implementation","what":"Plot Method","title":"spacc v0.2.0 Implementation Plan","text":"","code":"plot.spacc_beta <- function(x, partition = TRUE, xaxis = c(\"sites\", \"distance\"), ...) {   xaxis <- match.arg(xaxis)    # Summarize across seeds   df <- data.frame(     x = if (xaxis == \"sites\") 2:x$n_sites else colMeans(x$distance),     total = colMeans(x$beta_total),     turnover = colMeans(x$beta_turnover),     nestedness = colMeans(x$beta_nestedness)   )    if (partition) {     # Stacked area chart: turnover + nestedness = total     # Or line plot with three lines   } else {     # Just total beta   } }"},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"background-2","dir":"","previous_headings":"Feature 3: Coverage-Based Spatial Rarefaction","what":"Background","title":"spacc v0.2.0 Implementation Plan","text":"Chao & Jost (2012): Sample completeness (coverage) better sample size standardization. Coverage = proportion total community abundance represented observed species. C = 1 - (f1/n) f1 = singletons, n = total individuals (simplified)","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"api-design-2","dir":"","previous_headings":"Feature 3: Coverage-Based Spatial Rarefaction","what":"API Design","title":"spacc v0.2.0 Implementation Plan","text":"","code":"# Add standardize parameter to spacc() spacc(x, coords, method = \"knn\", standardize = c(\"sites\", \"coverage\"), ...)  # Or separate function spaccCoverage(x, coords, method = \"knn\", target_coverage = 0.95, ...)"},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"coverage-calculation-chao--jost-2012","dir":"","previous_headings":"Feature 3: Coverage-Based Spatial Rarefaction > Implementation","what":"Coverage Calculation (Chao & Jost 2012)","title":"spacc v0.2.0 Implementation Plan","text":"","code":"// Good-Turing coverage estimator double calc_coverage(const std::vector<int>& abundances) {   int n = 0;  // total individuals   int f1 = 0; // singletons   int f2 = 0; // doubletons    for (int a : abundances) {     n += a;     if (a == 1) f1++;     if (a == 2) f2++;   }    if (n == 0) return 0.0;    // Chao & Jost estimator   double C;   if (f2 > 0) {     C = 1.0 - (double)f1 / n * ((n - 1.0) * f1 / ((n - 1.0) * f1 + 2.0 * f2));   } else {     C = 1.0 - (double)f1 / n * ((n - 1.0) / n);   }    return std::max(0.0, std::min(1.0, C)); }"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"spatial-accumulation-with-coverage","dir":"","previous_headings":"Feature 3: Coverage-Based Spatial Rarefaction > Implementation","what":"Spatial Accumulation with Coverage","title":"spacc v0.2.0 Implementation Plan","text":"","code":"List cpp_knn_coverage(IntegerMatrix species_mat,                       NumericMatrix dist_mat,                       int seed) {   int n_sites = species_mat.nrow();   int n_species = species_mat.ncol();    IntegerVector richness(n_sites);   NumericVector coverage(n_sites);    std::vector<bool> visited(n_sites, false);   std::vector<int> cumulative(n_species, 0);    int current = seed;   visited[current] = true;    for (int sp = 0; sp < n_species; sp++) {     cumulative[sp] += species_mat(current, sp);   }    richness[0] = count_species(cumulative);   coverage[0] = calc_coverage(cumulative);    for (int step = 1; step < n_sites; step++) {     // kNN logic to find next site     // ...      // Update cumulative abundances     for (int sp = 0; sp < n_species; sp++) {       cumulative[sp] += species_mat(current, sp);     }      richness[step] = count_species(cumulative);     coverage[step] = calc_coverage(cumulative);   }    return List::create(     Named(\"richness\") = richness,     Named(\"coverage\") = coverage   ); }"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"interpolation-to-target-coverage","dir":"","previous_headings":"Feature 3: Coverage-Based Spatial Rarefaction > Implementation","what":"Interpolation to Target Coverage","title":"spacc v0.2.0 Implementation Plan","text":"","code":"# Interpolate richness at target coverage levels interpolate_coverage <- function(richness, coverage, target = c(0.9, 0.95, 0.99)) {   sapply(target, function(t) {     if (max(coverage) < t) return(NA)     approx(coverage, richness, xout = t)$y   }) }"},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"background-3","dir":"","previous_headings":"Feature 4: Phylogenetic & Functional Diversity","what":"Background","title":"spacc v0.2.0 Implementation Plan","text":"Faith’s PD: Sum branch lengths connecting species sample Functional Diversity (FD): Trait-based diversity (e.g., functional richness, dispersion)","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"api-design-3","dir":"","previous_headings":"Feature 4: Phylogenetic & Functional Diversity","what":"API Design","title":"spacc v0.2.0 Implementation Plan","text":"","code":"# Phylogenetic spaccPhylo(x, coords, tree, method = \"knn\", metric = c(\"PD\", \"MPD\", \"MNTD\"), ...)  # Functional spaccFunc(x, coords, traits, method = \"knn\", metric = c(\"FRic\", \"FDiv\", \"FDis\"), ...)"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"dependencies","dir":"","previous_headings":"Feature 4: Phylogenetic & Functional Diversity","what":"Dependencies","title":"spacc v0.2.0 Implementation Plan","text":"","code":"Suggests:     ape,        # phylogenetic trees     picante,    # PD calculations (optional, can implement ourselves)     FD,         # functional diversity     geometry    # convex hulls for FRic"},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"faiths-pd-calculation","dir":"","previous_headings":"Feature 4: Phylogenetic & Functional Diversity > Phylogenetic Implementation","what":"Faith’s PD Calculation","title":"spacc v0.2.0 Implementation Plan","text":"","code":"# Using ape for tree manipulation calc_pd <- function(tree, tips) {   if (length(tips) == 0) return(0)   if (length(tips) == 1) {     # PD of single tip = edge length to root     node <- which(tree$tip.label == tips)     return(sum(ape::node.depth.edgelength(tree)[node]))   }    # Prune tree to tips   subtree <- ape::keep.tip(tree, tips)   sum(subtree$edge.length) }"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"c-implementation-for-performance","dir":"","previous_headings":"Feature 4: Phylogenetic & Functional Diversity > Phylogenetic Implementation","what":"C++ Implementation for Performance","title":"spacc v0.2.0 Implementation Plan","text":"","code":"// Pre-compute pairwise phylogenetic distances // Then PD = sum of unique branch lengths  // Alternative: cophenetic distance matrix approach // MPD = mean pairwise phylogenetic distance double calc_mpd(const NumericMatrix& phylo_dist,                 const std::set<int>& species) {   if (species.size() < 2) return 0.0;    double sum = 0.0;   int count = 0;    std::vector<int> spp(species.begin(), species.end());   for (size_t i = 0; i < spp.size(); i++) {     for (size_t j = i + 1; j < spp.size(); j++) {       sum += phylo_dist(spp[i], spp[j]);       count++;     }   }    return sum / count; }"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"spatial-pd-accumulation","dir":"","previous_headings":"Feature 4: Phylogenetic & Functional Diversity > Phylogenetic Implementation","what":"Spatial PD Accumulation","title":"spacc v0.2.0 Implementation Plan","text":"","code":"NumericVector cpp_pd_accumulation(IntegerMatrix species_pa,                                    NumericMatrix dist_mat,                                    NumericMatrix phylo_dist,                                    NumericVector edge_lengths,                                    int seed) {   // Track which edges are \"activated\" as species accumulate   // PD = sum of activated edge lengths    // Implementation depends on tree structure   // May need to pass tree as edge list }"},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"functional-richness-convex-hull-volume","dir":"","previous_headings":"Feature 4: Phylogenetic & Functional Diversity > Functional Diversity Implementation","what":"Functional Richness (Convex Hull Volume)","title":"spacc v0.2.0 Implementation Plan","text":"","code":"calc_fric <- function(traits, species_present) {   trait_subset <- traits[species_present, , drop = FALSE]    if (nrow(trait_subset) <= ncol(trait_subset)) {     return(NA)  # Need more species than traits for convex hull   }    # Convex hull volume   hull <- geometry::convhulln(trait_subset, options = \"FA\")   hull$vol }"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"functional-dispersion","dir":"","previous_headings":"Feature 4: Phylogenetic & Functional Diversity > Functional Diversity Implementation","what":"Functional Dispersion","title":"spacc v0.2.0 Implementation Plan","text":"","code":"calc_fdis <- function(traits, species_present, abundances = NULL) {   trait_subset <- traits[species_present, , drop = FALSE]    if (is.null(abundances)) {     abundances <- rep(1, nrow(trait_subset))   }    # Weighted centroid   centroid <- colSums(trait_subset * abundances) / sum(abundances)    # Mean distance to centroid   dists <- sqrt(rowSums((trait_subset - centroid)^2))   sum(dists * abundances) / sum(abundances) }"},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"file-structure-after-implementation","dir":"","previous_headings":"","what":"File Structure After Implementation","title":"spacc v0.2.0 Implementation Plan","text":"","code":"spacc/ ├── R/ │   ├── spacc.R           # Updated: add q parameter │   ├── spaccBeta.R       # NEW: beta diversity accumulation │   ├── spaccCoverage.R   # NEW: coverage-based methods │   ├── spaccPhylo.R      # NEW: phylogenetic diversity │   ├── spaccFunc.R       # NEW: functional diversity │   ├── hill.R            # NEW: Hill number utilities │   └── ... ├── src/ │   ├── hill.cpp          # NEW: Hill number calculations │   ├── beta.cpp          # NEW: beta diversity calculations │   ├── coverage.cpp      # NEW: coverage estimation │   ├── phylo.cpp         # NEW: PD calculations (optional) │   └── ... └── tests/testthat/     ├── test-hill.R       # NEW     ├── test-beta.R       # NEW     ├── test-coverage.R   # NEW     ├── test-phylo.R      # NEW     └── ..."},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"phase-1-hill-numbers-week-1-2","dir":"","previous_headings":"Implementation Order","what":"Phase 1: Hill Numbers (Week 1-2)","title":"spacc v0.2.0 Implementation Plan","text":"Add calc_hill() C++ function Modify cpp_knn_single track abundances Create cpp_knn_hill_parallel Update R wrapper q parameter Add plot method multiple q values Write tests comparing vegan::diversity() Document","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"phase-2-spatial-beta-diversity-week-2-3","dir":"","previous_headings":"Implementation Order","what":"Phase 2: Spatial Beta Diversity (Week 2-3)","title":"spacc v0.2.0 Implementation Plan","text":"Implement calc_beta_sorensen() C++ Create cpp_beta_accumulation() Add parallel version Create spaccBeta() R function Implement S3 methods (print, summary, plot) Write tests comparing betapart Document","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"phase-3-coverage-based-rarefaction-week-3","dir":"","previous_headings":"Implementation Order","what":"Phase 3: Coverage-Based Rarefaction (Week 3)","title":"spacc v0.2.0 Implementation Plan","text":"Implement calc_coverage() C++ Add coverage tracking existing methods Create interpolation function Update spacc() create spaccCoverage() Write tests comparing iNEXT Document","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"phase-4-phylogeneticfunctional-week-4-5","dir":"","previous_headings":"Implementation Order","what":"Phase 4: Phylogenetic/Functional (Week 4-5)","title":"spacc v0.2.0 Implementation Plan","text":"Design tree input format (ape::phylo) Implement PD accumulation (start R, optimize C++ needed) Implement FD accumulation Create spaccPhylo() spaccFunc() Write tests comparing picante/FD Document","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"unit-tests","dir":"","previous_headings":"Testing Strategy","what":"Unit Tests","title":"spacc v0.2.0 Implementation Plan","text":"C++ function corresponding R test Compare reference implementations (vegan, iNEXT, betapart, picante) Edge cases: empty data, single species, single site","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"integration-tests","dir":"","previous_headings":"Testing Strategy","what":"Integration Tests","title":"spacc v0.2.0 Implementation Plan","text":"Full workflow tests simulated data Verify plot methods don’t error Check parallel vs sequential give results","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"performance-tests","dir":"","previous_headings":"Testing Strategy","what":"Performance Tests","title":"spacc v0.2.0 Implementation Plan","text":"Benchmark mobr, vegan Document speedups vignette","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"function-documentation","dir":"","previous_headings":"Documentation Plan","what":"Function Documentation","title":"spacc v0.2.0 Implementation Plan","text":"exported functions roxygen2 docs Examples function Cross-references @seealso","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"vignette-comprehensive-spatial-diversity-analysis","dir":"","previous_headings":"Documentation Plan","what":"Vignette: “Comprehensive Spatial Diversity Analysis”","title":"spacc v0.2.0 Implementation Plan","text":"Introduction: spatial matters Basic Usage: spacc() richness Hill Numbers: Comparing q=0,1,2 Beta Diversity: Turnover vs nestedness Coverage-Based: use Phylogenetic/Functional: Advanced applications Performance: Benchmarks vs alternatives Case Study: Real ecological dataset","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"paper-outline-mee-application","dir":"","previous_headings":"","what":"Paper Outline (MEE Application)","title":"spacc v0.2.0 Implementation Plan","text":"Title: “spacc: Fast spatial diversity accumulation Hill numbers, beta partitioning, phylogenetic extensions” SACs limitations Spatial structure matters Gap: fast, comprehensive tool Hill number spatial accumulation Beta diversity partitioning Coverage standardization Phylogenetic/functional extensions C++ implementation Simulation study: bias random vs spatial Benchmark: performance vs mobr/vegan Case study: real dataset use method Limitations Future directions Fig 1: Conceptual diagram spatial vs random SAC Fig 2: Hill numbers reveal scale-dependent patterns Fig 3: Beta partitioning example Fig 4: Performance benchmarks","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"v020---hill-numbers","dir":"","previous_headings":"Version Milestones","what":"v0.2.0 - Hill Numbers","title":"spacc v0.2.0 Implementation Plan","text":"q parameter spacc() Basic Hill number support","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"v030---beta-diversity","dir":"","previous_headings":"Version Milestones","what":"v0.3.0 - Beta Diversity","title":"spacc v0.2.0 Implementation Plan","text":"spaccBeta() function Turnover/nestedness partitioning","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"v040---coverage","dir":"","previous_headings":"Version Milestones","what":"v0.4.0 - Coverage","title":"spacc v0.2.0 Implementation Plan","text":"Coverage-based standardization Interpolation target coverage","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"v050---phylogeneticfunctional","dir":"","previous_headings":"Version Milestones","what":"v0.5.0 - Phylogenetic/Functional","title":"spacc v0.2.0 Implementation Plan","text":"spaccPhylo() spaccFunc() Requires ape, geometry Suggests","code":""},{"path":"https://gillescolling.com/spacc/IMPLEMENTATION_PLAN.html","id":"v100---paper-release","dir":"","previous_headings":"Version Milestones","what":"v1.0.0 - Paper Release","title":"spacc v0.2.0 Implementation Plan","text":"Full documentation Vignette CRAN submission MEE submission","code":""},{"path":"https://gillescolling.com/spacc/index.html","id":"spacc","dir":"","previous_headings":"","what":"spacc","title":"spacc","text":"Fast Spatial Species Accumulation Curves C++ Performance spacc package computes species accumulation curves diversity metrics. supports classical random-order SACs (method = \"random\") spatially-explicit methods respect spatial arrangement sites using nearest-neighbor algorithms. methods use C++ backend (Rcpp/RcppParallel) speed.","code":""},{"path":"https://gillescolling.com/spacc/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"spacc","text":"","code":"library(spacc)  coords <- data.frame(x = runif(100), y = runif(100)) species <- matrix(rpois(100 * 50, 2), nrow = 100)  # Spatial accumulation curve sac <- spacc(species, coords, method = \"knn\", n_seeds = 50) plot(sac)  # Diversity partitioning part <- diversityPartition(species, q = c(0, 1, 2)) print(part)"},{"path":"https://gillescolling.com/spacc/index.html","id":"statement-of-need","dir":"","previous_headings":"","what":"Statement of Need","title":"spacc","text":"Species accumulation curves fundamental tools understanding sampling completeness comparing biodiversity. spacc computes classical random-order SACs spatially-explicit SACs respect spatial arrangement sites. Comparing two reveals spatial structure affects observed diversity. Applications include: biodiversity assessment spatially structured surveys, community ecology scale-dependent diversity patterns, invasion modeling wavefront directional methods, conservation planning identify high-diversity areas.","code":""},{"path":"https://gillescolling.com/spacc/index.html","id":"performance","dir":"","previous_headings":"","what":"Performance","title":"spacc","text":"spacc automatically selects fastest backend nearest-neighbor queries: Override backend = \"kdtree\" backend = \"exact\". ball tree uses haversine distance natively — coordinate projection needed geographic data.","code":"# Geographic coordinates with haversine distance sac <- spacc(species, coords_lonlat, distance = \"haversine\", n_seeds = 50)  # Force tree backend for smaller datasets sac <- spacc(species, coords, backend = \"kdtree\", n_seeds = 50)"},{"path":[]},{"path":"https://gillescolling.com/spacc/index.html","id":"accumulation-curves","dir":"","previous_headings":"Features","what":"Accumulation Curves","title":"spacc","text":"spacc(): Spatial accumulation 7 methods (knn, kncn, random, radius, gaussian, cone, collector), grouped accumulation (groups), spatiotemporal distance (time, w_space, w_time) spaccHill(): Hill number accumulation (q = 0, 1, 2) spaccBeta(): Beta diversity turnover/nestedness partitioning (Baselga 2010) spaccCoverage(): Coverage-based rarefaction (Chao & Jost 2012) spaccPhylo(): Phylogenetic diversity accumulation (MPD, MNTD) spaccFunc(): Functional diversity accumulation (FDis, FRic) wavefront(): Expanding radius accumulation invasion modeling distanceDecay(): Species richness vs distance focal points","code":""},{"path":"https://gillescolling.com/spacc/index.html","id":"diversity","dir":"","previous_headings":"Features","what":"Diversity","title":"spacc","text":"alphaDiversity(): Per-site Hill numbers (local diversity) gammaDiversity(): Pooled Hill numbers (regional diversity) diversityPartition(): Alpha-beta-gamma decomposition (Jost 2007) spaccMetrics(): Per-site accumulation metrics (slope, AUC, half-richness) diversity accumulation functions support spatial mapping via map = TRUE, plot(x, type = \"map\"), as_sf() sf/GIS integration.","code":""},{"path":"https://gillescolling.com/spacc/index.html","id":"analysis","dir":"","previous_headings":"Features","what":"Analysis","title":"spacc","text":"extrapolate(): Fit asymptotic models (5 options) compare(): Statistical comparison curves rarefy(): Rarefaction common sampling effort subsample(): Spatial subsampling sites coleman(), mao_tau(), spatialRarefaction(): Analytical (non-simulation) methods distances(): Pre-compute distance matrices","code":""},{"path":"https://gillescolling.com/spacc/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"spacc","text":"","code":"# install.packages(\"pak\") pak::pak(\"gcol33/spacc\")"},{"path":[]},{"path":"https://gillescolling.com/spacc/index.html","id":"spatial-accumulation","dir":"","previous_headings":"Usage Examples","what":"Spatial Accumulation","title":"spacc","text":"","code":"coords <- data.frame(x = runif(100), y = runif(100)) species <- matrix(rbinom(100 * 50, 1, 0.3), nrow = 100)  sac <- spacc(species, coords, method = \"knn\", n_seeds = 100) plot(sac)  # Compare spatial vs random sac_random <- spacc(species, coords, method = \"random\", n_seeds = 100) comp <- compare(sac, sac_random) plot(comp)"},{"path":"https://gillescolling.com/spacc/index.html","id":"grouped-accumulation","dir":"","previous_headings":"Usage Examples","what":"Grouped Accumulation","title":"spacc","text":"","code":"# Compare native vs alien species (same spatial ordering) status <- ifelse(grepl(\"alien\", colnames(species)), \"alien\", \"native\") sac_grouped <- spacc(species, coords, groups = status, seed = 42) plot(sac_grouped)                # Overlaid curves per group plot(sac_grouped, facet = TRUE)  # Faceted panels  # Manual grouping with c() sac_a <- spacc(species_a, coords, seed = 42) sac_b <- spacc(species_b, coords, seed = 42) plot(c(native = sac_a, alien = sac_b))"},{"path":"https://gillescolling.com/spacc/index.html","id":"spatiotemporal-accumulation","dir":"","previous_headings":"Usage Examples","what":"Spatiotemporal Accumulation","title":"spacc","text":"","code":"# Sites sampled across years — weighted space-time distance sac_st <- spacc(species, coords, method = \"knn\",                 time = site_years, w_space = 1, w_time = 0.5) plot(sac_st)  # Emphasize temporal proximity over spatial sac_st2 <- spacc(species, coords, method = \"knn\",                  time = site_years, w_space = 0.2, w_time = 1)"},{"path":"https://gillescolling.com/spacc/index.html","id":"diversity-partitioning","dir":"","previous_headings":"Usage Examples","what":"Diversity Partitioning","title":"spacc","text":"","code":"species <- matrix(rpois(100 * 50, 2), nrow = 100)  part <- diversityPartition(species, q = c(0, 1, 2)) part #> Alpha-Beta-Gamma Diversity Partitioning #> 100 sites, 50 species #> #>  q alpha  beta gamma #>  0 12.45  4.01    50 #>  1  8.23  3.12 25.68 #>  2  6.54  2.87 18.77  # Per-site alpha with spatial mapping alpha <- alphaDiversity(species, q = c(0, 1, 2), coords = coords) plot(alpha, type = \"map\", q = 0)"},{"path":"https://gillescolling.com/spacc/index.html","id":"hill-number--beta-diversity-accumulation","dir":"","previous_headings":"Usage Examples","what":"Hill Number & Beta Diversity Accumulation","title":"spacc","text":"","code":"hill <- spaccHill(species, coords, q = c(0, 1, 2), n_seeds = 50, map = TRUE) plot(hill)                         # Accumulation curves plot(hill, type = \"map\", q = 0)    # Spatial map  beta <- spaccBeta(species, coords, index = \"sorensen\", n_seeds = 50, map = TRUE) plot(beta, partition = TRUE) plot(beta, type = \"map\")"},{"path":"https://gillescolling.com/spacc/index.html","id":"coverage-based-rarefaction","dir":"","previous_headings":"Usage Examples","what":"Coverage-Based Rarefaction","title":"spacc","text":"","code":"cov <- spaccCoverage(species, coords, n_seeds = 50, map = TRUE) plot(cov, xaxis = \"coverage\") plot(cov, type = \"map\", metric = \"final_coverage\")"},{"path":"https://gillescolling.com/spacc/index.html","id":"phylogenetic--functional-diversity","dir":"","previous_headings":"Usage Examples","what":"Phylogenetic & Functional Diversity","title":"spacc","text":"","code":"library(ape) tree <- rtree(50) colnames(species) <- tree$tip.label  phylo <- spaccPhylo(species, coords, tree,                     metric = c(\"mpd\", \"mntd\"), map = TRUE) plot(phylo, type = \"map\", metric = \"mpd\")  traits <- matrix(rnorm(50 * 3), nrow = 50) rownames(traits) <- colnames(species) func <- spaccFunc(species, coords, traits,                   metric = c(\"fdis\", \"fric\"), map = TRUE) plot(func, type = \"map\", metric = \"fdis\")"},{"path":"https://gillescolling.com/spacc/index.html","id":"spatial-mapping-with-sf","dir":"","previous_headings":"Usage Examples","what":"Spatial Mapping with sf","title":"spacc","text":"","code":"# Convert any diversity measure to sf for GIS integration metrics <- spaccMetrics(species, coords,                         metrics = c(\"slope_10\", \"half_richness\", \"auc\")) metrics_sf <- as_sf(metrics, crs = 32631)  # Works for all diversity types hill_sf <- as_sf(hill, crs = 32631) beta_sf <- as_sf(beta, crs = 32631)"},{"path":"https://gillescolling.com/spacc/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"spacc","text":"Function Reference","code":""},{"path":"https://gillescolling.com/spacc/index.html","id":"support","dir":"","previous_headings":"","what":"Support","title":"spacc","text":"“Software like sex: ’s better ’s free.” — Linus Torvalds ’m PhD student builds R packages free time believe good tools free open. started projects work figured others might find useful . package saved time, buying coffee nice way say thanks. helps coffee addiction.","code":""},{"path":"https://gillescolling.com/spacc/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"spacc","text":"MIT (see LICENSE.md file)","code":""},{"path":"https://gillescolling.com/spacc/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"spacc","text":"","code":"@software{spacc,   author = {Colling, Gilles},   title = {spacc: Fast Spatial Species Accumulation Curves},   year = {2025},   url = {https://github.com/gcol33/spacc} }"},{"path":"https://gillescolling.com/spacc/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2026 Gilles Colling Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"spacc Implementation Plan","text":"Fast spatial species accumulation curves C++ backend.","code":""},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"architecture","dir":"","previous_headings":"","what":"Architecture","title":"spacc Implementation Plan","text":"","code":"spacc/ ├── R/ │   ├── spacc-package.R      # Package docs, Rcpp/RcppParallel imports │   ├── fast_spatial_sac.R   # Main user-facing function │   ├── sac_summary.R        # Summary methods │   ├── plot.R               # ggplot2 visualization │   └── utils.R              # Input validation, helpers ├── src/ │   ├── distance.cpp         # Fast distance matrix computation │   ├── knn.cpp              # k-Nearest Neighbor accumulation │   ├── kncn.cpp             # k-Nearest Centroid Neighbor accumulation │   ├── parallel.cpp         # RcppParallel workers for multi-seed │   └── RcppExports.cpp      # Auto-generated └── tests/     └── testthat/         ├── test-distance.R         ├── test-knn.R         └── test-benchmark.R"},{"path":[]},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"phase-1-core-c-distance-computation","dir":"","previous_headings":"Implementation Phases","what":"Phase 1: Core C++ Distance Computation","title":"spacc Implementation Plan","text":"Goal: Fast pairwise distance matrix Files: - src/distance.cpp - R/fast_distance_matrix.R Implementation: Benchmark target: 10x faster dist() n > 1000","code":"// Euclidean distance, O(n²) but vectorized NumericMatrix fast_dist(NumericVector x, NumericVector y);"},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"phase-2-knn-accumulation-single-seed","dir":"","previous_headings":"Implementation Phases","what":"Phase 2: kNN Accumulation (Single Seed)","title":"spacc Implementation Plan","text":"Goal: Single nearest-neighbor traversal Files: - src/knn.cpp - R/fast_spatial_sac.R (partial) Algorithm: Key optimization: Pre-compute distance matrix , reuse lookups","code":"1. Start at seed plot 2. Mark visited, record species 3. Find nearest unvisited (use pre-computed distances) 4. Repeat until all visited 5. Return cumulative species vector"},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"phase-3-multi-seed-parallelization","dir":"","previous_headings":"Implementation Phases","what":"Phase 3: Multi-Seed Parallelization","title":"spacc Implementation Plan","text":"Goal: Run n_seeds iterations parallel Files: - src/parallel.cpp - R/fast_spatial_sac.R (complete) Implementation: Benchmark target: Near-linear scaling cores","code":"// RcppParallel worker struct SacWorker : public Worker {   // Input: distance matrix, species matrix, seed indices   // Output: matrix of accumulation curves (n_seeds x n_plots) };"},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"phase-4-summary-statistics","dir":"","previous_headings":"Implementation Phases","what":"Phase 4: Summary Statistics","title":"spacc Implementation Plan","text":"Goal: Mean curve, CI, saturation metrics Files: - R/sac_summary.R Outputs: - Mean accumulation curve - 2.5% 97.5% quantiles (95% CI) - Saturation point (curve reaches X% max) - Coefficient variation midpoint","code":""},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"phase-5-visualization","dir":"","previous_headings":"Implementation Phases","what":"Phase 5: Visualization","title":"spacc Implementation Plan","text":"Goal: ggplot2 method sac objects Files: - R/plot.R Features: - Mean line CI ribbon - Optional: individual seed curves - Optional: saturation point marker","code":""},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"phase-6-kncn-method-optional","dir":"","previous_headings":"Implementation Phases","what":"Phase 6: kNCN Method (Optional)","title":"spacc Implementation Plan","text":"Goal: Centroid-recalculating variant Files: - src/kncn.cpp Difference kNN: step, recalculate centroid visited plots, find nearest unvisited centroid (current plot)","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"input","dir":"","previous_headings":"Data Structures","what":"Input","title":"spacc Implementation Plan","text":"","code":"# species: data.frame or matrix #   - Rows: plots #   - Cols: species (presence/absence or abundance) # OR #   - Long format: plot_id, species_id columns  # coords: data.frame #   - x: longitude or easting #   - y: latitude or northing"},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"output-s3-class-spatial_sac","dir":"","previous_headings":"Data Structures","what":"Output (S3 class “spatial_sac”)","title":"spacc Implementation Plan","text":"","code":"list(   curves = matrix,      # n_seeds x n_plots, cumulative species   coords = data.frame,  # original coordinates   n_seeds = integer,   method = character,   # \"knn\" or \"kncn\"   call = call )"},{"path":[]},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"dependencies","dir":"","previous_headings":"","what":"Dependencies","title":"spacc Implementation Plan","text":"Runtime: - Rcpp (C++ interface) - RcppParallel (parallel workers) - ggplot2 (plotting) Build: - C++11 compiler - GNU make","code":""},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"testing-strategy","dir":"","previous_headings":"","what":"Testing Strategy","title":"spacc Implementation Plan","text":"Correctness: Compare output mobr small datasets Performance: Benchmark mobr, pure R implementation Edge cases: Single plot, single species, empty data","code":""},{"path":"https://gillescolling.com/spacc/PLAN.html","id":"milestones","dir":"","previous_headings":"","what":"Milestones","title":"spacc Implementation Plan","text":"Phase 1: Distance matrix (1 day) Phase 2: kNN single seed (1 day) Phase 3: Parallel multi-seed (1 day) Phase 4: Summary stats (0.5 day) Phase 5: Plotting (0.5 day) Phase 6: kNCN (optional, 1 day) Documentation & vignette (1 day) CRAN submission prep (1 day)","code":""},{"path":"https://gillescolling.com/spacc/reference/alphaDiversity.html","id":null,"dir":"Reference","previous_headings":"","what":"Alpha Diversity (Per-Site) — alphaDiversity","title":"Alpha Diversity (Per-Site) — alphaDiversity","text":"Compute Hill numbers site individually.","code":""},{"path":"https://gillescolling.com/spacc/reference/alphaDiversity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Alpha Diversity (Per-Site) — alphaDiversity","text":"","code":"alphaDiversity(x, q = c(0, 1, 2), coords = NULL)"},{"path":"https://gillescolling.com/spacc/reference/alphaDiversity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Alpha Diversity (Per-Site) — alphaDiversity","text":"x site--species matrix (abundance data). q Numeric vector. Orders diversity. Default c(0, 1, 2). coords Optional data.frame columns x y spatial mapping. provided, returns spacc_alpha object as_sf() plot(type = \"map\") support.","code":""},{"path":"https://gillescolling.com/spacc/reference/alphaDiversity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Alpha Diversity (Per-Site) — alphaDiversity","text":"coords NULL, data.frame columns q value. coords provided, spacc_alpha object.","code":""},{"path":"https://gillescolling.com/spacc/reference/alphaDiversity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Alpha Diversity (Per-Site) — alphaDiversity","text":"Alpha diversity represents local (within-site) diversity. Hill numbers: q=0: Species richness q=1: Exponential Shannon entropy q=2: Inverse Simpson concentration","code":""},{"path":"https://gillescolling.com/spacc/reference/alphaDiversity.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Alpha Diversity (Per-Site) — alphaDiversity","text":"Jost, L. (2007). Partitioning diversity independent alpha beta components. Ecology, 88, 2427-2439.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/alphaDiversity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Alpha Diversity (Per-Site) — alphaDiversity","text":"","code":"species <- matrix(rpois(50 * 30, 2), nrow = 50) alpha <- alphaDiversity(species, q = c(0, 1, 2)) head(alpha)  # Mean alpha diversity colMeans(alpha)"},{"path":"https://gillescolling.com/spacc/reference/analytical.html","id":null,"dir":"Reference","previous_headings":"","what":"Analytical Accumulation Methods — analytical","title":"Analytical Accumulation Methods — analytical","text":"methods compute expected species accumulation without simulation. faster provide spatial information.","code":""},{"path":"https://gillescolling.com/spacc/reference/as_sf.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert spacc_metrics to sf — as_sf","title":"Convert spacc_metrics to sf — as_sf","text":"Convert metrics sf object spatial analysis integration areaOfEffect package.","code":""},{"path":"https://gillescolling.com/spacc/reference/as_sf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert spacc_metrics to sf — as_sf","text":"","code":"as_sf(x, crs = NULL)"},{"path":"https://gillescolling.com/spacc/reference/as_sf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert spacc_metrics to sf — as_sf","text":"x spacc_metrics object. crs Coordinate reference system. Default NULL (CRS). Use EPSG codes like 4326 WGS84 32631 UTM zone 31N.","code":""},{"path":"https://gillescolling.com/spacc/reference/as_sf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert spacc_metrics to sf — as_sf","text":"sf object POINT geometries metric columns.","code":""},{"path":"https://gillescolling.com/spacc/reference/as_sf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert spacc_metrics to sf — as_sf","text":"","code":"if (FALSE) { # \\dontrun{ metrics <- spaccMetrics(species, coords)  # Convert to sf with UTM projection metrics_sf <- as_sf(metrics, crs = 32631)  # Use with areaOfEffect for spatial analysis if (requireNamespace(\"areaOfEffect\", quietly = TRUE)) {   result <- areaOfEffect::aoe(metrics_sf, support = study_area) } } # }"},{"path":"https://gillescolling.com/spacc/reference/c.spacc.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine spacc Objects — c.spacc","title":"Combine spacc Objects — c.spacc","text":"Combine spacc Objects","code":""},{"path":"https://gillescolling.com/spacc/reference/c.spacc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine spacc Objects — c.spacc","text":"","code":"# S3 method for class 'spacc' c(...)"},{"path":"https://gillescolling.com/spacc/reference/c.spacc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine spacc Objects — c.spacc","text":"... Named spacc objects combine grouped spacc.","code":""},{"path":"https://gillescolling.com/spacc/reference/c.spacc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine spacc Objects — c.spacc","text":"grouped spacc object per-group curves.","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_coverage.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Good-Turing Coverage Estimate — calc_coverage","title":"Calculate Good-Turing Coverage Estimate — calc_coverage","text":"Coverage = proportion community represented observed species. Uses Chao & Jost (2012) estimator.","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_coverage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Good-Turing Coverage Estimate — calc_coverage","text":"","code":"calc_coverage(abundances)"},{"path":"https://gillescolling.com/spacc/reference/calc_coverage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Good-Turing Coverage Estimate — calc_coverage","text":"abundances Vector species abundances","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_coverage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Good-Turing Coverage Estimate — calc_coverage","text":"Coverage estimate (0 1)","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_faith_pd.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Faith's PD from branch lengths — calc_faith_pd","title":"Calculate Faith's PD from branch lengths — calc_faith_pd","text":"Sum branch lengths connecting species sample root. Requires edge matrix edge lengths ape::phylo object.","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_faith_pd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Faith's PD from branch lengths — calc_faith_pd","text":"","code":"calc_faith_pd(edge, edge_length, n_tips, species_present)"},{"path":"https://gillescolling.com/spacc/reference/calc_faith_pd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Faith's PD from branch lengths — calc_faith_pd","text":"edge Integer matrix (n_edges x 2) tree edges edge_length Numeric vector edge lengths n_tips Number tips tree species_present Logical vector indicating tips present","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_faith_pd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Faith's PD from branch lengths — calc_faith_pd","text":"Faith's PD","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_fdis.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Functional Dispersion (FDis) — calc_fdis","title":"Calculate Functional Dispersion (FDis) — calc_fdis","text":"Mean distance abundance-weighted centroid trait space.","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_fdis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Functional Dispersion (FDis) — calc_fdis","text":"","code":"calc_fdis(traits, species_present, abundances)"},{"path":"https://gillescolling.com/spacc/reference/calc_fdis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Functional Dispersion (FDis) — calc_fdis","text":"traits Numeric matrix (species x traits) species_present Logical vector present species abundances Abundance vector","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_fdis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Functional Dispersion (FDis) — calc_fdis","text":"FDis value","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_fric_approx.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Functional Richness (convex hull volume approximation) — calc_fric_approx","title":"Calculate Functional Richness (convex hull volume approximation) — calc_fric_approx","text":"Uses simplified volume estimation based trait ranges. true FRic, use R's geometry::convhulln.","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_fric_approx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Functional Richness (convex hull volume approximation) — calc_fric_approx","text":"","code":"calc_fric_approx(traits, species_present)"},{"path":"https://gillescolling.com/spacc/reference/calc_fric_approx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Functional Richness (convex hull volume approximation) — calc_fric_approx","text":"traits Numeric matrix (species x traits) species_present Logical vector","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_fric_approx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Functional Richness (convex hull volume approximation) — calc_fric_approx","text":"Approximate functional volume","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_hill_number.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Hill Number for a vector of abundances — calc_hill_number","title":"Calculate Hill Number for a vector of abundances — calc_hill_number","text":"Calculate Hill Number vector abundances","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_hill_number.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Hill Number for a vector of abundances — calc_hill_number","text":"","code":"calc_hill_number(abundances, q)"},{"path":"https://gillescolling.com/spacc/reference/calc_hill_number.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Hill Number for a vector of abundances — calc_hill_number","text":"abundances Vector species abundances q Order diversity (0 = richness, 1 = Shannon, 2 = Simpson)","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_hill_number.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Hill Number for a vector of abundances — calc_hill_number","text":"Hill number (effective number species)","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_mntd.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Mean Nearest Taxon Distance (MNTD) — calc_mntd","title":"Calculate Mean Nearest Taxon Distance (MNTD) — calc_mntd","text":"Mean distance nearest relative species sample.","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_mntd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Mean Nearest Taxon Distance (MNTD) — calc_mntd","text":"","code":"calc_mntd(   dist_mat,   species_present,   abundance_weighted = FALSE,   abundances = numeric() )"},{"path":"https://gillescolling.com/spacc/reference/calc_mntd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Mean Nearest Taxon Distance (MNTD) — calc_mntd","text":"dist_mat Pairwise distance matrix (species x species) species_present Logical vector indicating species present abundance_weighted true, weight abundances abundances Vector abundances","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_mntd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Mean Nearest Taxon Distance (MNTD) — calc_mntd","text":"MNTD value","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_mpd.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Mean Pairwise Distance (MPD) — calc_mpd","title":"Calculate Mean Pairwise Distance (MPD) — calc_mpd","text":"Mean phylogenetic functional distance species sample.","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_mpd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Mean Pairwise Distance (MPD) — calc_mpd","text":"","code":"calc_mpd(   dist_mat,   species_present,   abundance_weighted = FALSE,   abundances = numeric() )"},{"path":"https://gillescolling.com/spacc/reference/calc_mpd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Mean Pairwise Distance (MPD) — calc_mpd","text":"dist_mat Pairwise distance matrix (species x species) species_present Logical vector indicating species present abundance_weighted true, weight abundances abundances Vector abundances (used abundance_weighted = true)","code":""},{"path":"https://gillescolling.com/spacc/reference/calc_mpd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Mean Pairwise Distance (MPD) — calc_mpd","text":"MPD value","code":""},{"path":"https://gillescolling.com/spacc/reference/coleman.html","id":null,"dir":"Reference","previous_headings":"","what":"Coleman Expected Accumulation — coleman","title":"Coleman Expected Accumulation — coleman","text":"Compute expected species accumulation curve using Coleman method (Coleman et al. 1982). analytical formula, simulation needed.","code":""},{"path":"https://gillescolling.com/spacc/reference/coleman.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coleman Expected Accumulation — coleman","text":"","code":"coleman(x)"},{"path":"https://gillescolling.com/spacc/reference/coleman.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coleman Expected Accumulation — coleman","text":"x site--species matrix (presence/absence abundance).","code":""},{"path":"https://gillescolling.com/spacc/reference/coleman.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coleman Expected Accumulation — coleman","text":"data.frame columns: sites, expected, sd","code":""},{"path":"https://gillescolling.com/spacc/reference/coleman.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Coleman Expected Accumulation — coleman","text":"Coleman, B.D., Mares, M.., Willig, M.R. & Hsieh, Y.H. (1982). Randomness, area, species richness. Ecology, 63, 1121-1133.","code":""},{"path":"https://gillescolling.com/spacc/reference/collector.html","id":null,"dir":"Reference","previous_headings":"","what":"Collector's Curve — collector","title":"Collector's Curve — collector","text":"Compute species accumulation curve order sites appear data (randomization). Useful understanding data collected.","code":""},{"path":"https://gillescolling.com/spacc/reference/collector.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collector's Curve — collector","text":"","code":"collector(x)"},{"path":"https://gillescolling.com/spacc/reference/collector.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collector's Curve — collector","text":"x site--species matrix.","code":""},{"path":"https://gillescolling.com/spacc/reference/collector.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collector's Curve — collector","text":"data.frame columns: sites, species","code":""},{"path":"https://gillescolling.com/spacc/reference/compare.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare Two Accumulation Curves — compare","title":"Compare Two Accumulation Curves — compare","text":"Test whether two species accumulation curves differ significantly.","code":""},{"path":"https://gillescolling.com/spacc/reference/compare.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare Two Accumulation Curves — compare","text":"","code":"compare(   x,   y,   method = c(\"permutation\", \"bootstrap\", \"auc\"),   n_perm = 999L,   ... )"},{"path":"https://gillescolling.com/spacc/reference/compare.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare Two Accumulation Curves — compare","text":"x spacc object. y spacc object. method Character. Comparison method: \"permutation\" (default), \"bootstrap\", \"auc\" (area curve difference). n_perm Integer. Number permutations/bootstrap replicates. Default 999. ... Additional arguments passed comparison methods.","code":""},{"path":"https://gillescolling.com/spacc/reference/compare.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare Two Accumulation Curves — compare","text":"object class spacc_comp containing: x_name, y_name Names compared objects auc_diff Difference area curve p_value P-value permutation test saturation_diff Difference saturation points method Comparison method used","code":""},{"path":"https://gillescolling.com/spacc/reference/compare.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compare Two Accumulation Curves — compare","text":"Colwell, R.K., Mao, C.X. & Chang, J. (2004). Interpolating, extrapolating, comparing incidence-based species accumulation curves. Ecology, 85, 2717-2727. Gotelli, N.J. & Colwell, R.K. (2011). Estimating species richness. : Biological Diversity: Frontiers Measurement Assessment, pp. 39-54. Oxford University Press.","code":""},{"path":"https://gillescolling.com/spacc/reference/compare.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare Two Accumulation Curves — compare","text":"","code":"if (FALSE) { # \\dontrun{ sac_native <- spacc(native_species, coords) sac_alien <- spacc(alien_species, coords)  comp <- compare(sac_native, sac_alien) print(comp) plot(comp) } # }"},{"path":"https://gillescolling.com/spacc/reference/cpp_beta_knn_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel kNN Beta Diversity Accumulation — cpp_beta_knn_parallel","title":"Parallel kNN Beta Diversity Accumulation — cpp_beta_knn_parallel","text":"Parallel kNN Beta Diversity Accumulation","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_beta_knn_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel kNN Beta Diversity Accumulation — cpp_beta_knn_parallel","text":"","code":"cpp_beta_knn_parallel(   species_pa,   dist_mat,   n_seeds,   use_jaccard = FALSE,   n_cores = 1L,   progress = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/cpp_beta_knn_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel kNN Beta Diversity Accumulation — cpp_beta_knn_parallel","text":"species_pa Integer matrix (sites x species) dist_mat Distance matrix n_seeds Number starting points use_jaccard Use Jaccard instead Sorensen n_cores Number cores progress Show progress","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_beta_knn_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel kNN Beta Diversity Accumulation — cpp_beta_knn_parallel","text":"List matrices beta component","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_beta_knn_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Single kNN Beta Diversity Accumulation — cpp_beta_knn_single","title":"Single kNN Beta Diversity Accumulation — cpp_beta_knn_single","text":"Track beta diversity (total, turnover, nestedness) changes sites accumulated spatially using kNN method.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_beta_knn_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single kNN Beta Diversity Accumulation — cpp_beta_knn_single","text":"","code":"cpp_beta_knn_single(species_pa, dist_mat, seed, use_jaccard = FALSE)"},{"path":"https://gillescolling.com/spacc/reference/cpp_beta_knn_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single kNN Beta Diversity Accumulation — cpp_beta_knn_single","text":"species_pa Integer matrix (sites x species) presence/absence dist_mat Numeric matrix pairwise distances seed Starting site index (0-based) use_jaccard true, use Jaccard; otherwise Sorensen","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_beta_knn_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single kNN Beta Diversity Accumulation — cpp_beta_knn_single","text":"List beta_total, beta_turnover, beta_nestedness, distance vectors","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_collector_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Collector Accumulation (data order) — cpp_collector_single","title":"Collector Accumulation (data order) — cpp_collector_single","text":"Collector Accumulation (data order)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_collector_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collector Accumulation (data order) — cpp_collector_single","text":"","code":"cpp_collector_single(species_pa)"},{"path":"https://gillescolling.com/spacc/reference/cpp_collector_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collector Accumulation (data order) — cpp_collector_single","text":"species_pa Integer matrix (sites x species)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_collector_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collector Accumulation (data order) — cpp_collector_single","text":"Integer vector cumulative species counts","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_cone_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel Directional Cone Accumulation — cpp_cone_parallel","title":"Parallel Directional Cone Accumulation — cpp_cone_parallel","text":"Parallel Directional Cone Accumulation","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_cone_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel Directional Cone Accumulation — cpp_cone_parallel","text":"","code":"cpp_cone_parallel(   species_pa,   x,   y,   n_seeds,   width = 0.785398,   n_cores = 1L,   progress = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/cpp_cone_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel Directional Cone Accumulation — cpp_cone_parallel","text":"species_pa Integer matrix (sites x species) x Numeric vector x coordinates y Numeric vector y coordinates n_seeds Number random starting points width Cone half-width radians (default pi/4) n_cores Number cores progress Show progress","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_cone_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel Directional Cone Accumulation — cpp_cone_parallel","text":"Integer matrix accumulation curves","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_cone_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Single Directional Cone Accumulation — cpp_cone_single","title":"Single Directional Cone Accumulation — cpp_cone_single","text":"Expand direction angular constraint.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_cone_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single Directional Cone Accumulation — cpp_cone_single","text":"","code":"cpp_cone_single(species_pa, x, y, seed, angle, width)"},{"path":"https://gillescolling.com/spacc/reference/cpp_cone_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single Directional Cone Accumulation — cpp_cone_single","text":"species_pa Integer matrix (sites x species) x Numeric vector x coordinates y Numeric vector y coordinates seed Starting site index (0-based) angle Direction angle radians (0 = east, pi/2 = north) width Cone half-width radians","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_cone_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single Directional Cone Accumulation — cpp_cone_single","text":"Integer vector cumulative species counts","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_distance_decay_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel Distance-Decay Accumulation — cpp_distance_decay_parallel","title":"Parallel Distance-Decay Accumulation — cpp_distance_decay_parallel","text":"Parallel Distance-Decay Accumulation","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_distance_decay_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel Distance-Decay Accumulation — cpp_distance_decay_parallel","text":"","code":"cpp_distance_decay_parallel(   species_pa,   dist_mat,   n_seeds,   breaks,   n_cores = 1L,   progress = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/cpp_distance_decay_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel Distance-Decay Accumulation — cpp_distance_decay_parallel","text":"species_pa Integer matrix (sites x species) dist_mat Numeric matrix pairwise distances n_seeds Number random starting points breaks Distance thresholds n_cores Number cores progress Show progress","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_distance_decay_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel Distance-Decay Accumulation — cpp_distance_decay_parallel","text":"Integer matrix species counts","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_distance_decay_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance-Decay Accumulation — cpp_distance_decay_single","title":"Distance-Decay Accumulation — cpp_distance_decay_single","text":"Returns species count distance threshold seed.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_distance_decay_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance-Decay Accumulation — cpp_distance_decay_single","text":"","code":"cpp_distance_decay_single(species_pa, dist_mat, seed, breaks)"},{"path":"https://gillescolling.com/spacc/reference/cpp_distance_decay_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance-Decay Accumulation — cpp_distance_decay_single","text":"species_pa Integer matrix (sites x species) dist_mat Distance matrix seed Starting site breaks Distance thresholds","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_distance_decay_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distance-Decay Accumulation — cpp_distance_decay_single","text":"Integer vector cumulative species threshold","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_distance_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Fast Distance Matrix — cpp_distance_matrix","title":"Fast Distance Matrix — cpp_distance_matrix","text":"Compute pairwise distances points using Euclidean Haversine formula.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_distance_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fast Distance Matrix — cpp_distance_matrix","text":"","code":"cpp_distance_matrix(x, y, method = \"euclidean\")"},{"path":"https://gillescolling.com/spacc/reference/cpp_distance_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fast Distance Matrix — cpp_distance_matrix","text":"x Numeric vector x coordinates (longitude haversine) y Numeric vector y coordinates (latitude haversine) method Distance method: \"euclidean\" \"haversine\"","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_distance_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fast Distance Matrix — cpp_distance_matrix","text":"Symmetric n x n distance matrix","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_func_knn_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel Functional Diversity Accumulation — cpp_func_knn_parallel","title":"Parallel Functional Diversity Accumulation — cpp_func_knn_parallel","text":"Parallel Functional Diversity Accumulation","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_func_knn_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel Functional Diversity Accumulation — cpp_func_knn_parallel","text":"","code":"cpp_func_knn_parallel(   species_mat,   site_dist_mat,   traits,   n_seeds,   metrics,   n_cores = 1L,   progress = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/cpp_func_knn_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel Functional Diversity Accumulation — cpp_func_knn_parallel","text":"species_mat Integer matrix (sites x species) abundances site_dist_mat Site distance matrix traits Trait matrix (species x traits) n_seeds Number random starting points metrics Character vector metrics compute n_cores Number cores progress Show progress","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_func_knn_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel Functional Diversity Accumulation — cpp_func_knn_parallel","text":"List matrices metric","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_func_knn_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Single kNN Functional Diversity Accumulation — cpp_func_knn_single","title":"Single kNN Functional Diversity Accumulation — cpp_func_knn_single","text":"Single kNN Functional Diversity Accumulation","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_func_knn_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single kNN Functional Diversity Accumulation — cpp_func_knn_single","text":"","code":"cpp_func_knn_single(species_mat, site_dist_mat, traits, seed, metrics)"},{"path":"https://gillescolling.com/spacc/reference/cpp_func_knn_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single kNN Functional Diversity Accumulation — cpp_func_knn_single","text":"species_mat Integer matrix (sites x species) abundances site_dist_mat Site distance matrix traits Trait matrix (species x traits) seed Starting site metrics Metrics: \"fdis\", \"fric\"","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_func_knn_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single kNN Functional Diversity Accumulation — cpp_func_knn_single","text":"List curves metric","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_gaussian_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel Gaussian-weighted Accumulation — cpp_gaussian_parallel","title":"Parallel Gaussian-weighted Accumulation — cpp_gaussian_parallel","text":"Parallel Gaussian-weighted Accumulation","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_gaussian_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel Gaussian-weighted Accumulation — cpp_gaussian_parallel","text":"","code":"cpp_gaussian_parallel(   species_pa,   dist_mat,   n_seeds,   sigma,   n_cores = 1L,   progress = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/cpp_gaussian_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel Gaussian-weighted Accumulation — cpp_gaussian_parallel","text":"species_pa Integer matrix (sites x species) dist_mat Numeric matrix pairwise distances n_seeds Number random starting points sigma Gaussian bandwidth parameter n_cores Number cores progress Show progress","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_gaussian_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel Gaussian-weighted Accumulation — cpp_gaussian_parallel","text":"Integer matrix accumulation curves","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_gaussian_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Single Gaussian-weighted Accumulation — cpp_gaussian_single","title":"Single Gaussian-weighted Accumulation — cpp_gaussian_single","text":"Probabilistically select next site weighted distance (Gaussian decay). Small sigma approximates kNN, large sigma approximates random.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_gaussian_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single Gaussian-weighted Accumulation — cpp_gaussian_single","text":"","code":"cpp_gaussian_single(species_pa, dist_mat, seed, sigma)"},{"path":"https://gillescolling.com/spacc/reference/cpp_gaussian_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single Gaussian-weighted Accumulation — cpp_gaussian_single","text":"species_pa Integer matrix (sites x species) dist_mat Numeric matrix pairwise distances seed Starting site index (0-based) sigma Gaussian bandwidth parameter","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_gaussian_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single Gaussian-weighted Accumulation — cpp_gaussian_single","text":"Integer vector cumulative species counts","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_kncn_metrics_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel kNCN Metrics Accumulation — cpp_kncn_metrics_parallel","title":"Parallel kNCN Metrics Accumulation — cpp_kncn_metrics_parallel","text":"Run kNCN accumulation site starting point.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_kncn_metrics_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel kNCN Metrics Accumulation — cpp_kncn_metrics_parallel","text":"","code":"cpp_kncn_metrics_parallel(   species_pa,   x_coords,   y_coords,   n_cores = 1L,   progress = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/cpp_kncn_metrics_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel kNCN Metrics Accumulation — cpp_kncn_metrics_parallel","text":"species_pa Integer matrix (sites x species) x_coords Numeric vector x coordinates y_coords Numeric vector y coordinates n_cores Number cores use progress Show progress (currently ignored C++)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_kncn_metrics_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel kNCN Metrics Accumulation — cpp_kncn_metrics_parallel","text":"Integer matrix (n_sites x n_sites) accumulation curves","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_kncn_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel kNCN Accumulation — cpp_kncn_parallel","title":"Parallel kNCN Accumulation — cpp_kncn_parallel","text":"Run kNCN accumulation multiple random starting points parallel.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_kncn_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel kNCN Accumulation — cpp_kncn_parallel","text":"","code":"cpp_kncn_parallel(species_pa, x, y, n_seeds, n_cores = 1L, progress = FALSE)"},{"path":"https://gillescolling.com/spacc/reference/cpp_kncn_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel kNCN Accumulation — cpp_kncn_parallel","text":"species_pa Integer matrix (sites x species) x Numeric vector x coordinates y Numeric vector y coordinates n_seeds Number random starting points n_cores Number cores use progress Show progress (currently ignored)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_kncn_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel kNCN Accumulation — cpp_kncn_parallel","text":"Integer matrix (n_seeds x n_sites) accumulation curves","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_kncn_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Single kNCN Accumulation Curve — cpp_kncn_single","title":"Single kNCN Accumulation Curve — cpp_kncn_single","text":"k-Nearest Centroid Neighbor: step, recalculate centroid visited sites, find unvisited site nearest centroid.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_kncn_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single kNCN Accumulation Curve — cpp_kncn_single","text":"","code":"cpp_kncn_single(species_pa, x, y, seed)"},{"path":"https://gillescolling.com/spacc/reference/cpp_kncn_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single kNCN Accumulation Curve — cpp_kncn_single","text":"species_pa Integer matrix (sites x species), presence/absence x Numeric vector x coordinates y Numeric vector y coordinates seed Starting site index (0-based)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_kncn_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single kNCN Accumulation Curve — cpp_kncn_single","text":"Integer vector cumulative species counts","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_coverage_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel kNN Accumulation with Coverage — cpp_knn_coverage_parallel","title":"Parallel kNN Accumulation with Coverage — cpp_knn_coverage_parallel","text":"Parallel kNN Accumulation Coverage","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_coverage_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel kNN Accumulation with Coverage — cpp_knn_coverage_parallel","text":"","code":"cpp_knn_coverage_parallel(   species_mat,   dist_mat,   n_seeds,   n_cores = 1L,   progress = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_coverage_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel kNN Accumulation with Coverage — cpp_knn_coverage_parallel","text":"species_mat Integer matrix (sites x species) dist_mat Distance matrix n_seeds Number starting points n_cores Number cores progress Show progress","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_coverage_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel kNN Accumulation with Coverage — cpp_knn_coverage_parallel","text":"List richness, individuals, coverage matrices","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_coverage_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Single kNN Accumulation with Coverage Tracking — cpp_knn_coverage_single","title":"Single kNN Accumulation with Coverage Tracking — cpp_knn_coverage_single","text":"Single kNN Accumulation Coverage Tracking","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_coverage_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single kNN Accumulation with Coverage Tracking — cpp_knn_coverage_single","text":"","code":"cpp_knn_coverage_single(species_mat, dist_mat, seed)"},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_coverage_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single kNN Accumulation with Coverage Tracking — cpp_knn_coverage_single","text":"species_mat Integer matrix (sites x species) abundances dist_mat Numeric matrix pairwise distances seed Starting site index (0-based)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_coverage_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single kNN Accumulation with Coverage Tracking — cpp_knn_coverage_single","text":"List richness, individuals, coverage vectors","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_hill_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel kNN Accumulation with Hill Numbers — cpp_knn_hill_parallel","title":"Parallel kNN Accumulation with Hill Numbers — cpp_knn_hill_parallel","text":"Parallel kNN Accumulation Hill Numbers","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_hill_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel kNN Accumulation with Hill Numbers — cpp_knn_hill_parallel","text":"","code":"cpp_knn_hill_parallel(   species_mat,   dist_mat,   n_seeds,   q_values,   n_cores = 1L,   progress = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_hill_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel kNN Accumulation with Hill Numbers — cpp_knn_hill_parallel","text":"species_mat Integer matrix (sites x species) abundances dist_mat Numeric matrix pairwise distances n_seeds Number random starting points q_values Vector Hill number orders n_cores Number cores progress Show progress","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_hill_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel kNN Accumulation with Hill Numbers — cpp_knn_hill_parallel","text":"List curves q value","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_hill_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Single kNN Accumulation with Hill Numbers — cpp_knn_hill_single","title":"Single kNN Accumulation with Hill Numbers — cpp_knn_hill_single","text":"Single kNN Accumulation Hill Numbers","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_hill_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single kNN Accumulation with Hill Numbers — cpp_knn_hill_single","text":"","code":"cpp_knn_hill_single(species_mat, dist_mat, seed, q_values)"},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_hill_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single kNN Accumulation with Hill Numbers — cpp_knn_hill_single","text":"species_mat Integer matrix (sites x species) abundances dist_mat Numeric matrix pairwise distances seed Starting site index (0-based) q_values Vector Hill number orders compute","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_hill_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single kNN Accumulation with Hill Numbers — cpp_knn_hill_single","text":"Numeric matrix (length(q) x n_sites) Hill numbers","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_metrics_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel kNN Metrics Accumulation — cpp_knn_metrics_parallel","title":"Parallel kNN Metrics Accumulation — cpp_knn_metrics_parallel","text":"Run kNN accumulation site starting point. Returns one curve per site extracting per-site metrics.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_metrics_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel kNN Metrics Accumulation — cpp_knn_metrics_parallel","text":"","code":"cpp_knn_metrics_parallel(species_pa, dist_mat, n_cores = 1L, progress = FALSE)"},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_metrics_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel kNN Metrics Accumulation — cpp_knn_metrics_parallel","text":"species_pa Integer matrix (sites x species) dist_mat Numeric matrix pairwise distances n_cores Number cores use progress Show progress (currently ignored C++)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_metrics_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel kNN Metrics Accumulation — cpp_knn_metrics_parallel","text":"Integer matrix (n_sites x n_sites) accumulation curves","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel kNN Accumulation — cpp_knn_parallel","title":"Parallel kNN Accumulation — cpp_knn_parallel","text":"Run kNN accumulation multiple random starting points parallel.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel kNN Accumulation — cpp_knn_parallel","text":"","code":"cpp_knn_parallel(species_pa, dist_mat, n_seeds, n_cores = 1L, progress = FALSE)"},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel kNN Accumulation — cpp_knn_parallel","text":"species_pa Integer matrix (sites x species) dist_mat Numeric matrix pairwise distances n_seeds Number random starting points n_cores Number cores use progress Show progress (currently ignored C++)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel kNN Accumulation — cpp_knn_parallel","text":"Integer matrix (n_seeds x n_sites) accumulation curves","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_parallel_seeds.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel kNN Accumulation with Explicit Seeds — cpp_knn_parallel_seeds","title":"Parallel kNN Accumulation with Explicit Seeds — cpp_knn_parallel_seeds","text":"Run kNN accumulation specified starting points parallel.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_parallel_seeds.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel kNN Accumulation with Explicit Seeds — cpp_knn_parallel_seeds","text":"","code":"cpp_knn_parallel_seeds(   species_pa,   dist_mat,   seeds,   n_cores = 1L,   progress = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_parallel_seeds.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel kNN Accumulation with Explicit Seeds — cpp_knn_parallel_seeds","text":"species_pa Integer matrix (sites x species) dist_mat Numeric matrix pairwise distances seeds Integer vector starting point indices (0-based) n_cores Number cores use progress Show progress (currently ignored C++)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_parallel_seeds.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel kNN Accumulation with Explicit Seeds — cpp_knn_parallel_seeds","text":"Integer matrix (n_seeds x n_sites) accumulation curves","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Single kNN Accumulation Curve — cpp_knn_single","title":"Single kNN Accumulation Curve — cpp_knn_single","text":"Traverse sites nearest-neighbor order starting seed, accumulating species counts.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single kNN Accumulation Curve — cpp_knn_single","text":"","code":"cpp_knn_single(species_pa, dist_mat, seed)"},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single kNN Accumulation Curve — cpp_knn_single","text":"species_pa Integer matrix (sites x species), presence/absence dist_mat Numeric matrix pairwise distances seed Starting site index (0-based)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_knn_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single kNN Accumulation Curve — cpp_knn_single","text":"Integer vector cumulative species counts","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_phylo_knn_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel Phylogenetic Diversity Accumulation — cpp_phylo_knn_parallel","title":"Parallel Phylogenetic Diversity Accumulation — cpp_phylo_knn_parallel","text":"Parallel Phylogenetic Diversity Accumulation","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_phylo_knn_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel Phylogenetic Diversity Accumulation — cpp_phylo_knn_parallel","text":"","code":"cpp_phylo_knn_parallel(   species_pa,   site_dist_mat,   phylo_dist_mat,   n_seeds,   metrics,   n_cores = 1L,   progress = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/cpp_phylo_knn_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel Phylogenetic Diversity Accumulation — cpp_phylo_knn_parallel","text":"species_pa Integer matrix (sites x species) site_dist_mat Site distance matrix phylo_dist_mat Phylogenetic distance matrix n_seeds Number starting points metrics Metrics compute n_cores Number cores progress Show progress","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_phylo_knn_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel Phylogenetic Diversity Accumulation — cpp_phylo_knn_parallel","text":"List matrices metric","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_phylo_knn_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Single kNN Phylogenetic Diversity Accumulation — cpp_phylo_knn_single","title":"Single kNN Phylogenetic Diversity Accumulation — cpp_phylo_knn_single","text":"Single kNN Phylogenetic Diversity Accumulation","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_phylo_knn_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single kNN Phylogenetic Diversity Accumulation — cpp_phylo_knn_single","text":"","code":"cpp_phylo_knn_single(species_pa, site_dist_mat, phylo_dist_mat, seed, metrics)"},{"path":"https://gillescolling.com/spacc/reference/cpp_phylo_knn_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single kNN Phylogenetic Diversity Accumulation — cpp_phylo_knn_single","text":"species_pa Integer matrix (sites x species) site_dist_mat Site distance matrix phylo_dist_mat Phylogenetic/functional distance matrix (species x species) seed Starting site metrics Character vector metrics: \"mpd\", \"mntd\"","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_phylo_knn_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single kNN Phylogenetic Diversity Accumulation — cpp_phylo_knn_single","text":"List accumulation curves metric","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_radius_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel Radius-Order Accumulation — cpp_radius_parallel","title":"Parallel Radius-Order Accumulation — cpp_radius_parallel","text":"Parallel Radius-Order Accumulation","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_radius_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel Radius-Order Accumulation — cpp_radius_parallel","text":"","code":"cpp_radius_parallel(   species_pa,   dist_mat,   n_seeds,   n_cores = 1L,   progress = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/cpp_radius_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel Radius-Order Accumulation — cpp_radius_parallel","text":"species_pa Integer matrix (sites x species) dist_mat Numeric matrix pairwise distances n_seeds Number random starting points n_cores Number cores progress Show progress","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_radius_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel Radius-Order Accumulation — cpp_radius_parallel","text":"Integer matrix accumulation curves","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_radius_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Single Radius-Order Accumulation — cpp_radius_single","title":"Single Radius-Order Accumulation — cpp_radius_single","text":"Accumulate sites order distance seed (simpler version).","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_radius_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single Radius-Order Accumulation — cpp_radius_single","text":"","code":"cpp_radius_single(species_pa, dist_mat, seed)"},{"path":"https://gillescolling.com/spacc/reference/cpp_radius_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single Radius-Order Accumulation — cpp_radius_single","text":"species_pa Integer matrix (sites x species) dist_mat Numeric matrix pairwise distances seed Starting site index (0-based)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_radius_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single Radius-Order Accumulation — cpp_radius_single","text":"Integer vector cumulative species counts","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_random_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel Random Accumulation — cpp_random_parallel","title":"Parallel Random Accumulation — cpp_random_parallel","text":"Run random-order accumulation multiple times (null model).","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_random_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel Random Accumulation — cpp_random_parallel","text":"","code":"cpp_random_parallel(species_pa, n_seeds, n_cores = 1L, progress = FALSE)"},{"path":"https://gillescolling.com/spacc/reference/cpp_random_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel Random Accumulation — cpp_random_parallel","text":"species_pa Integer matrix (sites x species) n_seeds Number random permutations n_cores Number cores use progress Show progress (currently ignored)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_random_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel Random Accumulation — cpp_random_parallel","text":"Integer matrix (n_seeds x n_sites) accumulation curves","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_random_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Single Random Accumulation Curve — cpp_random_single","title":"Single Random Accumulation Curve — cpp_random_single","text":"Visit sites random order (null model comparison).","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_random_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single Random Accumulation Curve — cpp_random_single","text":"","code":"cpp_random_single(species_pa, order)"},{"path":"https://gillescolling.com/spacc/reference/cpp_random_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single Random Accumulation Curve — cpp_random_single","text":"species_pa Integer matrix (sites x species), presence/absence order Integer vector giving order visit sites (0-based)","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_random_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single Random Accumulation Curve — cpp_random_single","text":"Integer vector cumulative species counts","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_wavefront_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel Wavefront Accumulation — cpp_wavefront_parallel","title":"Parallel Wavefront Accumulation — cpp_wavefront_parallel","text":"Parallel Wavefront Accumulation","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_wavefront_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel Wavefront Accumulation — cpp_wavefront_parallel","text":"","code":"cpp_wavefront_parallel(   species_pa,   dist_mat,   n_seeds,   r0,   dr,   n_steps,   n_cores = 1L,   progress = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/cpp_wavefront_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel Wavefront Accumulation — cpp_wavefront_parallel","text":"species_pa Integer matrix (sites x species) dist_mat Distance matrix n_seeds Number random starting points r0 Initial radius dr Radius increment per step n_steps Number expansion steps n_cores Number cores progress Show progress","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_wavefront_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel Wavefront Accumulation — cpp_wavefront_parallel","text":"List curves matrix radius vector","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_wavefront_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Single Wavefront Accumulation — cpp_wavefront_single","title":"Single Wavefront Accumulation — cpp_wavefront_single","text":"Accumulate sites within expanding radius: r = r0 + step * dr Models invasion spread introduction point.","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_wavefront_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single Wavefront Accumulation — cpp_wavefront_single","text":"","code":"cpp_wavefront_single(species_pa, dist_mat, seed, r0, dr, n_steps)"},{"path":"https://gillescolling.com/spacc/reference/cpp_wavefront_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single Wavefront Accumulation — cpp_wavefront_single","text":"species_pa Integer matrix (sites x species) dist_mat Numeric matrix pairwise distances seed Starting site index (0-based) r0 Initial radius dr Radius increment per step n_steps Number expansion steps","code":""},{"path":"https://gillescolling.com/spacc/reference/cpp_wavefront_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single Wavefront Accumulation — cpp_wavefront_single","text":"List : species (counts), radius (values), n_sites (included)","code":""},{"path":"https://gillescolling.com/spacc/reference/dar.html","id":null,"dir":"Reference","previous_headings":"","what":"Diversity-Area Relationship (DAR) — dar","title":"Diversity-Area Relationship (DAR) — dar","text":"Extend classic species-area relationship (SAR) diversity-area relationship using Hill numbers order q. Instead plotting species richness vs. sites, plots effective diversity vs. cumulative area.","code":""},{"path":"https://gillescolling.com/spacc/reference/dar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Diversity-Area Relationship (DAR) — dar","text":"","code":"dar(   x,   coords,   q = c(0, 1, 2),   n_seeds = 50L,   method = \"knn\",   area_method = c(\"convex_hull\", \"voronoi\", \"count\"),   distance = c(\"euclidean\", \"haversine\"),   parallel = TRUE,   n_cores = NULL,   progress = TRUE,   seed = NULL )"},{"path":"https://gillescolling.com/spacc/reference/dar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Diversity-Area Relationship (DAR) — dar","text":"x site--species matrix (abundance data recommended). coords data.frame columns x y, spacc_dist object. q Numeric vector. Diversity orders. Default c(0, 1, 2). n_seeds Integer. Number random starting points. Default 50. method Character. Accumulation method. Default \"knn\". area_method Character. estimate cumulative area: \"voronoi\" (Voronoi tessellation, requires sf), \"convex_hull\" (convex hull accumulated sites, requires sf), \"count\" (use site count proxy, dependencies). Default \"convex_hull\". distance Character. Distance method. Default \"euclidean\". parallel Logical. Use parallel processing? Default TRUE. n_cores Integer. Number cores. progress Logical. Show progress? Default TRUE. seed Integer. Random seed.","code":""},{"path":"https://gillescolling.com/spacc/reference/dar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Diversity-Area Relationship (DAR) — dar","text":"object class spacc_dar containing: hill spacc_hill object diversity curves area Matrix cumulative areas (n_seeds x n_sites) q Diversity orders used area_method Method used area estimation","code":""},{"path":"https://gillescolling.com/spacc/reference/dar.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Diversity-Area Relationship (DAR) — dar","text":"DAR (Ma, 2018) generalizes SAR replacing species richness (q=0) Hill numbers order. reveals different facets diversity scale area: q=0 (richness) recovers classic SAR q=1 (Shannon) shows common species diversity scales q=2 (Simpson) shows dominant species diversity scales","code":""},{"path":"https://gillescolling.com/spacc/reference/dar.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Diversity-Area Relationship (DAR) — dar","text":"Ma, Z.S. (2018). DAR (diversity-area relationship): extending classic SAR biodiversity biogeography analyses. Ecology Evolution, 8, 10023-10038. Arrhenius, O. (1921). Species area. Journal Ecology, 9, 95-99.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/dar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Diversity-Area Relationship (DAR) — dar","text":"","code":"if (FALSE) { # \\dontrun{ coords <- data.frame(x = runif(50), y = runif(50)) species <- matrix(rpois(50 * 30, 2), nrow = 50)  dar <- dar(species, coords, q = c(0, 1, 2)) plot(dar) } # }"},{"path":"https://gillescolling.com/spacc/reference/distanceDecay.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance-Decay Analysis — distanceDecay","title":"Distance-Decay Analysis — distanceDecay","text":"Analyze species richness changes distance focal points.","code":""},{"path":"https://gillescolling.com/spacc/reference/distanceDecay.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance-Decay Analysis — distanceDecay","text":"","code":"distanceDecay(   x,   coords,   n_seeds = 50L,   breaks = NULL,   distance = c(\"euclidean\", \"haversine\"),   progress = TRUE,   seed = NULL )"},{"path":"https://gillescolling.com/spacc/reference/distanceDecay.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance-Decay Analysis — distanceDecay","text":"x site--species matrix. coords data.frame x y columns. n_seeds Integer. Number focal points. breaks Numeric vector. Distance thresholds. Default auto-calculated. distance Character. Distance method. progress Logical. Show progress? seed Integer. Random seed.","code":""},{"path":"https://gillescolling.com/spacc/reference/distanceDecay.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distance-Decay Analysis — distanceDecay","text":"object class spacc_decay distance-species relationships.","code":""},{"path":"https://gillescolling.com/spacc/reference/distanceDecay.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Distance-Decay Analysis — distanceDecay","text":"Nekola, J.C. & White, P.S. (1999). distance decay similarity biogeography ecology. Journal Biogeography, 26, 867-878. Soininen, J., McDonald, R. & Hillebrand, H. (2007). distance decay similarity ecological communities. Ecography, 30, 3-12.","code":""},{"path":"https://gillescolling.com/spacc/reference/distances.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Distance Matrix — distances","title":"Compute Distance Matrix — distances","text":"Pre-compute pairwise distances sites reuse across multiple spacc() calls. Supports sf objects accurate geodesic distances global-scale studies.","code":""},{"path":"https://gillescolling.com/spacc/reference/distances.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Distance Matrix — distances","text":"","code":"distances(x, method = NULL, fun = NULL, which = NULL)"},{"path":"https://gillescolling.com/spacc/reference/distances.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Distance Matrix — distances","text":"x Site locations. Can : data.frame columns x y sf object POINT geometries sfc_POINT object method Character. Distance method: \"euclidean\": Euclidean distance (projected coordinates) \"haversine\": Great-circle distance (lat/lon, fast approximation \"geodesic\": Accurate ellipsoidal distance via sf/S2 (global scale) Default auto-detected CRS using sf objects. fun Optional custom distance function. Must take two coordinate vectors (x, y) return distance matrix. Overrides method. sf objects, column name containing geometry. Default uses active geometry.","code":""},{"path":"https://gillescolling.com/spacc/reference/distances.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Distance Matrix — distances","text":"object class spacc_dist containing distance matrix coordinates stored attribute.","code":""},{"path":"https://gillescolling.com/spacc/reference/distances.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Distance Matrix — distances","text":"continental global-scale studies, use sf objects geographic CRS (e.g., EPSG:4326). function automatically use accurate geodesic distances via S2 spherical geometry library. smaller study areas projected coordinates (UTM, etc.), Euclidean distance appropriate faster.","code":""},{"path":"https://gillescolling.com/spacc/reference/distances.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Distance Matrix — distances","text":"","code":"if (FALSE) { # \\dontrun{ # Data frame with coordinates d <- distances(coords, method = \"haversine\")  # sf object - auto-detects appropriate method library(sf) pts_sf <- st_as_sf(coords, coords = c(\"lon\", \"lat\"), crs = 4326) d <- distances(pts_sf)  # uses geodesic automatically  # Force geodesic for maximum accuracy d <- distances(pts_sf, method = \"geodesic\")  # Reuse for multiple analyses sac_native <- spacc(native_species, d) sac_alien <- spacc(alien_species, d) } # }"},{"path":"https://gillescolling.com/spacc/reference/diversityPartition.html","id":null,"dir":"Reference","previous_headings":"","what":"Alpha-Beta-Gamma Diversity Partitioning — diversityPartition","title":"Alpha-Beta-Gamma Diversity Partitioning — diversityPartition","text":"Decompose regional (gamma) diversity local (alpha) turnover (beta) components using multiplicative partitioning Hill numbers.","code":""},{"path":"https://gillescolling.com/spacc/reference/diversityPartition.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Alpha-Beta-Gamma Diversity Partitioning — diversityPartition","text":"","code":"diversityPartition(x, q = c(0, 1, 2), weights = \"equal\", coords = NULL)"},{"path":"https://gillescolling.com/spacc/reference/diversityPartition.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Alpha-Beta-Gamma Diversity Partitioning — diversityPartition","text":"x site--species matrix (abundance data). q Numeric vector. Orders diversity. Default c(0, 1, 2). weights Character numeric. Site weights alpha calculation: \"equal\": Equal weights (default) \"proportional\": Weights proportional site abundance Numeric vector custom weights coords Optional data.frame columns x y spatial mapping. provided, enables as_sf() plot(type = \"map\").","code":""},{"path":"https://gillescolling.com/spacc/reference/diversityPartition.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Alpha-Beta-Gamma Diversity Partitioning — diversityPartition","text":"object class spacc_partition containing: alpha Mean alpha diversity (effective number species per site) beta Beta diversity (effective number communities) gamma Gamma diversity (regional species pool) q Orders diversity n_sites Number sites n_species Total species count","code":""},{"path":"https://gillescolling.com/spacc/reference/diversityPartition.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Alpha-Beta-Gamma Diversity Partitioning — diversityPartition","text":"function implements Jost (2007) multiplicative partitioning: $$\\gamma = \\alpha \\times \\beta$$ : Alpha: Mean effective number species per site Beta: Effective number distinct communities (1 = identical, n_sites = completely different) Gamma: Total effective number species region Beta diversity interpreted effective number communities: Beta = 1: sites identical composition Beta = n_sites: Sites share species","code":""},{"path":"https://gillescolling.com/spacc/reference/diversityPartition.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Alpha-Beta-Gamma Diversity Partitioning — diversityPartition","text":"Jost, L. (2007). Partitioning diversity independent alpha beta components. Ecology, 88, 2427-2439. Chao, ., Chiu, C.H. & Jost, L. (2014). Unifying species diversity, phylogenetic diversity, functional diversity, related similarity differentiation measures Hill numbers. Annual Review Ecology, Evolution, Systematics, 45, 297-324.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/diversityPartition.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Alpha-Beta-Gamma Diversity Partitioning — diversityPartition","text":"","code":"# Simulated community data species <- matrix(rpois(50 * 30, 2), nrow = 50)  # Partition diversity part <- diversityPartition(species, q = c(0, 1, 2)) print(part)  # Beta near 1 = homogeneous region # Beta near n_sites = heterogeneous region"},{"path":"https://gillescolling.com/spacc/reference/extrapolate.html","id":null,"dir":"Reference","previous_headings":"","what":"Extrapolate Total Species Richness — extrapolate","title":"Extrapolate Total Species Richness — extrapolate","text":"Fit asymptotic model estimate total species richness beyond observed sampling effort.","code":""},{"path":"https://gillescolling.com/spacc/reference/extrapolate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extrapolate Total Species Richness — extrapolate","text":"","code":"extrapolate(   object,   model = c(\"michaelis-menten\", \"lomolino\", \"asymptotic\", \"weibull\", \"logistic\", \"evt\"),   ... )"},{"path":"https://gillescolling.com/spacc/reference/extrapolate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extrapolate Total Species Richness — extrapolate","text":"object spacc object. model Character. Model fit: \"michaelis-menten\" (default), \"lomolino\", \"asymptotic\", \"weibull\", \"logistic\", \"evt\" (Extreme Value Theory, Borda-de-Agua et al. 2025). ... Additional arguments passed stats::nls().","code":""},{"path":"https://gillescolling.com/spacc/reference/extrapolate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extrapolate Total Species Richness — extrapolate","text":"object class spacc_fit containing: asymptote Estimated total species richness asymptote_ci Confidence interval asymptote model Model name fit nls fit object aic AIC model","code":""},{"path":"https://gillescolling.com/spacc/reference/extrapolate.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Extrapolate Total Species Richness — extrapolate","text":"Lomolino, M.V. (2000). Ecology's general, yet protean pattern: species-area relationship. Journal Biogeography, 27, 17-26. Flather, C.H. (1996). Fitting species-accumulation functions assessing regional land use impacts avian diversity. Journal Biogeography, 23, 155-168. Borda-de-Agua, L., Whittaker, R.J., Cardoso, P., et al. (2025). Extreme value theory explains topography scaling species-area relationship. Nature Communications, 16, 5346.","code":""},{"path":"https://gillescolling.com/spacc/reference/extrapolate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extrapolate Total Species Richness — extrapolate","text":"","code":"if (FALSE) { # \\dontrun{ sac <- spacc(species, coords) fit <- extrapolate(sac, model = \"lomolino\")  print(fit) plot(fit) predict(fit, n = c(100, 500, 1000)) } # }"},{"path":"https://gillescolling.com/spacc/reference/extrapolateCoverage.html","id":null,"dir":"Reference","previous_headings":"","what":"Extrapolate Richness Beyond Observed Coverage — extrapolateCoverage","title":"Extrapolate Richness Beyond Observed Coverage — extrapolateCoverage","text":"Predict species richness coverage levels beyond empirical maximum, following Chao et al. (2014) framework. Provides seamless interpolation extrapolation function sample coverage.","code":""},{"path":"https://gillescolling.com/spacc/reference/extrapolateCoverage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extrapolate Richness Beyond Observed Coverage — extrapolateCoverage","text":"","code":"extrapolateCoverage(x, target_coverage = c(0.9, 0.95, 0.99), q = 0)"},{"path":"https://gillescolling.com/spacc/reference/extrapolateCoverage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extrapolate Richness Beyond Observed Coverage — extrapolateCoverage","text":"x spacc_coverage object spaccCoverage(). target_coverage Numeric vector target coverage levels (0 1). Can exceed observed coverage extrapolation. Default c(0.90, 0.95, 0.99). q Numeric. Diversity order extrapolation: 0 (richness, default), 1 (Shannon), 2 (Simpson).","code":""},{"path":"https://gillescolling.com/spacc/reference/extrapolateCoverage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extrapolate Richness Beyond Observed Coverage — extrapolateCoverage","text":"object class spacc_coverage_ext containing: richness Matrix interpolated/extrapolated richness (n_seeds x n_targets) target_coverage Target coverage levels q Diversity order used observed_coverage Mean observed final coverage observed_richness Mean observed final richness","code":""},{"path":"https://gillescolling.com/spacc/reference/extrapolateCoverage.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extrapolate Richness Beyond Observed Coverage — extrapolateCoverage","text":"targets within observed coverage, linear interpolation used. targets beyond observed coverage, asymptotic estimators applied: q = 0: Chao1 estimator: S_est = S_obs + f1^2 / (2 * f2), f1/f2 singleton/doubleton counts. Extrapolation via coverage deficit. q = 1: Shannon extrapolation based Good-Turing frequency formula. q = 2: Simpson extrapolation using unbiased estimator.","code":""},{"path":"https://gillescolling.com/spacc/reference/extrapolateCoverage.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Extrapolate Richness Beyond Observed Coverage — extrapolateCoverage","text":"Chao, . & Jost, L. (2012). Coverage-based rarefaction extrapolation: standardizing samples completeness rather size. Ecology, 93, 2533-2547. Chao, ., Gotelli, N.J., Hsieh, T.C., et al. (2014). Rarefaction extrapolation Hill numbers: framework sampling estimation species diversity studies. Ecological Monographs, 84, 45-67.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/extrapolateCoverage.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extrapolate Richness Beyond Observed Coverage — extrapolateCoverage","text":"","code":"if (FALSE) { # \\dontrun{ cov <- spaccCoverage(species, coords) ext <- extrapolateCoverage(cov, target_coverage = c(0.95, 0.99, 1.0)) print(ext) plot(ext) } # }"},{"path":"https://gillescolling.com/spacc/reference/gammaDiversity.html","id":null,"dir":"Reference","previous_headings":"","what":"Gamma Diversity (Regional) — gammaDiversity","title":"Gamma Diversity (Regional) — gammaDiversity","text":"Compute Hill numbers pooled community across sites.","code":""},{"path":"https://gillescolling.com/spacc/reference/gammaDiversity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gamma Diversity (Regional) — gammaDiversity","text":"","code":"gammaDiversity(x, q = c(0, 1, 2))"},{"path":"https://gillescolling.com/spacc/reference/gammaDiversity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gamma Diversity (Regional) — gammaDiversity","text":"x site--species matrix (abundance data). q Numeric vector. Orders diversity. Default c(0, 1, 2).","code":""},{"path":"https://gillescolling.com/spacc/reference/gammaDiversity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gamma Diversity (Regional) — gammaDiversity","text":"named numeric vector gamma diversity q.","code":""},{"path":"https://gillescolling.com/spacc/reference/gammaDiversity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Gamma Diversity (Regional) — gammaDiversity","text":"Gamma diversity represents regional (total) diversity across sites. computed pooling abundances across sites calculating Hill numbers combined community.","code":""},{"path":"https://gillescolling.com/spacc/reference/gammaDiversity.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Gamma Diversity (Regional) — gammaDiversity","text":"Jost, L. (2007). Partitioning diversity independent alpha beta components. Ecology, 88, 2427-2439.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/gammaDiversity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gamma Diversity (Regional) — gammaDiversity","text":"","code":"species <- matrix(rpois(50 * 30, 2), nrow = 50) gammaDiversity(species, q = c(0, 1, 2))"},{"path":"https://gillescolling.com/spacc/reference/interpolateCoverage.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolate Richness at Target Coverage Levels — interpolateCoverage","title":"Interpolate Richness at Target Coverage Levels — interpolateCoverage","text":"Estimate species richness specified coverage levels interpolation.","code":""},{"path":"https://gillescolling.com/spacc/reference/interpolateCoverage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolate Richness at Target Coverage Levels — interpolateCoverage","text":"","code":"interpolateCoverage(x, target = c(0.9, 0.95, 0.99))"},{"path":"https://gillescolling.com/spacc/reference/interpolateCoverage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolate Richness at Target Coverage Levels — interpolateCoverage","text":"x spacc_coverage object. target Numeric vector target coverage levels (0 1). Default c(0.90, 0.95, 0.99).","code":""},{"path":"https://gillescolling.com/spacc/reference/interpolateCoverage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interpolate Richness at Target Coverage Levels — interpolateCoverage","text":"data.frame columns target coverage level, showing interpolated richness seed.","code":""},{"path":"https://gillescolling.com/spacc/reference/interpolateCoverage.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Interpolate Richness at Target Coverage Levels — interpolateCoverage","text":"Chao, . & Jost, L. (2012). Coverage-based rarefaction extrapolation: standardizing samples completeness rather size. Ecology, 93, 2533-2547.","code":""},{"path":"https://gillescolling.com/spacc/reference/interpolate_at_coverage.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolate Richness at Target Coverage Levels — interpolate_at_coverage","title":"Interpolate Richness at Target Coverage Levels — interpolate_at_coverage","text":"Interpolate Richness Target Coverage Levels","code":""},{"path":"https://gillescolling.com/spacc/reference/interpolate_at_coverage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolate Richness at Target Coverage Levels — interpolate_at_coverage","text":"","code":"interpolate_at_coverage(richness, coverage, targets)"},{"path":"https://gillescolling.com/spacc/reference/interpolate_at_coverage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolate Richness at Target Coverage Levels — interpolate_at_coverage","text":"richness Vector cumulative richness coverage Vector coverage values targets Target coverage levels interpolate","code":""},{"path":"https://gillescolling.com/spacc/reference/interpolate_at_coverage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interpolate Richness at Target Coverage Levels — interpolate_at_coverage","text":"Vector interpolated richness values","code":""},{"path":"https://gillescolling.com/spacc/reference/mao_tau.html","id":null,"dir":"Reference","previous_headings":"","what":"Exact (Mao Tau) Expected Accumulation — mao_tau","title":"Exact (Mao Tau) Expected Accumulation — mao_tau","text":"Compute expected species accumulation curve using sample-based rarefaction (Mao Tau estimator). analytically identical expected curve random permutations.","code":""},{"path":"https://gillescolling.com/spacc/reference/mao_tau.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Exact (Mao Tau) Expected Accumulation — mao_tau","text":"","code":"mao_tau(x)"},{"path":"https://gillescolling.com/spacc/reference/mao_tau.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Exact (Mao Tau) Expected Accumulation — mao_tau","text":"x site--species matrix (presence/absence abundance).","code":""},{"path":"https://gillescolling.com/spacc/reference/mao_tau.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Exact (Mao Tau) Expected Accumulation — mao_tau","text":"data.frame columns: sites, expected, sd, lower, upper","code":""},{"path":"https://gillescolling.com/spacc/reference/mao_tau.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Exact (Mao Tau) Expected Accumulation — mao_tau","text":"Colwell, R.K., Mao, C.X. & Chang, J. (2004). Interpolating, extrapolating, comparing incidence-based species accumulation curves. Ecology, 85, 2717-2727.","code":""},{"path":"https://gillescolling.com/spacc/reference/plot.spacc.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Spatial SAC — plot.spacc","title":"Plot Spatial SAC — plot.spacc","text":"Create ggplot2 visualization species accumulation curves. grouped spacc objects, curves overlaid different colors.","code":""},{"path":"https://gillescolling.com/spacc/reference/plot.spacc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Spatial SAC — plot.spacc","text":"","code":"# S3 method for class 'spacc' plot(   x,   ci = TRUE,   ci_level = 0.95,   ci_alpha = 0.3,   show_seeds = FALSE,   saturation = FALSE,   saturation_level = 0.9,   facet = FALSE,   ... )"},{"path":"https://gillescolling.com/spacc/reference/plot.spacc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Spatial SAC — plot.spacc","text":"x spacc summary.spacc object. ci Logical. Show confidence interval ribbon? Default TRUE. ci_level Numeric. Confidence level interval. Default 0.95. ci_alpha Numeric. Transparency CI ribbon. Default 0.3. show_seeds Logical. Show individual seed curves? Default FALSE. available ungrouped objects. saturation Logical. Mark saturation point? Default FALSE. available ungrouped objects. saturation_level Numeric. Proportion saturation. Default 0.9. facet Logical. Use faceted panels grouped objects? Default FALSE (overlay colors). Ignored ungrouped objects. ... Additional arguments (ignored).","code":""},{"path":"https://gillescolling.com/spacc/reference/plot.spacc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Spatial SAC — plot.spacc","text":"ggplot2 object.","code":""},{"path":"https://gillescolling.com/spacc/reference/plot.spacc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Spatial SAC — plot.spacc","text":"","code":"if (FALSE) { # \\dontrun{ sac <- spacc(species, coords) plot(sac)  # Grouped sac_grouped <- spacc(species, coords, groups = status) plot(sac_grouped) plot(sac_grouped, facet = TRUE) } # }"},{"path":"https://gillescolling.com/spacc/reference/plot.spacc_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot spacc_metrics — plot.spacc_metrics","title":"Plot spacc_metrics — plot.spacc_metrics","text":"Create visualizations per-site accumulation metrics.","code":""},{"path":"https://gillescolling.com/spacc/reference/plot.spacc_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot spacc_metrics — plot.spacc_metrics","text":"","code":"# S3 method for class 'spacc_metrics' plot(   x,   metric = NULL,   type = c(\"heatmap\", \"points\", \"histogram\"),   point_size = 3,   palette = \"viridis\",   ... )"},{"path":"https://gillescolling.com/spacc/reference/plot.spacc_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot spacc_metrics — plot.spacc_metrics","text":"x spacc_metrics object spaccMetrics(). metric Character. metric plot. Default first metric. type Character. Plot type: \"heatmap\" Spatial heatmap colored metric value \"points\" Simple point plot (heatmap clearer name) \"histogram\" Distribution metric values point_size Numeric. Size points heatmap. Default 3. palette Character. Color palette heatmap. Default \"viridis\". ... Additional arguments (unused).","code":""},{"path":"https://gillescolling.com/spacc/reference/plot.spacc_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot spacc_metrics — plot.spacc_metrics","text":"ggplot2 object.","code":""},{"path":"https://gillescolling.com/spacc/reference/plot.spacc_metrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot spacc_metrics — plot.spacc_metrics","text":"","code":"if (FALSE) { # \\dontrun{ metrics <- spaccMetrics(species, coords, metrics = c(\"slope_10\", \"auc\"))  # Heatmap of initial accumulation rate plot(metrics, metric = \"slope_10\", type = \"heatmap\")  # Distribution of AUC values plot(metrics, metric = \"auc\", type = \"histogram\") } # }"},{"path":"https://gillescolling.com/spacc/reference/rarefy.html","id":null,"dir":"Reference","previous_headings":"","what":"Individual-Based Rarefaction — rarefy","title":"Individual-Based Rarefaction — rarefy","text":"Compute classic individual-based rarefaction curves. complements sample-based accumulation spacc().","code":""},{"path":"https://gillescolling.com/spacc/reference/rarefy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Individual-Based Rarefaction — rarefy","text":"","code":"rarefy(x, n_individuals = NULL, n_boot = 100L)"},{"path":"https://gillescolling.com/spacc/reference/rarefy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Individual-Based Rarefaction — rarefy","text":"x site--species matrix abundance data (presence/absence). n_individuals Integer vector. Sample sizes compute expected richness . Default NULL computes levels 1 total. n_boot Integer. Number bootstrap replicates CI. Default 100.","code":""},{"path":"https://gillescolling.com/spacc/reference/rarefy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Individual-Based Rarefaction — rarefy","text":"object class spacc_rare containing: n Sample sizes expected Expected species richness sd Standard deviation lower, upper 95% confidence bounds","code":""},{"path":"https://gillescolling.com/spacc/reference/rarefy.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Individual-Based Rarefaction — rarefy","text":"Hurlbert, S.H. (1971). nonconcept species diversity: critique alternative parameters. Ecology, 52, 577-586. Gotelli, N.J. & Colwell, R.K. (2001). Quantifying biodiversity: procedures pitfalls measurement comparison species richness. Ecology Letters, 4, 379-391.","code":""},{"path":"https://gillescolling.com/spacc/reference/rarefy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Individual-Based Rarefaction — rarefy","text":"","code":"if (FALSE) { # \\dontrun{ # With abundance data rare <- rarefy(abundance_matrix) plot(rare) } # }"},{"path":"https://gillescolling.com/spacc/reference/sesars.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling Effort Species-Area Relationship (SESARS) — sesars","title":"Sampling Effort Species-Area Relationship (SESARS) — sesars","text":"Model joint effect sampling effort area species richness. Corrects unequal survey intensity across sites, common atlas data citizen science datasets.","code":""},{"path":"https://gillescolling.com/spacc/reference/sesars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling Effort Species-Area Relationship (SESARS) — sesars","text":"","code":"sesars(object, effort, model = c(\"power\", \"additive\"), ...)"},{"path":"https://gillescolling.com/spacc/reference/sesars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling Effort Species-Area Relationship (SESARS) — sesars","text":"object spacc object. effort Numeric vector. Sampling effort per site (e.g., hours, visits, trap-nights). Must length equal number sites. model Character. SESARS model: \"power\" (default): S = c * ^z * E^w (multiplicative power law) \"additive\": S = c + z * log() + w * log(E) ... Additional arguments passed stats::nls() stats::lm().","code":""},{"path":"https://gillescolling.com/spacc/reference/sesars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling Effort Species-Area Relationship (SESARS) — sesars","text":"object class spacc_sesars containing: model Model type fit Fitted model object coef Model coefficients data Data frame used fitting","code":""},{"path":"https://gillescolling.com/spacc/reference/sesars.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sampling Effort Species-Area Relationship (SESARS) — sesars","text":"Standard SARs assume complete sampling within area unit. SESARS incorporates sampling effort (E) alongside area () provide unbiased richness estimates across regions unequal survey intensity.","code":""},{"path":"https://gillescolling.com/spacc/reference/sesars.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sampling Effort Species-Area Relationship (SESARS) — sesars","text":"Dennstadt, F., Horak, J. & Martin, M.D. (2019). Predictive sampling effort species-area relationship models estimating richness fragmented landscapes. Diversity Distributions, 26, 1112-1123.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/sesars.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sampling Effort Species-Area Relationship (SESARS) — sesars","text":"","code":"if (FALSE) { # \\dontrun{ sac <- spacc(species, coords) effort <- rpois(nrow(species), 10)  # e.g., number of visits ses <- sesars(sac, effort, model = \"power\") print(ses) plot(ses) } # }"},{"path":"https://gillescolling.com/spacc/reference/sfar.html","id":null,"dir":"Reference","previous_headings":"","what":"Species-Fragmented Area Relationship (SFAR) — sfar","title":"Species-Fragmented Area Relationship (SFAR) — sfar","text":"Separate effects habitat loss (area reduction) fragmentation (splitting patches) species richness. Extends classic power-law SAR explicit fragmentation term.","code":""},{"path":"https://gillescolling.com/spacc/reference/sfar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Species-Fragmented Area Relationship (SFAR) — sfar","text":"","code":"sfar(object, patches, model = c(\"power\", \"log\"), ...)"},{"path":"https://gillescolling.com/spacc/reference/sfar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Species-Fragmented Area Relationship (SFAR) — sfar","text":"object spacc object. patches Factor integer vector assigning site habitat fragment (patch). Must length equal number sites. model Character. SFAR model: \"power\" (default): S = c * ^z * n^(-f) \"log\": log(S) = log(c) + zlog() - flog(n) ... Additional arguments.","code":""},{"path":"https://gillescolling.com/spacc/reference/sfar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Species-Fragmented Area Relationship (SFAR) — sfar","text":"object class spacc_sfar containing: fit Fitted model object coef Coefficients: c (intercept), z (area exponent), f (fragmentation exponent) n_patches Number habitat fragments","code":""},{"path":"https://gillescolling.com/spacc/reference/sfar.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Species-Fragmented Area Relationship (SFAR) — sfar","text":"SFAR (Hanski et al. 2013) extends power-law SAR quantify additional effect habitat fragmentation species richness. model S = c * ^z * n^(-f) adds penalty term fragmentation (n = number fragments), f > 0 indicates fragmentation reduces richness beyond area loss alone predict.","code":""},{"path":"https://gillescolling.com/spacc/reference/sfar.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Species-Fragmented Area Relationship (SFAR) — sfar","text":"Hanski, ., Zurita, G.., Bellocq, M.. & Rybicki, J. (2013). Species-fragmented area relationship. Proceedings National Academy Sciences, 110, 12715-12720. Rybicki, J. & Hanski, . (2013). Species-area relationships extinctions caused habitat loss fragmentation. Ecology Letters, 16, 27-38.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/sfar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Species-Fragmented Area Relationship (SFAR) — sfar","text":"","code":"if (FALSE) { # \\dontrun{ sac <- spacc(species, coords) patches <- kmeans(coords, centers = 5)$cluster sfar_result <- sfar(sac, patches) print(sfar_result) plot(sfar_result) } # }"},{"path":"https://gillescolling.com/spacc/reference/spacc-package.html","id":null,"dir":"Reference","previous_headings":"","what":"spacc: Fast Spatial Species Accumulation Curves — spacc-package","title":"spacc: Fast Spatial Species Accumulation Curves — spacc-package","text":"High-performance spatial species accumulation curves using nearest-neighbor algorithms. Implements kNN kNCN sampling methods C++ backend speed. Supports Hill numbers (q=0,1,2), beta diversity partitioning (turnover/nestedness), coverage-based rarefaction extrapolation, phylogenetic diversity including Faith's PD, functional diversity accumulation, diversity-area relationships (DAR), endemism-area curves, sampling-effort correction (SESARS), fragmentation analysis (SFAR), EVT-based SAR models. Multiple starting points (seeds) provide uncertainty quantification. Methods described Chao et al. (2014) doi:10.1890/13-0133.1 , Baselga (2010) doi:10.1111/j.1466-8238.2009.00490.x , Chao Jost (2012) doi:10.1890/11-1952.1 , Faith (1992) doi:10.1016/0006-3207(92)91201-3 , Ma (2018) doi:10.1002/ece3.4526 , Borda-de-Agua et al. (2025) doi:10.1038/s41467-025-59239-7 , Hanski et al. (2013) doi:10.1073/pnas.1311190110 , Jost (2007) doi:10.1890/06-1736.1 .","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/spacc-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"spacc: Fast Spatial Species Accumulation Curves — spacc-package","text":"Maintainer: Gilles Colling gilles.colling051@gmail.com (ORCID) [copyright holder]","code":""},{"path":"https://gillescolling.com/spacc/reference/spacc.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial Species Accumulation Curves — spacc","title":"Spatial Species Accumulation Curves — spacc","text":"Compute species accumulation curves using various spatial sampling methods C++ backend performance.","code":""},{"path":"https://gillescolling.com/spacc/reference/spacc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial Species Accumulation Curves — spacc","text":"","code":"spacc(   x,   coords,   n_seeds = 50L,   method = c(\"knn\", \"kncn\", \"random\", \"radius\", \"gaussian\", \"cone\", \"collector\"),   distance = c(\"euclidean\", \"haversine\"),   backend = c(\"auto\", \"exact\", \"kdtree\"),   support = NULL,   include_halo = TRUE,   sigma = NULL,   cone_width = pi/4,   parallel = TRUE,   n_cores = NULL,   progress = TRUE,   groups = NULL,   time = NULL,   w_space = 1,   w_time = 1,   seed = NULL )"},{"path":"https://gillescolling.com/spacc/reference/spacc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatial Species Accumulation Curves — spacc","text":"x site--species matrix (rows = sites, cols = species) presence/absence (0/1) abundance data. Can also data.frame. coords Site coordinates. Can : data.frame columns x y sf object point geometries (CRS preserved) spacc_dist object distances() n_seeds Integer. Number random starting points uncertainty quantification. Default 50. method Character. Accumulation method: \"knn\": k-Nearest Neighbor (always visit closest unvisited) \"kncn\": k-Nearest Centroid Neighbor (visit closest centroid) \"random\": Random order (null model) \"radius\": Expand distance seed \"gaussian\": Probabilistic selection weighted distance \"cone\": Directional expansion within angular constraint \"collector\": Sites data order (randomization, single curve) distance Character. Distance method: \"euclidean\" \"haversine\". backend Character. Nearest-neighbor backend knn kncn: \"auto\" (default): Uses exact (brute-force) ≤500 sites, spatial tree >500 sites. \"exact\": Always use brute-force precomputed distance matrix. \"kdtree\": Always use spatial tree. Uses k-d tree (nanoflann) Euclidean distances ball tree haversine distances. Faster large datasets, distance matrix needed. support Optional. Spatial support core/halo classification via areaOfEffect::aoe(). Can : \"auto\": Auto-detect countries run per-country accumulation, returning grouped spacc object one curve per country Country name ISO code: \"France\", \"FR\", \"FRA\" Vector countries: c(\"France\", \"Germany\") sf polygon object aoe_result object (pre-computed) provided, seeds sampled \"core\" sites (inside support), accumulation can expand \"halo\" sites (buffer zone). include_halo Logical. support provided, halo sites included accumulation? Default TRUE (ecological boundary). Set FALSE political/hard boundary. sigma Numeric. Bandwidth Gaussian method. Default auto-calculated. cone_width Numeric. Half-width radians cone method. Default pi/4. parallel Logical. Use parallel processing? Default TRUE. n_cores Integer. Number cores. Default NULL uses detectCores() - 1. progress Logical. Show progress bar? Default TRUE. groups Optional. factor, character, integer vector length ncol(x) assigning species (column) group. provided, separate accumulation curves computed group using spatial site ordering, grouped spacc object returned. Useful comparing native vs alien species, families, categorical split. Default NULL (grouping). time Optional. Numeric vector length nrow(x) giving temporal coordinate site. provided, combined spatiotemporal distance matrix computed w_space * d_spatial + w_time * d_temporal used accumulation. Forces exact (brute-force) backend since spatial trees handle composite distances. supported methods use distance matrix: \"knn\", \"radius\", \"gaussian\". w_space Numeric. Weight spatial distance time provided. Default 1. w_time Numeric. Weight temporal distance time provided. Default 1. seed Integer. Random seed reproducibility. Default NULL.","code":""},{"path":"https://gillescolling.com/spacc/reference/spacc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spatial Species Accumulation Curves — spacc","text":"groups = NULL, object class spacc containing: curves Matrix cumulative species counts (n_seeds x n_sites) coords Original coordinates n_seeds Number seeds used method Method used n_species Total species dataset","code":""},{"path":"https://gillescolling.com/spacc/reference/spacc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Spatial Species Accumulation Curves — spacc","text":"Arrhenius, O. (1921). Species area. Journal Ecology, 9, 95-99. Scheiner, S.M. (2003). Six types species-area curves. Global Ecology Biogeography, 12, 441-447. Chiarucci, ., Bacaro, G., Scheiner, S.M. (2011). Old new challenges using species diversity assessing biodiversity. Philosophical Transactions Royal Society B, 366, 2426-2437.","code":""},{"path":"https://gillescolling.com/spacc/reference/spacc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Spatial Species Accumulation Curves — spacc","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage sac <- spacc(species, coords) plot(sac)  # Different methods sac_knn <- spacc(species, coords, method = \"knn\") sac_gauss <- spacc(species, coords, method = \"gaussian\", sigma = 10) sac_cone <- spacc(species, coords, method = \"cone\", cone_width = pi/6)  # Compare to null model sac_rand <- spacc(species, coords, method = \"random\") comp <- compare(sac_knn, sac_rand)  # With spatial support (seeds from France, accumulate into neighbors) sac_france <- spacc(species, coords, support = \"France\")  # Hard boundary (France only, no halo) sac_france_only <- spacc(species, coords, support = \"France\", include_halo = FALSE)  # Grouped accumulation (e.g., native vs alien) status <- ifelse(grepl(\"alien\", colnames(species)), \"alien\", \"native\") sac_grouped <- spacc(species, coords, groups = status, seed = 42) plot(sac_grouped)  # Overlaid curves per group } # }"},{"path":"https://gillescolling.com/spacc/reference/spaccBeta.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial Beta Diversity Accumulation — spaccBeta","title":"Spatial Beta Diversity Accumulation — spaccBeta","text":"Analyze beta diversity changes sites accumulated spatially. Partitions beta diversity turnover (species replacement) nestedness (species loss) components following Baselga (2010).","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccBeta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial Beta Diversity Accumulation — spaccBeta","text":"","code":"spaccBeta(   x,   coords,   n_seeds = 50L,   method = \"knn\",   index = c(\"sorensen\", \"jaccard\"),   distance = c(\"euclidean\", \"haversine\"),   parallel = TRUE,   n_cores = NULL,   progress = TRUE,   seed = NULL,   map = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/spaccBeta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatial Beta Diversity Accumulation — spaccBeta","text":"x site--species matrix (presence/absence abundance). coords data.frame columns x y, spacc_dist object. n_seeds Integer. Number random starting points. Default 50. method Character. Accumulation method. Default \"knn\". index Character. Dissimilarity index: \"sorensen\" (default) \"jaccard\". distance Character. Distance method: \"euclidean\" \"haversine\". parallel Logical. Use parallel processing? Default TRUE. n_cores Integer. Number cores. progress Logical. Show progress? Default TRUE. seed Integer. Random seed. map Logical. TRUE, run accumulation every site seed store per-site final beta values spatial mapping. Enables as_sf() plot(type = \"map\"). Default FALSE.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccBeta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spatial Beta Diversity Accumulation — spaccBeta","text":"object class spacc_beta containing: beta_total Matrix total beta diversity (n_seeds x n_sites-1) beta_turnover Matrix turnover component beta_nestedness Matrix nestedness component distance Matrix cumulative distances n_seeds, n_sites, method, index Parameters used","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccBeta.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Spatial Beta Diversity Accumulation — spaccBeta","text":"step spatial accumulation, beta diversity calculated accumulated species pool newly added site. reveals species composition changes expand spatially. Interpretation: High turnover: New sites contribute different species (replacement) High nestedness: New sites contribute subsets existing species (loss) sum turnover nestedness equals total beta diversity.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccBeta.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Spatial Beta Diversity Accumulation — spaccBeta","text":"Baselga, . (2010). Partitioning turnover nestedness components beta diversity. Global Ecology Biogeography, 19, 134-143.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/spaccBeta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Spatial Beta Diversity Accumulation — spaccBeta","text":"","code":"if (FALSE) { # \\dontrun{ coords <- data.frame(x = runif(50), y = runif(50)) species <- matrix(rbinom(50 * 30, 1, 0.3), nrow = 50)  beta <- spaccBeta(species, coords, n_seeds = 30) plot(beta)  # Compare Sorensen vs Jaccard beta_jac <- spaccBeta(species, coords, index = \"jaccard\") } # }"},{"path":"https://gillescolling.com/spacc/reference/spaccBetaFunc.html","id":null,"dir":"Reference","previous_headings":"","what":"Functional Beta Diversity Accumulation — spaccBetaFunc","title":"Functional Beta Diversity Accumulation — spaccBetaFunc","text":"Compute spatial accumulation functional beta diversity, partitioned turnover nestedness components. Measures functional trait space composition changes sites accumulated spatially.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccBetaFunc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functional Beta Diversity Accumulation — spaccBetaFunc","text":"","code":"spaccBetaFunc(   x,   coords,   traits,   n_seeds = 50L,   method = \"knn\",   index = c(\"sorensen\", \"jaccard\"),   distance = c(\"euclidean\", \"haversine\"),   parallel = TRUE,   n_cores = NULL,   progress = TRUE,   seed = NULL )"},{"path":"https://gillescolling.com/spacc/reference/spaccBetaFunc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functional Beta Diversity Accumulation — spaccBetaFunc","text":"x site--species matrix (presence/absence abundance). coords data.frame columns x y, spacc_dist object. traits species--traits matrix. Row names match species. n_seeds Integer. Number random starting points. Default 50. method Character. Accumulation method. Default \"knn\". index Character. Dissimilarity index: \"sorensen\" (default) \"jaccard\". distance Character. Distance method. Default \"euclidean\". parallel Logical. Use parallel processing? Default TRUE. n_cores Integer. Number cores. progress Logical. Show progress? Default TRUE. seed Integer. Random seed.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccBetaFunc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functional Beta Diversity Accumulation — spaccBetaFunc","text":"object class spacc_beta additional attribute beta_type = \"functional\".","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccBetaFunc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functional Beta Diversity Accumulation — spaccBetaFunc","text":"Functional beta diversity quantifies turnover functional traits across space. accumulation step, beta computed based overlap trait ranges (functional space) accumulated pool newly added site.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccBetaFunc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Functional Beta Diversity Accumulation — spaccBetaFunc","text":"Baselga, . (2012). relationship species replacement, dissimilarity derived nestedness, nestedness. Global Ecology Biogeography, 21, 1223-1232. Cardoso, P., Rigal, F. & Carvalho, J.C. (2015). BAT – Biodiversity Assessment Tools. Methods Ecology Evolution, 6, 232-236.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/spaccBetaFunc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functional Beta Diversity Accumulation — spaccBetaFunc","text":"","code":"if (FALSE) { # \\dontrun{ coords <- data.frame(x = runif(50), y = runif(50)) species <- matrix(rbinom(50 * 20, 1, 0.3), nrow = 50) traits <- matrix(rnorm(20 * 3), nrow = 20) rownames(traits) <- colnames(species) <- paste0(\"sp\", 1:20)  beta_func <- spaccBetaFunc(species, coords, traits) plot(beta_func) } # }"},{"path":"https://gillescolling.com/spacc/reference/spaccBetaPhylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Phylogenetic Beta Diversity Accumulation — spaccBetaPhylo","title":"Phylogenetic Beta Diversity Accumulation — spaccBetaPhylo","text":"Compute spatial accumulation phylogenetic beta diversity, partitioned turnover nestedness components. Measures evolutionary composition changes sites accumulated spatially.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccBetaPhylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phylogenetic Beta Diversity Accumulation — spaccBetaPhylo","text":"","code":"spaccBetaPhylo(   x,   coords,   tree,   n_seeds = 50L,   method = \"knn\",   index = c(\"sorensen\", \"jaccard\"),   distance = c(\"euclidean\", \"haversine\"),   parallel = TRUE,   n_cores = NULL,   progress = TRUE,   seed = NULL )"},{"path":"https://gillescolling.com/spacc/reference/spaccBetaPhylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Phylogenetic Beta Diversity Accumulation — spaccBetaPhylo","text":"x site--species matrix (presence/absence abundance). coords data.frame columns x y, spacc_dist object. tree phylogenetic tree class phylo (ape), pairwise phylogenetic distance matrix. n_seeds Integer. Number random starting points. Default 50. method Character. Accumulation method. Default \"knn\". index Character. Dissimilarity index: \"sorensen\" (default) \"jaccard\". distance Character. Distance method. Default \"euclidean\". parallel Logical. Use parallel processing? Default TRUE. n_cores Integer. Number cores. progress Logical. Show progress? Default TRUE. seed Integer. Random seed.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccBetaPhylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Phylogenetic Beta Diversity Accumulation — spaccBetaPhylo","text":"object class spacc_beta additional attribute beta_type = \"phylogenetic\".","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccBetaPhylo.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Phylogenetic Beta Diversity Accumulation — spaccBetaPhylo","text":"Phylogenetic beta diversity quantifies evolutionary turnover across space. PhyloSor index (phylogenetic Sorensen) used: fraction branch length shared two communities relative total branch length. Partitioned replacement (turnover) loss (nestedness) components.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccBetaPhylo.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Phylogenetic Beta Diversity Accumulation — spaccBetaPhylo","text":"Baselga, . (2010). Partitioning turnover nestedness components beta diversity. Global Ecology Biogeography, 19, 134-143. Chao, ., Chiu, C.H., Villeger, S., et al. (2023). Rarefaction extrapolation beta diversity framework Hill numbers: iNEXT.beta3D standardization. Ecological Monographs, 93, e1588.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/spaccBetaPhylo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Phylogenetic Beta Diversity Accumulation — spaccBetaPhylo","text":"","code":"if (FALSE) { # \\dontrun{ library(ape) tree <- rtree(20) coords <- data.frame(x = runif(50), y = runif(50)) species <- matrix(rbinom(50 * 20, 1, 0.3), nrow = 50) colnames(species) <- tree$tip.label  beta_phylo <- spaccBetaPhylo(species, coords, tree) plot(beta_phylo) } # }"},{"path":"https://gillescolling.com/spacc/reference/spaccCoverage.html","id":null,"dir":"Reference","previous_headings":"","what":"Coverage-Based Spatial Rarefaction — spaccCoverage","title":"Coverage-Based Spatial Rarefaction — spaccCoverage","text":"Compute spatial accumulation curves sample coverage tracking. Allows standardization completeness (coverage) rather sample size, following Chao & Jost (2012).","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccCoverage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coverage-Based Spatial Rarefaction — spaccCoverage","text":"","code":"spaccCoverage(   x,   coords,   n_seeds = 50L,   method = \"knn\",   distance = c(\"euclidean\", \"haversine\"),   parallel = TRUE,   n_cores = NULL,   progress = TRUE,   seed = NULL,   map = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/spaccCoverage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coverage-Based Spatial Rarefaction — spaccCoverage","text":"x site--species matrix abundance data. coords data.frame columns x y, spacc_dist object. n_seeds Integer. Number random starting points. Default 50. method Character. Accumulation method. Default \"knn\". distance Character. Distance method: \"euclidean\" \"haversine\". parallel Logical. Use parallel processing? Default TRUE. n_cores Integer. Number cores. progress Logical. Show progress? Default TRUE. seed Integer. Random seed. map Logical. TRUE, run accumulation every site seed store per-site final coverage richness spatial mapping. Enables as_sf() plot(type = \"map\"). Default FALSE.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccCoverage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coverage-Based Spatial Rarefaction — spaccCoverage","text":"object class spacc_coverage containing: richness Matrix species richness (n_seeds x n_sites) individuals Matrix individual counts coverage Matrix coverage estimates coords, n_seeds, n_sites, method Parameters used","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccCoverage.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Coverage-Based Spatial Rarefaction — spaccCoverage","text":"Sample coverage (Chao & Jost 2012) estimates proportion total community abundance represented observed species. provides measure sampling completeness independent sample size. Coverage-based rarefaction allows fair comparison diversity across communities different abundances standardizing equal completeness rather equal sample size.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccCoverage.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Coverage-Based Spatial Rarefaction — spaccCoverage","text":"Chao, . & Jost, L. (2012). Coverage-based rarefaction extrapolation: standardizing samples completeness rather size. Ecology, 93, 2533-2547.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/spaccCoverage.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Coverage-Based Spatial Rarefaction — spaccCoverage","text":"","code":"if (FALSE) { # \\dontrun{ coords <- data.frame(x = runif(50), y = runif(50)) species <- matrix(rpois(50 * 30, 2), nrow = 50)  cov <- spaccCoverage(species, coords) plot(cov)  # Interpolate richness at 90% and 95% coverage interp <- interpolateCoverage(cov, target = c(0.90, 0.95)) } # }"},{"path":"https://gillescolling.com/spacc/reference/spaccEndemism.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial Endemism Accumulation — spaccEndemism","title":"Spatial Endemism Accumulation — spaccEndemism","text":"Compute number endemic species (species found within accumulated area) sites added spatially. Complements standard SAC tracking species unique spatial extent.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccEndemism.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial Endemism Accumulation — spaccEndemism","text":"","code":"spaccEndemism(   x,   coords,   n_seeds = 50L,   method = \"knn\",   distance = c(\"euclidean\", \"haversine\"),   parallel = TRUE,   n_cores = NULL,   progress = TRUE,   seed = NULL )"},{"path":"https://gillescolling.com/spacc/reference/spaccEndemism.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatial Endemism Accumulation — spaccEndemism","text":"x site--species matrix (presence/absence abundance). coords data.frame columns x y, spacc_dist object. n_seeds Integer. Number random starting points. Default 50. method Character. Accumulation method. Default \"knn\". distance Character. Distance method: \"euclidean\" \"haversine\". parallel Logical. Use parallel processing? Default TRUE. n_cores Integer. Number cores. progress Logical. Show progress? Default TRUE. seed Integer. Random seed.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccEndemism.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spatial Endemism Accumulation — spaccEndemism","text":"object class spacc_endemism containing: richness Matrix cumulative richness (n_seeds x n_sites) endemism Matrix endemic species count (n_seeds x n_sites) coords, n_seeds, n_sites, method Parameters used","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccEndemism.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Spatial Endemism Accumulation — spaccEndemism","text":"accumulation step k, endemic species one present accumulated sites (1..k) absent remaining unvisited sites (k+1..n). tracks many species unique area sampled far. endemism curve typically starts low (endemics small areas), increases region grows, eventually equals total richness sites included.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccEndemism.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Spatial Endemism Accumulation — spaccEndemism","text":"Kier, G., Kreft, H., Lee, T.M., et al. (2009). global assessment endemism species richness across island mainland regions. Proceedings National Academy Sciences, 106, 9322-9327. May, F., Gerstner, K., McGlinn, D.J., et al. (2018). mobsim: R package simulation measurement biodiversity across spatial scales. Methods Ecology Evolution, 9, 1401-1408.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/spaccEndemism.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Spatial Endemism Accumulation — spaccEndemism","text":"","code":"if (FALSE) { # \\dontrun{ coords <- data.frame(x = runif(50), y = runif(50)) species <- matrix(rbinom(50 * 30, 1, 0.3), nrow = 50)  end <- spaccEndemism(species, coords, n_seeds = 30) plot(end) } # }"},{"path":"https://gillescolling.com/spacc/reference/spaccFunc.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial Functional Diversity Accumulation — spaccFunc","title":"Spatial Functional Diversity Accumulation — spaccFunc","text":"Compute spatial accumulation functional diversity metrics based traits.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccFunc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial Functional Diversity Accumulation — spaccFunc","text":"","code":"spaccFunc(   x,   coords,   traits,   metric = c(\"fdis\", \"fric\"),   n_seeds = 50L,   method = \"knn\",   distance = c(\"euclidean\", \"haversine\"),   parallel = TRUE,   n_cores = NULL,   progress = TRUE,   seed = NULL,   map = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/spaccFunc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatial Functional Diversity Accumulation — spaccFunc","text":"x site--species matrix (abundance data recommended). coords data.frame columns x y, spacc_dist object. traits species--traits matrix. Row names match species (columns x). metric Character vector. Metrics compute: \"fdis\": Functional Dispersion (mean distance centroid) \"fric\": Functional Richness (convex hull volume approximation) n_seeds Integer. Number random starting points. Default 50. method Character. Accumulation method. Default \"knn\". distance Character. Site distance method: \"euclidean\" \"haversine\". parallel Logical. Use parallel processing? Default TRUE. n_cores Integer. Number cores. progress Logical. Show progress? Default TRUE. seed Integer. Random seed. map Logical. TRUE, run accumulation every site seed store per-site final values spatial mapping. Enables as_sf() plot(type = \"map\"). Default FALSE.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccFunc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spatial Functional Diversity Accumulation — spaccFunc","text":"object class spacc_func containing: curves Named list matrices, one per metric (n_seeds x n_sites) metric Metrics computed coords, n_seeds, n_sites, method Parameters used","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccFunc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Spatial Functional Diversity Accumulation — spaccFunc","text":"Functional diversity metrics quantify trait space occupation: FDis (Functional Dispersion): Abundance-weighted mean distance community centroid trait space. Captures functional divergence. FRic (Functional Richness): Volume trait space occupied (convex hull). Requires species traits compute.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccFunc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Spatial Functional Diversity Accumulation — spaccFunc","text":"Laliberté, E. & Legendre, P. (2010). distance-based framework measuring functional diversity multiple traits. Ecology, 91, 299-305.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/spaccFunc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Spatial Functional Diversity Accumulation — spaccFunc","text":"","code":"if (FALSE) { # \\dontrun{ coords <- data.frame(x = runif(50), y = runif(50)) species <- matrix(rpois(50 * 20, 2), nrow = 50)  # Trait matrix (species x traits) traits <- matrix(rnorm(20 * 3), nrow = 20) rownames(traits) <- paste0(\"sp\", 1:20) colnames(species) <- rownames(traits)  func <- spaccFunc(species, coords, traits, metric = c(\"fdis\", \"fric\")) plot(func) } # }"},{"path":"https://gillescolling.com/spacc/reference/spaccHill.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial Accumulation with Hill Numbers — spaccHill","title":"Spatial Accumulation with Hill Numbers — spaccHill","text":"Compute spatial species accumulation curves using Hill numbers (effective number species) instead raw richness. Hill numbers unify diversity measures: q=0 richness, q=1 exponential Shannon, q=2 inverse Simpson.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccHill.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial Accumulation with Hill Numbers — spaccHill","text":"","code":"spaccHill(   x,   coords,   q = c(0, 1, 2),   n_seeds = 50L,   method = \"knn\",   distance = c(\"euclidean\", \"haversine\"),   parallel = TRUE,   n_cores = NULL,   progress = TRUE,   seed = NULL,   map = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/spaccHill.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatial Accumulation with Hill Numbers — spaccHill","text":"x site--species matrix (rows = sites, cols = species) presence/absence (0/1) abundance data. coords data.frame columns x y containing site coordinates, spacc_dist object distances(). q Numeric vector. Orders diversity compute. Default c(0, 1, 2). q = 0: Species richness q = 1: Exponential Shannon entropy (effective common species) q = 2: Inverse Simpson (effective dominant species) n_seeds Integer. Number random starting points. Default 50. method Character. Accumulation method: \"knn\" (default). distance Character. Distance method: \"euclidean\" \"haversine\". parallel Logical. Use parallel processing? Default TRUE. n_cores Integer. Number cores. Default NULL uses detectCores() - 1. progress Logical. Show progress bar? Default TRUE. seed Integer. Random seed reproducibility. map Logical. TRUE, run accumulation every site seed store per-site final Hill numbers spatial mapping. Enables as_sf() plot(type = \"map\"). Default FALSE.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccHill.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spatial Accumulation with Hill Numbers — spaccHill","text":"object class spacc_hill containing: curves Named list matrices, one per q value (n_seeds x n_sites) q Vector q values used coords Original coordinates n_seeds Number seeds n_sites Number sites n_species Total species method Method used","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccHill.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Spatial Accumulation with Hill Numbers — spaccHill","text":"Hill numbers (Chao et al. 2014) provide unified framework diversity measurement. Unlike raw richness (q=0), higher-order Hill numbers (q=1, q=2) -weight rare species, providing different perspectives diversity. spatial accumulation Hill numbers can reveal scale-dependent diversity patterns missed richness alone.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccHill.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Spatial Accumulation with Hill Numbers — spaccHill","text":"Chao, ., Gotelli, N.J., Hsieh, T.C., Sander, E.L., Ma, K.H., Colwell, R.K. & Ellison, .M. (2014). Rarefaction extrapolation Hill numbers: framework sampling estimation species diversity studies. Ecological Monographs, 84, 45-67.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/spaccHill.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Spatial Accumulation with Hill Numbers — spaccHill","text":"","code":"if (FALSE) { # \\dontrun{ # Compare diversity at different orders coords <- data.frame(x = runif(50), y = runif(50)) species <- matrix(rpois(50 * 30, 2), nrow = 50)  hill <- spaccHill(species, coords, q = c(0, 1, 2)) plot(hill)  # Extract summary at final site summary(hill) } # }"},{"path":"https://gillescolling.com/spacc/reference/spaccMetrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Per-Site Accumulation Metrics — spaccMetrics","title":"Per-Site Accumulation Metrics — spaccMetrics","text":"Compute spatial accumulation metrics site starting point. Useful identifying sites high low accumulation rates, visualizing spatial patterns diversity, understanding edge effects.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccMetrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Per-Site Accumulation Metrics — spaccMetrics","text":"","code":"spaccMetrics(   x,   coords,   metrics = c(\"slope_10\", \"half_richness\", \"auc\"),   method = c(\"knn\", \"kncn\", \"random\"),   distance = c(\"euclidean\", \"haversine\"),   parallel = TRUE,   n_cores = NULL,   progress = TRUE )"},{"path":"https://gillescolling.com/spacc/reference/spaccMetrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Per-Site Accumulation Metrics — spaccMetrics","text":"x site--species matrix (rows = sites, cols = species). coords data.frame columns x y containing site coordinates, spacc_dist object distances(). metrics Character vector. Metrics compute. Options include: \"slope_10\" (initial slope, first 10% sites), \"slope_25\" (initial slope, first 25% sites), \"half_richness\" (sites reach 50% total species), \"richness_50pct\" (alias half_richness), \"richness_75pct\" (sites reach 75% species), \"richness_90pct\" (sites reach 90% species), \"auc\" (area accumulation curve), \"final_richness\" (total species starting site). method Character. Accumulation method: \"knn\", \"kncn\", \"random\". Default \"knn\". distance Character. Distance method: \"euclidean\" \"haversine\". parallel Logical. Use parallel processing? Default TRUE. n_cores Integer. Number cores parallel processing. progress Logical. Show progress bar? Default TRUE.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccMetrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Per-Site Accumulation Metrics — spaccMetrics","text":"object class spacc_metrics containing: metrics Data frame one row per site columns metric coords Original coordinates metric_names Names computed metrics n_sites Number sites n_species Total species count","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccMetrics.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Per-Site Accumulation Metrics — spaccMetrics","text":"function runs spatial accumulation curve starting site individually, extracts summary metrics curve. allows identify: Sites species-rich areas (high initial slope) Core vs edge sites (fast vs slow accumulation) Spatial patterns community structure metrics can plotted heatmap using plot(result, type = \"heatmap\"), requires ggplot2 package. sophisticated spatial visualization study area boundaries, see areaOfEffect package.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccMetrics.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Per-Site Accumulation Metrics — spaccMetrics","text":"Soberon, J.M. & Llorente, J.B. (1993). use species accumulation functions prediction species richness. Conservation Biology, 7, 480-488.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/spaccMetrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Per-Site Accumulation Metrics — spaccMetrics","text":"","code":"if (FALSE) { # \\dontrun{ # Compute per-site metrics metrics <- spaccMetrics(species, coords,                         metrics = c(\"slope_10\", \"half_richness\", \"auc\"))  # Basic heatmap plot(metrics, metric = \"slope_10\", type = \"heatmap\")  # Access metric values directly metrics$metrics$slope_10 } # }"},{"path":"https://gillescolling.com/spacc/reference/spaccPhylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial Phylogenetic Diversity Accumulation — spaccPhylo","title":"Spatial Phylogenetic Diversity Accumulation — spaccPhylo","text":"Compute spatial accumulation phylogenetic diversity metrics (MPD, MNTD, PD).","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccPhylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial Phylogenetic Diversity Accumulation — spaccPhylo","text":"","code":"spaccPhylo(   x,   coords,   tree,   metric = c(\"mpd\", \"mntd\"),   n_seeds = 50L,   method = \"knn\",   distance = c(\"euclidean\", \"haversine\"),   parallel = TRUE,   n_cores = NULL,   progress = TRUE,   seed = NULL,   map = FALSE )"},{"path":"https://gillescolling.com/spacc/reference/spaccPhylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatial Phylogenetic Diversity Accumulation — spaccPhylo","text":"x site--species matrix. coords data.frame columns x y, spacc_dist object. tree phylogenetic tree class phylo (ape package), pairwise phylogenetic distance matrix. metric Character vector. Metrics compute: \"mpd\": Mean Pairwise Distance \"mntd\": Mean Nearest Taxon Distance \"pd\": Faith's Phylogenetic Diversity (requires tree, distance matrix) n_seeds Integer. Number random starting points. Default 50. method Character. Accumulation method. Default \"knn\". distance Character. Site distance method: \"euclidean\" \"haversine\". parallel Logical. Use parallel processing? Default TRUE. n_cores Integer. Number cores. progress Logical. Show progress? Default TRUE. seed Integer. Random seed. map Logical. TRUE, run accumulation every site seed store per-site final values spatial mapping. Enables as_sf() plot(type = \"map\"). Default FALSE.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccPhylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spatial Phylogenetic Diversity Accumulation — spaccPhylo","text":"object class spacc_phylo containing: curves Named list matrices, one per metric (n_seeds x n_sites) metric Metrics computed coords, n_seeds, n_sites, method Parameters used","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccPhylo.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Spatial Phylogenetic Diversity Accumulation — spaccPhylo","text":"Phylogenetic diversity metrics incorporate evolutionary relationships: MPD (Mean Pairwise Distance): Average phylogenetic distance pairs species. Sensitive tree-wide patterns. MNTD (Mean Nearest Taxon Distance): Average distance closest relative. Sensitive terminal clustering. PD (Faith's Phylogenetic Diversity): Total branch length connecting species. Requires full tree object.","code":""},{"path":"https://gillescolling.com/spacc/reference/spaccPhylo.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Spatial Phylogenetic Diversity Accumulation — spaccPhylo","text":"Faith, D.P. (1992). Conservation evaluation phylogenetic diversity. Biological Conservation, 61, 1-10. Webb, C.O. (2000). Exploring phylogenetic structure ecological communities: example rain forest trees. American Naturalist, 156, 145-155.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/reference/spaccPhylo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Spatial Phylogenetic Diversity Accumulation — spaccPhylo","text":"","code":"if (FALSE) { # \\dontrun{ library(ape)  # Create random tree tree <- rtree(30)  coords <- data.frame(x = runif(50), y = runif(50)) species <- matrix(rbinom(50 * 30, 1, 0.3), nrow = 50) colnames(species) <- tree$tip.label  phylo <- spaccPhylo(species, coords, tree, metric = c(\"mpd\", \"mntd\")) plot(phylo) } # }"},{"path":"https://gillescolling.com/spacc/reference/spatialRarefaction.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatially-Constrained Rarefaction — spatialRarefaction","title":"Spatially-Constrained Rarefaction — spatialRarefaction","text":"Compute expected species richness accounting spatial autocorrelation (Chiarucci et al. 2009). Uses distance-weighted sampling probabilities.","code":""},{"path":"https://gillescolling.com/spacc/reference/spatialRarefaction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatially-Constrained Rarefaction — spatialRarefaction","text":"","code":"spatialRarefaction(x, coords, n_perm = 100, bandwidth = NULL)"},{"path":"https://gillescolling.com/spacc/reference/spatialRarefaction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatially-Constrained Rarefaction — spatialRarefaction","text":"x site--species matrix. coords data.frame x y columns. n_perm Number permutations. Default 100. bandwidth Distance bandwidth spatial weighting.","code":""},{"path":"https://gillescolling.com/spacc/reference/spatialRarefaction.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spatially-Constrained Rarefaction — spatialRarefaction","text":"data.frame columns: sites, mean, sd, lower, upper","code":""},{"path":"https://gillescolling.com/spacc/reference/spatialRarefaction.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Spatially-Constrained Rarefaction — spatialRarefaction","text":"Chiarucci, ., Bacaro, G., Rocchini, D. & Fattorini, L. (2009). Discovering rediscovering sample-based rarefaction formula ecological literature. Community Ecology, 10, 195-199.","code":""},{"path":"https://gillescolling.com/spacc/reference/subsample.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial Subsampling — subsample","title":"Spatial Subsampling — subsample","text":"Reduce spatial autocorrelation subsampling sites using various methods.","code":""},{"path":"https://gillescolling.com/spacc/reference/subsample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial Subsampling — subsample","text":"","code":"subsample(   coords,   n = NULL,   method = c(\"grid\", \"random\", \"thinning\"),   cell_size = NULL,   min_dist = NULL,   seed = NULL )"},{"path":"https://gillescolling.com/spacc/reference/subsample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatial Subsampling — subsample","text":"coords data.frame columns x y containing site coordinates. n Integer. Target number sites retain. NULL, determined cell_size min_dist. method Character. Subsampling method: \"grid\" (default), \"random\", \"thinning\". cell_size Numeric. Grid cell size method = \"grid\". One site retained per cell. min_dist Numeric. Minimum distance retained sites method = \"thinning\". seed Integer. Random seed reproducibility.","code":""},{"path":"https://gillescolling.com/spacc/reference/subsample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spatial Subsampling — subsample","text":"Integer vector row indices retain.","code":""},{"path":"https://gillescolling.com/spacc/reference/subsample.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Spatial Subsampling — subsample","text":"Methods: \"grid\": Overlay grid retain one random site per cell. \"random\": Simple random subsample n sites. \"thinning\": Iteratively remove sites minimum distance achieved.","code":""},{"path":"https://gillescolling.com/spacc/reference/subsample.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Spatial Subsampling — subsample","text":"Aiello-Lammens, M.E., Boria, R.., Radosavljevic, ., et al. (2015). spThin: R package spatial thinning species occurrence records use ecological niche models. Ecography, 38, 541-545. Lennon, J.J., Koleff, P., Greenwood, J.J.D. & Gaston, K.J. (2004). Contribution rarity commonness patterns species richness. Ecology Letters, 7, 81-87.","code":""},{"path":"https://gillescolling.com/spacc/reference/subsample.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Spatial Subsampling — subsample","text":"","code":"if (FALSE) { # \\dontrun{ # Grid-based subsampling keep <- subsample(coords, method = \"grid\", cell_size = 10) sac <- spacc(species[keep, ], coords[keep, ])  # Minimum distance thinning keep <- subsample(coords, method = \"thinning\", min_dist = 5) } # }"},{"path":"https://gillescolling.com/spacc/reference/wavefront.html","id":null,"dir":"Reference","previous_headings":"","what":"Wavefront Expansion Accumulation — wavefront","title":"Wavefront Expansion Accumulation — wavefront","text":"Accumulate species within expanding radius seed points. Models invasion spread introduction points.","code":""},{"path":"https://gillescolling.com/spacc/reference/wavefront.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wavefront Expansion Accumulation — wavefront","text":"","code":"wavefront(   x,   coords,   n_seeds = 50L,   r0 = 0,   dr = NULL,   n_steps = 50L,   distance = c(\"euclidean\", \"haversine\"),   progress = TRUE,   seed = NULL )"},{"path":"https://gillescolling.com/spacc/reference/wavefront.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wavefront Expansion Accumulation — wavefront","text":"x site--species matrix. coords data.frame x y columns, spacc_dist object. n_seeds Integer. Number random starting points. r0 Numeric. Initial radius. Default 0. dr Numeric. Radius increment per step. Default auto-calculated. n_steps Integer. Number expansion steps. Default 50. distance Character. Distance method. progress Logical. Show progress? seed Integer. Random seed.","code":""},{"path":"https://gillescolling.com/spacc/reference/wavefront.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wavefront Expansion Accumulation — wavefront","text":"object class spacc_wavefront containing: curves Matrix species counts (n_seeds x n_steps) radius Vector radius values sites_included Matrix sites included step","code":""},{"path":"https://gillescolling.com/spacc/reference/wavefront.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Wavefront Expansion Accumulation — wavefront","text":"Shigesada, N. & Kawasaki, K. (1997). Biological Invasions: Theory Practice. Oxford University Press.","code":""},{"path":"https://gillescolling.com/spacc/reference/wavefront.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wavefront Expansion Accumulation — wavefront","text":"","code":"if (FALSE) { # \\dontrun{ wf <- wavefront(species, coords, n_seeds = 20, n_steps = 100) plot(wf) } # }"},{"path":[]},{"path":[]},{"path":"https://gillescolling.com/spacc/news/index.html","id":"hill-numbers-v020-0-5-0","dir":"Changelog","previous_headings":"New Features","what":"Hill Numbers (v0.2.0)","title":"spacc 0.5.0 (development)","text":"q = 0: Species richness q = 1: Exponential Shannon entropy (effective common species) q = 2: Inverse Simpson (effective dominant species) Extends iNEXT framework spatial accumulation","code":""},{"path":"https://gillescolling.com/spacc/news/index.html","id":"spatial-beta-diversity-v030-0-5-0","dir":"Changelog","previous_headings":"New Features","what":"Spatial Beta Diversity (v0.3.0)","title":"spacc 0.5.0 (development)","text":"Total beta diversity (Sorensen Jaccard) Turnover component (species replacement) Nestedness component (species loss) Based Baselga (2010) framework","code":""},{"path":"https://gillescolling.com/spacc/news/index.html","id":"coverage-based-rarefaction-v040-0-5-0","dir":"Changelog","previous_headings":"New Features","what":"Coverage-Based Rarefaction (v0.4.0)","title":"spacc 0.5.0 (development)","text":"spaccCoverage() - Track sample coverage accumulation interpolateCoverage() - Interpolate richness target coverage levels Implements Chao & Jost (2012) Good-Turing coverage estimator","code":""},{"path":"https://gillescolling.com/spacc/news/index.html","id":"phylogeneticfunctional-diversity-v050-0-5-0","dir":"Changelog","previous_headings":"New Features","what":"Phylogenetic/Functional Diversity (v0.5.0)","title":"spacc 0.5.0 (development)","text":"MPD: Mean Pairwise Distance MNTD: Mean Nearest Taxon Distance FDis: Functional Dispersion FRic: Functional Richness (approximation)","code":""},{"path":"https://gillescolling.com/spacc/news/index.html","id":"per-site-metrics--heatmaps-v060-0-5-0","dir":"Changelog","previous_headings":"New Features","what":"Per-Site Metrics & Heatmaps (v0.6.0)","title":"spacc 0.5.0 (development)","text":"slope_10, slope_25: Initial accumulation slopes half_richness, richness_Npct: Sites reach richness thresholds auc: Area accumulation curve as_sf() - Convert metrics sf spatial analysis Heatmap plotting via plot(type = \"heatmap\")","code":""},{"path":"https://gillescolling.com/spacc/news/index.html","id":"spatial-support-integration-v070-0-5-0","dir":"Changelog","previous_headings":"New Features","what":"Spatial Support Integration (v0.7.0)","title":"spacc 0.5.0 (development)","text":"Accepts country names: spacc(species, coords, support = \"France\") Accepts sf polygons pre-computed aoe_result objects Seeds sampled core sites (inside support) Accumulation expands halo sites (buffer zone) default include_halo = FALSE hard/political boundaries Eliminates edge effects arbitrary administrative boundaries","code":""},{"path":"https://gillescolling.com/spacc/news/index.html","id":"internal-changes-0-5-0","dir":"Changelog","previous_headings":"","what":"Internal Changes","title":"spacc 0.5.0 (development)","text":"New C++ implementations: hill.cpp, beta.cpp, coverage.cpp, phylo.cpp, metrics.cpp cpp_knn_parallel_seeds() - kNN explicit seed indices Added sf, areaOfEffect, ape, iNEXT, betapart Suggests","code":""},{"path":"https://gillescolling.com/spacc/news/index.html","id":"spacc-010","dir":"Changelog","previous_headings":"","what":"spacc 0.1.0","title":"spacc 0.1.0","text":"Initial release.","code":""},{"path":[]},{"path":"https://gillescolling.com/spacc/news/index.html","id":"core-spatial-accumulation-methods-0-1-0","dir":"Changelog","previous_headings":"Features","what":"Core Spatial Accumulation Methods","title":"spacc 0.1.0","text":"knn: k-Nearest Neighbor (always visit closest unvisited) kncn: k-Nearest Centroid Neighbor (visit closest centroid) random: Random order (null model) radius: Expand distance seed gaussian: Probabilistic selection weighted distance cone: Directional expansion within angular constraint collector: Sites data order","code":""},{"path":"https://gillescolling.com/spacc/news/index.html","id":"additional-accumulation-methods-0-1-0","dir":"Changelog","previous_headings":"Features","what":"Additional Accumulation Methods","title":"spacc 0.1.0","text":"wavefront() - Expanding radius accumulation distanceDecay() - Distance-decay relationships","code":""},{"path":"https://gillescolling.com/spacc/news/index.html","id":"analytical-methods-no-simulation-0-1-0","dir":"Changelog","previous_headings":"Features","what":"Analytical Methods (No Simulation)","title":"spacc 0.1.0","text":"coleman() - Coleman expected accumulation mao_tau() - Mao Tau (exact) expected accumulation collector() - Collector’s curve (data order) spatialRarefaction() - Spatially-constrained rarefaction","code":""},{"path":"https://gillescolling.com/spacc/news/index.html","id":"analysis-functions-0-1-0","dir":"Changelog","previous_headings":"Features","what":"Analysis Functions","title":"spacc 0.1.0","text":"extrapolate() - Fit asymptotic models (Michaelis-Menten, Lomolino, etc.) compare() - Statistical comparison curves rarefy() - Rarefaction common effort subsample() - Subsample sites spatially","code":""},{"path":"https://gillescolling.com/spacc/news/index.html","id":"infrastructure-0-1-0","dir":"Changelog","previous_headings":"Features","what":"Infrastructure","title":"spacc 0.1.0","text":"C++ backend via Rcpp performance Parallel processing via RcppParallel Haversine distance support geographic coordinates","code":""}]
