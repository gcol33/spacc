<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Spatial Analysis: Endemism, Fragmentation, and SAR • spacc</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Spatial Analysis: Endemism, Fragmentation, and SAR">
</head>
<body>
<p>








  pkgdown/mathjax-config.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spacc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/quickstart.html">Getting Started with spacc</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/diversity.html">Diversity Accumulation</a></li>
    <li><a class="dropdown-item" href="../articles/extrapolation.html">Extrapolation and Species-Area Models</a></li>
    <li><a class="dropdown-item" href="../articles/spatial-analysis.html">Spatial Analysis: Endemism, Fragmentation, and SAR</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gcol33/spacc"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Spatial Analysis: Endemism, Fragmentation, and SAR</h1>
                        <h4 data-toc-skip class="author">Gilles
Colling</h4>
            
            <h4 data-toc-skip class="date">2026-01-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gcol33/spacc/blob/HEAD/vignettes/spatial-analysis.Rmd" class="external-link"><code>vignettes/spatial-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>spatial-analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>spacc includes tools for conservation-oriented spatial analyses:
endemism-area curves, fragmentation effects on species richness (SFAR),
and sampling-effort correction for species-area relationships
(SESARS).</p>
</div>
<div class="section level2">
<h2 id="data-setup">Data Setup<a class="anchor" aria-label="anchor" href="#data-setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gillescolling.com/spacc/">spacc</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n_sites</span> <span class="op">&lt;-</span> <span class="fl">80</span></span>
<span><span class="va">n_species</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_sites</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_sites</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Species with varying range sizes (some endemic, some widespread)</span></span>
<span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="va">n_sites</span>, <span class="va">n_species</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">sp</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_species</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">90</span><span class="op">)</span></span>
<span>  <span class="va">cy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">90</span><span class="op">)</span></span>
<span>  <span class="co"># First 10 species are narrow-ranged (endemics)</span></span>
<span>  <span class="va">spread</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">sp</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">)</span> <span class="fl">0.005</span> <span class="kw">else</span> <span class="fl">0.001</span></span>
<span>  <span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">spread</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">x</span> <span class="op">-</span> <span class="va">cx</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="va">cy</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">species</span><span class="op">[</span>, <span class="va">sp</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_sites</span>, <span class="fl">1</span>, <span class="va">prob</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_species</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="endemism-area-curves">Endemism-Area Curves<a class="anchor" aria-label="anchor" href="#endemism-area-curves"></a>
</h2>
<p><code><a href="../reference/spaccEndemism.html">spaccEndemism()</a></code> tracks how many species are endemic
(restricted) to the set of sites visited so far. As the sampled area
expands, the number of endemic species initially rises then falls as
widespread species are encountered:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spaccEndemism.html">spaccEndemism</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">coords</span>, n_seeds <span class="op">=</span> <span class="fl">20</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">end</span></span>
<span><span class="co">#&gt; spacc endemism: 80 sites, 40 species, 20 seeds</span></span>
<span><span class="co">#&gt; Final mean endemism: 40.0 species (100% of total)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">end</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="spatial-analysis_files/figure-html/plot-endemism-1.png" class="r-plt" alt="Endemism-area curve showing endemic species as area expands." width="672"><p class="caption">
Endemism-area curve showing endemic species as area expands.
</p>
</div>
<p>The endemism curve is informative for identifying irreplaceable sites
— areas where unique species would be lost if not protected.</p>
</div>
<div class="section level2">
<h2 id="species-fragmented-area-relationship-sfar">Species-Fragmented Area Relationship (SFAR)<a class="anchor" aria-label="anchor" href="#species-fragmented-area-relationship-sfar"></a>
</h2>
<p><code><a href="../reference/sfar.html">sfar()</a></code> fits the SFAR model (Hanski et al. 2013), which
quantifies how habitat fragmentation (number of fragments) reduces
species richness beyond what area loss alone predicts:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mo stretchy="false" form="prefix">(</mo><mi>S</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>c</mi><mo>+</mo><mi>z</mi><mo>⋅</mo><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mo stretchy="false" form="prefix">(</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo>⋅</mo><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\log(S) = c + z \cdot \log(A) + f \cdot \log(n)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
is species richness,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
is total area,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is number of fragments, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
is the fragmentation exponent.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First create a spacc object</span></span>
<span><span class="va">sac</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spacc.html">spacc</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">coords</span>, n_seeds <span class="op">=</span> <span class="fl">20</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define patch assignments (e.g., from k-means clustering)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">patches</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">coords</span>, centers <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span></span>
<span></span>
<span><span class="co"># Fit SFAR model</span></span>
<span><span class="va">sfar_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sfar.html">sfar</a></span><span class="op">(</span><span class="va">sac</span>, <span class="va">patches</span><span class="op">)</span></span>
<span><span class="va">sfar_fit</span></span>
<span><span class="co">#&gt; SFAR: Species-Fragmented Area Relationship</span></span>
<span><span class="co">#&gt; -------------------------------------------- </span></span>
<span><span class="co">#&gt; Fragments: 5</span></span>
<span><span class="co">#&gt; R-squared: 0.985</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model: S = 7.74 * A^0.300 * n^(--0.248)</span></span>
<span><span class="co">#&gt; Fragmentation effect (f): -0.248</span></span>
<span><span class="co">#&gt;   No additional fragmentation penalty detected</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sfar_fit</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="spatial-analysis_files/figure-html/plot-sfar-1.png" class="r-plt" alt="Species-Fragmented Area Relationship." width="672"><p class="caption">
Species-Fragmented Area Relationship.
</p>
</div>
<p>A negative fragmentation exponent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
indicates that splitting habitat into more fragments reduces species
richness beyond the area effect.</p>
</div>
<div class="section level2">
<h2 id="sampling-effort-corrected-sar-sesars">Sampling-Effort Corrected SAR (SESARS)<a class="anchor" aria-label="anchor" href="#sampling-effort-corrected-sar-sesars"></a>
</h2>
<p><code><a href="../reference/sesars.html">sesars()</a></code> fits a species-area relationship corrected for
variation in sampling effort across sites, avoiding the bias that arises
when species-poor areas are also under-sampled:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mo stretchy="false" form="prefix">(</mo><mi>S</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>c</mi><mo>+</mo><mi>z</mi><mo>⋅</mo><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mo stretchy="false" form="prefix">(</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>e</mi><mo>⋅</mo><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mo stretchy="false" form="prefix">(</mo><mi>E</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\log(S) = c + z \cdot \log(A) + e \cdot \log(E)</annotation></semantics></math></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate varying sampling effort per site</span></span>
<span><span class="va">effort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n_sites</span>, <span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Fit SESARS model using the spacc object from above</span></span>
<span><span class="va">sesars_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sesars.html">sesars</a></span><span class="op">(</span><span class="va">sac</span>, <span class="va">effort</span><span class="op">)</span></span>
<span><span class="va">sesars_fit</span></span>
<span><span class="co">#&gt; SESARS: Sampling Effort Species-Area Relationship</span></span>
<span><span class="co">#&gt; ------------------------------------------------ </span></span>
<span><span class="co">#&gt; Model: power</span></span>
<span><span class="co">#&gt; R-squared: 0.996</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;   log_c       z       w </span></span>
<span><span class="co">#&gt;  4.2099  2.2586 -1.5486 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Interpretation: S = 67.35 * A^2.259 * E^-1.549</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sesars_fit</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="spatial-analysis_files/figure-html/plot-sesars-1.png" class="r-plt" alt="Sampling-effort corrected SAR." width="672"><p class="caption">
Sampling-effort corrected SAR.
</p>
</div>
</div>
<div class="section level2">
<h2 id="per-site-metrics-for-spatial-prioritisation">Per-Site Metrics for Spatial Prioritisation<a class="anchor" aria-label="anchor" href="#per-site-metrics-for-spatial-prioritisation"></a>
</h2>
<p><code><a href="../reference/spaccMetrics.html">spaccMetrics()</a></code> computes accumulation metrics from every
site as a starting point. This reveals spatial variation in diversity
accumulation rates, useful for conservation planning:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">met</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spaccMetrics.html">spaccMetrics</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">coords</span>,</span>
<span>                    metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"slope_10"</span>, <span class="st">"half_richness"</span>, <span class="st">"auc"</span><span class="op">)</span>,</span>
<span>                    progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">met</span>, metric <span class="op">=</span> <span class="st">"slope_10"</span>, type <span class="op">=</span> <span class="st">"heatmap"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in viridisLite::viridis(n, alpha, begin, end, direction, option):</span></span>
<span><span class="co">#&gt; Option 'v' does not exist. Defaulting to 'viridis'.</span></span></code></pre></div>
<div class="figure">
<img src="spatial-analysis_files/figure-html/plot-metrics-1.png" class="r-plt" alt="Spatial heatmap of initial accumulation slope." width="672"><p class="caption">
Spatial heatmap of initial accumulation slope.
</p>
</div>
<p>Sites with steep initial slopes represent areas where many species
are concentrated — potential biodiversity hotspots.</p>
</div>
<div class="section level2">
<h2 id="spatial-subsampling">Spatial Subsampling<a class="anchor" aria-label="anchor" href="#spatial-subsampling"></a>
</h2>
<p><code><a href="../reference/subsample.html">subsample()</a></code> reduces spatial autocorrelation when
preparing data for macroecological analyses:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Grid-based thinning</span></span>
<span><span class="va">keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsample.html">subsample</a></span><span class="op">(</span><span class="va">coords</span>, method <span class="op">=</span> <span class="st">"grid"</span>, cell_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">keep</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 24</span></span>
<span></span>
<span><span class="co"># Compare thinned vs full SAC</span></span>
<span><span class="va">sac_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spacc.html">spacc</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">coords</span>, n_seeds <span class="op">=</span> <span class="fl">20</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sac_thin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spacc.html">spacc</a></span><span class="op">(</span><span class="va">species</span><span class="op">[</span><span class="va">keep</span>, <span class="op">]</span>, <span class="va">coords</span><span class="op">[</span><span class="va">keep</span>, <span class="op">]</span>, n_seeds <span class="op">=</span> <span class="fl">20</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>full <span class="op">=</span> <span class="va">sac_full</span>, thinned <span class="op">=</span> <span class="va">sac_thin</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">combined</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="spatial-analysis_files/figure-html/plot-subsample-1.png" class="r-plt" alt="Effect of spatial thinning on SAC." width="672"><p class="caption">
Effect of spatial thinning on SAC.
</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Hanski, I., Zurita, G.A., Bellocq, M.I. &amp; Rybicki, J. (2013).
Species-fragmented area relationship. Proceedings of the National
Academy of Sciences, 110, 12715-12720.</li>
<li>Aiello-Lammens, M.E., Boria, R.A., Radosavljevic, A., et al. (2015).
spThin: an R package for spatial thinning. Ecography, 38, 541-545.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gilles Colling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  
</body>
</html>
